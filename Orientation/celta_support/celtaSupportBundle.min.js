(function e(t,r,n){function i(s,o){if(!r[s]){if(!t[s]){var f=typeof require=="function"&&require;if(!o&&f)return f(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[s]={exports:{}};t[s][0].call(l.exports,function(e){var r=t[s][1][e];return i(r?r:e)},l,l.exports,e,t,r,n)}return r[s].exports}var a=typeof require=="function"&&require;for(var s=0;s<n.length;s++)i(n[s]);return i})({1:[function(e,t,r){(function(t){"use strict";if(!t.window.CeltaLinkOpener){t.window.CeltaLinkOpener=e("./modules/celtaLinkOpener")(t.window.celtaSupportConfig)}if(!t.window.CeltaTextSaver){t.window.CeltaTextSaver=e("./modules/celtaTextSaver")(t.window.celtaSupportConfig)}if(!t.window.CeltaScormSupport){t.window.CeltaScormSupport=e("./modules/celtaScormSupport")(t.window.celtaSupportConfig.activityCount)}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./modules/celtaLinkOpener":2,"./modules/celtaScormSupport":3,"./modules/celtaTextSaver":4}],2:[function(e,t,r){"use strict";var n=e("./notifier");var i=e("./linkOpener");t.exports=function(e){var t=i(e.links);function r(e){try{t.openLink(e)}catch(e){return n.notifyErrorToUser(e,"Problem opening link: ")}}return{openForum:r,openLink:r}}},{"./linkOpener":7,"./notifier":8}],3:[function(e,t,r){"use strict";var n=e("./notifier");var i=e("./sl2Integration");t.exports=function(){var e=false;var t=false;var r=void 0;function a(e){var t=null;var r=0;var n=50;while(!e.API&&e.parent&&e.parent!=e&&r<=n){r++;e=e.parent}if(e.API){t=e.API}return t}function s(){var e=void 0;var t=window;e=a(t);if(!e&&t.parent&&t.parent!=t){e=a(t.parent)}if(!e&&t.top&&t.top.opener){e=a(t.top.opener)}if(!e&&t.top&&t.top.opener&&t.top.opener.document){e=a(t.top.opener.document)}return e}function o(){n.notifyMessageToDebug("First invocation");r=s();if(!r){n.notifyErrorToDebug("Unable to find SCORM 1.2 API");t=true}else{n.notifyMessageToDebug("Found SCORM 1.2 API")}e=true}function f(i){if(t){n.notifyErrorToDebug("Unable to get "+i+" as unable to find SCORM API");return""}if(!e){o()}return r.LMSGetValue(i)}function u(i,a){if(t){n.notifyErrorToDebug("Unable to set "+i+" to "+a+" as unable to find SCORM API");return false}if(!e){o();u("cmi.core.score.min","0");u("cmi.core.score.max","100")}if(!r.LMSSetValue(i,a)){n.notifyErrorToDebug("Unable to set "+i+" to "+a);return false}else{n.notifyMessageToDebug("Set "+i+" to "+a);return true}}function l(e){if(e>100){n.notifyErrorToDebug("Can't set a score over 100");return}u("cmi.core.score.raw",String(e))}function c(){u("cmi.core.lesson_status","incomplete")}function h(){u("cmi.core.lesson_status","completed")}function d(e){var t=i.getBoolean(e);var r=i.getNumber("activitiesCompleted");var a=i.getNumber("activityCount");if(t===false){i.setValue(e,true);r++;if(r>a){n.notifyErrorToDebug("Tried to increment activitiesCompleted beyond activityCount")}else{i.setValue("activitiesCompleted",r)}}}function p(){var e=i.getNumber("activityCount");var t=i.getNumber("activitiesCompleted");if(t===0){return}if(t<e){var r=100/e*t;l(r);i.setValue("percentComplete",Math.round(r))}else{l(100);i.setValue("percentComplete",100)}}function v(){var e=f("cmi.core.lesson_status");return e==="completed"}return{setScore:l,setIncomplete:c,setCompleted:h,updateActivityCompletion:d,updateScore:p,isComplete:v}}},{"./notifier":8,"./sl2Integration":10}],4:[function(e,t,r){"use strict";var n=e("./docxGen");var i=e("./openXmlStringParser");var a=e("./sl2Integration");var s=e("./templateLoader");var o=e("./notifier");var f=e("./docxSaver");var u=e("events");t.exports=function(e){function t(e){try{var t=c.getTemplate(e);var r=a.getUserInput(t.userFields,function(e){return i.replaceLinebreak(i.escapeXml(e))});f.saveDoc(n.genDoc(r,t.data),t.description)}catch(t){return o.notifyErrorToUser(t,"Problem generating document "+e+": ")}}function r(e,t){try{c.loadSingle(e,t)}catch(e){o.notifyErrorToDebug(e)}}var l=new u;var c=s(e.templates);c.events.on("templateLoaded",function(e){if(e.err){o.notifyErrorToDebug(e.err)}l.emit("templateLoaded",e)});c.events.on("preloadComplete",function(){l.emit("preloadComplete")});return{events:l,saveText:t,loadTemplate:r}}},{"./docxGen":5,"./docxSaver":6,"./notifier":8,"./openXmlStringParser":9,"./sl2Integration":10,"./templateLoader":11,events:32}],5:[function(e,t,r){"use strict";var n=e("docxtemplater");var i=e("jszip");function a(e,t){var r=new i(t);var a=(new n).loadZip(r);a.getFullText();a.setData(e);a.render();return a.getZip().generate({type:"arraybuffer",compression:"DEFLATE"})}t.exports={genDoc:a}},{docxtemplater:15,jszip:45}],6:[function(e,t,r){"use strict";var n="application/vnd.openxmlformats-officedocument.wordprocessingml.document";var i=e("file-saver");function a(e,t){i.saveAs(new Blob([e],{type:n}),t+".docx")}t.exports={saveDoc:a}},{"file-saver":33}],7:[function(e,t,r){"use strict";t.exports=function(e){var t=e.linkMappings;function r(e){var t=document.createElement("a");t.href=e;if(typeof t.download!=="undefined"){t.download=""}else{t.target="_blank"}document.body.appendChild(t);t.click()}function n(e){window.open(e)}function i(e){if(!t.hasOwnProperty(e)){throw new Error("unable to find configuration data for link "+e)}var i=t[e];switch(i.method){case"open":n(i.url);break;case"download":r(i.url);break;default:throw new Error("unsupported link opening method "+i.method+" for link "+e)}}return{openLink:i}}},{}],8:[function(e,t,r){"use strict";function n(e,t){var r=void 0;if(t!=null){r=t+e.message}else{r=e.message}return r}function i(e,t){alert(n(e,t))}function a(e){console.error(e)}function s(e){alert(e)}function o(e){console.log(e)}t.exports={notifyErrorToUser:i,notifyErrorToDebug:a,notifyMessage:s,notifyMessageToDebug:o}},{}],9:[function(e,t,r){"use strict";function n(e){var t=e.split(/(?:\r\n|\r|\n)/);var r=t.length;var n="";for(var i=0;i<r;i++){if(i>0){n+="<w:br/>"}n+="<w:t>"+t[i]+"</w:t>"}return n}function i(e){var t="<w:p><w:r>";var r="</w:r></w:p>";return t+n(e)+r}function a(e){return e.replace(/[<>&'"]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;"}})}t.exports={replaceLinebreak:i,escapeXml:a}},{}],10:[function(e,t,r){"use strict";function n(){var e=void 0;try{e=window.GetPlayer()}catch(e){throw new Error("Unable to find GetPlayer(). Is this a really a Storyline object?")}return e}function i(e,t){var r=n();r.SetVar(e,String(t))}function a(e){var t=n();var r=t.GetVar(e);if(typeof r==="boolean"){return r}if(typeof r==="string"){if(r==="true"){return true}else if(r==="false"){return false}}throw'"'+e+'" is not a boolean value, value returned: "'+r+'"'}function s(e){var t=n();var r=t.GetVar(e);if(typeof r==="number"){return r}if(typeof r==="string"){if(/^[+-]?\d*(\.\d+)?$/.test(r)){return parseFloat(r)}}throw'"'+e+'" is not a number value, value returned: "'+r+'"'}function o(e,t){var r={};var i=e.length;var a=n();for(var s=0;s<i;s++){var o=e[s];var f=a.GetVar(o)||"";if(typeof t==="function"){r[o]=t(f)}else{r[o]=f}}return r}t.exports={getBoolean:a,getUserInput:o,getNumber:s,setValue:i}},{}],11:[function(e,t,r){"use strict";var n=e("base64-js");var i=e("events");t.exports=function(e){var t={};var r={};var a=e.preload;var s=e.templateMappings;var o=l(s);var f=o.length;var u=new i;function l(e){var t=[];for(var r in e){if(e.hasOwnProperty(r)){t.push(r)}}return t}function c(e){var t={};for(var r in e){if(e.hasOwnProperty(r)){t[r]=e[r]}}return t}function h(e){var n=null;if(!s.hasOwnProperty(e)){n="unable to find configuration data for template "+e}else if(t.hasOwnProperty(e)){n="template "+e+" is already loading"}else if(r.hasOwnProperty(e)){n="template "+e+" has already been loaded"}if(n){throw new Error(n)}}function d(e){var n=null;if(!s.hasOwnProperty(e)){n="unable to find configuration data for template "+e}else if(!r.hasOwnProperty(e)&&!t.hasOwnProperty(e)){n="template "+e+" has not been requested"}else if(!r.hasOwnProperty(e)){n="template "+e+" has not yet loaded"}if(n){throw new Error(n)}else if(r[e].err){throw r[e].err}}function p(){return l(r)}function v(){for(var e=0;e<f;e++){y(o[e])}}function m(e){var n=e.id;r[n]=e;delete t[n];u.emit("templateLoaded",e);if(a===true&&f===p().length){u.emit("preloadComplete",r)}}function g(e){d(e);return r[e]}function w(e){if(a===true){throw new Error("cannot load template as preload enabled")}y(e)}function y(e){h(e);var r=c(s[e]);r.id=e;t[e]=e;_(r)}function _(e){function t(t){e.err=t;e.data=null;e.err.message="error loading template "+e.id+": "+e.err.message;m(e)}function r(r){var i=r.target;if(i.status!==200){return t(new Error(i.status+" "+i.statusText))}try{e.data=e.dataType==="b64"?n.toByteArray(i.responseText).buffer:i.response}catch(e){return t(e)}e.err=null;m(e)}function i(){t(new Error("network error"))}(function(){var t=new XMLHttpRequest;t.open("GET",e.path);t.onerror=i;t.onload=r;if(e.dataType==="b64"){t.responseType="text"}else{t.responseType="arraybuffer"}t.send()})()}if(a===true){v()}return{loadSingle:w,getTemplate:g,events:u}}},{"base64-js":12,events:32}],12:[function(e,t,r){"use strict";r.byteLength=l;r.toByteArray=c;r.fromByteArray=p;var n=[];var i=[];var a=typeof Uint8Array!=="undefined"?Uint8Array:Array;var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var o=0,f=s.length;o<f;++o){n[o]=s[o];i[s.charCodeAt(o)]=o}i["-".charCodeAt(0)]=62;i["_".charCodeAt(0)]=63;function u(e){var t=e.length;if(t%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}return e[t-2]==="="?2:e[t-1]==="="?1:0}function l(e){return e.length*3/4-u(e)}function c(e){var t,r,n,s,o;var f=e.length;s=u(e);o=new a(f*3/4-s);r=s>0?f-4:f;var l=0;for(t=0;t<r;t+=4){n=i[e.charCodeAt(t)]<<18|i[e.charCodeAt(t+1)]<<12|i[e.charCodeAt(t+2)]<<6|i[e.charCodeAt(t+3)];o[l++]=n>>16&255;o[l++]=n>>8&255;o[l++]=n&255}if(s===2){n=i[e.charCodeAt(t)]<<2|i[e.charCodeAt(t+1)]>>4;o[l++]=n&255}else if(s===1){n=i[e.charCodeAt(t)]<<10|i[e.charCodeAt(t+1)]<<4|i[e.charCodeAt(t+2)]>>2;o[l++]=n>>8&255;o[l++]=n&255}return o}function h(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[e&63]}function d(e,t,r){var n;var i=[];for(var a=t;a<r;a+=3){n=(e[a]<<16)+(e[a+1]<<8)+e[a+2];i.push(h(n))}return i.join("")}function p(e){var t;var r=e.length;var i=r%3;var a="";var s=[];var o=16383;for(var f=0,u=r-i;f<u;f+=o){s.push(d(e,f,f+o>u?u:f+o))}if(i===1){t=e[r-1];a+=n[t>>2];a+=n[t<<4&63];a+="=="}else if(i===2){t=(e[r-2]<<8)+e[r-1];a+=n[t>>10];a+=n[t>>4&63];a+=n[t<<2&63];a+="="}s.push(a);return s.join("")}},{}],13:[function(e,t,r){(function(t){"use strict";var n=e("base64-js");var i=e("ieee754");var a=e("isarray");r.Buffer=u;r.SlowBuffer=y;r.INSPECT_MAX_BYTES=50;u.TYPED_ARRAY_SUPPORT=t.TYPED_ARRAY_SUPPORT!==undefined?t.TYPED_ARRAY_SUPPORT:s();r.kMaxLength=o();function s(){try{var e=new Uint8Array(1);e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return e.foo()===42&&typeof e.subarray==="function"&&e.subarray(1,1).byteLength===0}catch(e){return false}}function o(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function f(e,t){if(o()<t){throw new RangeError("Invalid typed array length")}if(u.TYPED_ARRAY_SUPPORT){e=new Uint8Array(t);e.__proto__=u.prototype}else{if(e===null){e=new u(t)}e.length=t}return e}function u(e,t,r){if(!u.TYPED_ARRAY_SUPPORT&&!(this instanceof u)){return new u(e,t,r)}if(typeof e==="number"){if(typeof t==="string"){throw new Error("If encoding is specified then the first argument must be a string")}return d(this,e)}return l(this,e,t,r)}u.poolSize=8192;u._augment=function(e){e.__proto__=u.prototype;return e};function l(e,t,r,n){if(typeof t==="number"){throw new TypeError('"value" argument must not be a number')}if(typeof ArrayBuffer!=="undefined"&&t instanceof ArrayBuffer){return m(e,t,r,n)}if(typeof t==="string"){return p(e,t,r)}return g(e,t)}u.from=function(e,t,r){return l(null,e,t,r)};if(u.TYPED_ARRAY_SUPPORT){u.prototype.__proto__=Uint8Array.prototype;u.__proto__=Uint8Array;if(typeof Symbol!=="undefined"&&Symbol.species&&u[Symbol.species]===u){Object.defineProperty(u,Symbol.species,{value:null,configurable:true})}}function c(e){if(typeof e!=="number"){throw new TypeError('"size" argument must be a number')}else if(e<0){throw new RangeError('"size" argument must not be negative')}}function h(e,t,r,n){c(t);if(t<=0){return f(e,t)}if(r!==undefined){return typeof n==="string"?f(e,t).fill(r,n):f(e,t).fill(r)}return f(e,t)}u.alloc=function(e,t,r){return h(null,e,t,r)};function d(e,t){c(t);e=f(e,t<0?0:w(t)|0);if(!u.TYPED_ARRAY_SUPPORT){for(var r=0;r<t;++r){e[r]=0}}return e}u.allocUnsafe=function(e){return d(null,e)};u.allocUnsafeSlow=function(e){return d(null,e)};function p(e,t,r){if(typeof r!=="string"||r===""){r="utf8"}if(!u.isEncoding(r)){throw new TypeError('"encoding" must be a valid string encoding')}var n=_(t,r)|0;e=f(e,n);var i=e.write(t,r);if(i!==n){e=e.slice(0,i)}return e}function v(e,t){var r=t.length<0?0:w(t.length)|0;e=f(e,r);for(var n=0;n<r;n+=1){e[n]=t[n]&255}return e}function m(e,t,r,n){t.byteLength;if(r<0||t.byteLength<r){throw new RangeError("'offset' is out of bounds")}if(t.byteLength<r+(n||0)){throw new RangeError("'length' is out of bounds")}if(r===undefined&&n===undefined){t=new Uint8Array(t)}else if(n===undefined){t=new Uint8Array(t,r)}else{t=new Uint8Array(t,r,n)}if(u.TYPED_ARRAY_SUPPORT){e=t;e.__proto__=u.prototype}else{e=v(e,t)}return e}function g(e,t){if(u.isBuffer(t)){var r=w(t.length)|0;e=f(e,r);if(e.length===0){return e}t.copy(e,0,0,r);return e}if(t){if(typeof ArrayBuffer!=="undefined"&&t.buffer instanceof ArrayBuffer||"length"in t){if(typeof t.length!=="number"||te(t.length)){return f(e,0)}return v(e,t)}if(t.type==="Buffer"&&a(t.data)){return v(e,t.data)}}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function w(e){if(e>=o()){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+o().toString(16)+" bytes")}return e|0}function y(e){if(+e!=e){e=0}return u.alloc(+e)}u.isBuffer=function e(t){return!!(t!=null&&t._isBuffer)};u.compare=function e(t,r){if(!u.isBuffer(t)||!u.isBuffer(r)){throw new TypeError("Arguments must be Buffers")}if(t===r)return 0;var n=t.length;var i=r.length;for(var a=0,s=Math.min(n,i);a<s;++a){if(t[a]!==r[a]){n=t[a];i=r[a];break}}if(n<i)return-1;if(i<n)return 1;return 0};u.isEncoding=function e(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};u.concat=function e(t,r){if(!a(t)){throw new TypeError('"list" argument must be an Array of Buffers')}if(t.length===0){return u.alloc(0)}var n;if(r===undefined){r=0;for(n=0;n<t.length;++n){r+=t[n].length}}var i=u.allocUnsafe(r);var s=0;for(n=0;n<t.length;++n){var o=t[n];if(!u.isBuffer(o)){throw new TypeError('"list" argument must be an Array of Buffers')}o.copy(i,s);s+=o.length}return i};function _(e,t){if(u.isBuffer(e)){return e.length}if(typeof ArrayBuffer!=="undefined"&&typeof ArrayBuffer.isView==="function"&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer)){return e.byteLength}if(typeof e!=="string"){e=""+e}var r=e.length;if(r===0)return 0;var n=false;for(;;){switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case undefined:return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return Q(e).length;default:if(n)return q(e).length;t=(""+t).toLowerCase();n=true}}}u.byteLength=_;function b(e,t,r){var n=false;if(t===undefined||t<0){t=0}if(t>this.length){return""}if(r===undefined||r>this.length){r=this.length}if(r<=0){return""}r>>>=0;t>>>=0;if(r<=t){return""}if(!e)e="utf8";while(true){switch(e){case"hex":return P(this,t,r);case"utf8":case"utf-8":return O(this,t,r);case"ascii":return B(this,t,r);case"latin1":case"binary":return L(this,t,r);case"base64":return R(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase();n=true}}}u.prototype._isBuffer=true;function x(e,t,r){var n=e[t];e[t]=e[r];e[r]=n}u.prototype.swap16=function e(){var t=this.length;if(t%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var r=0;r<t;r+=2){x(this,r,r+1)}return this};u.prototype.swap32=function e(){var t=this.length;if(t%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var r=0;r<t;r+=4){x(this,r,r+3);x(this,r+1,r+2)}return this};u.prototype.swap64=function e(){var t=this.length;if(t%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var r=0;r<t;r+=8){x(this,r,r+7);x(this,r+1,r+6);x(this,r+2,r+5);x(this,r+3,r+4)}return this};u.prototype.toString=function e(){var t=this.length|0;if(t===0)return"";if(arguments.length===0)return O(this,0,t);return b.apply(this,arguments)};u.prototype.equals=function e(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(this===t)return true;return u.compare(this,t)===0};u.prototype.inspect=function e(){var t="";var n=r.INSPECT_MAX_BYTES;if(this.length>0){t=this.toString("hex",0,n).match(/.{2}/g).join(" ");if(this.length>n)t+=" ... "}return"<Buffer "+t+">"};u.prototype.compare=function e(t,r,n,i,a){if(!u.isBuffer(t)){throw new TypeError("Argument must be a Buffer")}if(r===undefined){r=0}if(n===undefined){n=t?t.length:0}if(i===undefined){i=0}if(a===undefined){a=this.length}if(r<0||n>t.length||i<0||a>this.length){throw new RangeError("out of range index")}if(i>=a&&r>=n){return 0}if(i>=a){return-1}if(r>=n){return 1}r>>>=0;n>>>=0;i>>>=0;a>>>=0;if(this===t)return 0;var s=a-i;var o=n-r;var f=Math.min(s,o);var l=this.slice(i,a);var c=t.slice(r,n);for(var h=0;h<f;++h){if(l[h]!==c[h]){s=l[h];o=c[h];break}}if(s<o)return-1;if(o<s)return 1;return 0};function E(e,t,r,n,i){if(e.length===0)return-1;if(typeof r==="string"){n=r;r=0}else if(r>2147483647){r=2147483647}else if(r<-2147483648){r=-2147483648}r=+r;if(isNaN(r)){r=i?0:e.length-1}if(r<0)r=e.length+r;if(r>=e.length){if(i)return-1;else r=e.length-1}else if(r<0){if(i)r=0;else return-1}if(typeof t==="string"){t=u.from(t,n)}if(u.isBuffer(t)){if(t.length===0){return-1}return T(e,t,r,n,i)}else if(typeof t==="number"){t=t&255;if(u.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf==="function"){if(i){return Uint8Array.prototype.indexOf.call(e,t,r)}else{return Uint8Array.prototype.lastIndexOf.call(e,t,r)}}return T(e,[t],r,n,i)}throw new TypeError("val must be string, number or Buffer")}function T(e,t,r,n,i){var a=1;var s=e.length;var o=t.length;if(n!==undefined){n=String(n).toLowerCase();if(n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le"){if(e.length<2||t.length<2){return-1}a=2;s/=2;o/=2;r/=2}}function f(e,t){if(a===1){return e[t]}else{return e.readUInt16BE(t*a)}}var u;if(i){var l=-1;for(u=r;u<s;u++){if(f(e,u)===f(t,l===-1?0:u-l)){if(l===-1)l=u;if(u-l+1===o)return l*a}else{if(l!==-1)u-=u-l;l=-1}}}else{if(r+o>s)r=s-o;for(u=r;u>=0;u--){var c=true;for(var h=0;h<o;h++){if(f(e,u+h)!==f(t,h)){c=false;break}}if(c)return u}}return-1}u.prototype.includes=function e(t,r,n){return this.indexOf(t,r,n)!==-1};u.prototype.indexOf=function e(t,r,n){return E(this,t,r,n,true)};u.prototype.lastIndexOf=function e(t,r,n){return E(this,t,r,n,false)};function k(e,t,r,n){r=Number(r)||0;var i=e.length-r;if(!n){n=i}else{n=Number(n);if(n>i){n=i}}var a=t.length;if(a%2!==0)throw new TypeError("Invalid hex string");if(n>a/2){n=a/2}for(var s=0;s<n;++s){var o=parseInt(t.substr(s*2,2),16);if(isNaN(o))return s;e[r+s]=o}return s}function A(e,t,r,n){return ee(q(t,e.length-r),e,r,n)}function S(e,t,r,n){return ee(K(t),e,r,n)}function C(e,t,r,n){return S(e,t,r,n)}function N(e,t,r,n){return ee(Q(t),e,r,n)}function I(e,t,r,n){return ee(J(t,e.length-r),e,r,n)}u.prototype.write=function e(t,r,n,i){if(r===undefined){i="utf8";n=this.length;r=0}else if(n===undefined&&typeof r==="string"){i=r;n=this.length;r=0}else if(isFinite(r)){r=r|0;if(isFinite(n)){n=n|0;if(i===undefined)i="utf8"}else{i=n;n=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var a=this.length-r;if(n===undefined||n>a)n=a;if(t.length>0&&(n<0||r<0)||r>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!i)i="utf8";var s=false;for(;;){switch(i){case"hex":return k(this,t,r,n);case"utf8":case"utf-8":return A(this,t,r,n);case"ascii":return S(this,t,r,n);case"latin1":case"binary":return C(this,t,r,n);case"base64":return N(this,t,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,r,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase();s=true}}};u.prototype.toJSON=function e(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function R(e,t,r){if(t===0&&r===e.length){return n.fromByteArray(e)}else{return n.fromByteArray(e.slice(t,r))}}function O(e,t,r){r=Math.min(e.length,r);var n=[];var i=t;while(i<r){var a=e[i];var s=null;var o=a>239?4:a>223?3:a>191?2:1;if(i+o<=r){var f,u,l,c;switch(o){case 1:if(a<128){s=a}break;case 2:f=e[i+1];if((f&192)===128){c=(a&31)<<6|f&63;if(c>127){s=c}}break;case 3:f=e[i+1];u=e[i+2];if((f&192)===128&&(u&192)===128){c=(a&15)<<12|(f&63)<<6|u&63;if(c>2047&&(c<55296||c>57343)){s=c}}break;case 4:f=e[i+1];u=e[i+2];l=e[i+3];if((f&192)===128&&(u&192)===128&&(l&192)===128){c=(a&15)<<18|(f&63)<<12|(u&63)<<6|l&63;if(c>65535&&c<1114112){s=c}}}}if(s===null){s=65533;o=1}else if(s>65535){s-=65536;n.push(s>>>10&1023|55296);s=56320|s&1023}n.push(s);i+=o}return z(n)}var D=4096;function z(e){var t=e.length;if(t<=D){return String.fromCharCode.apply(String,e)}var r="";var n=0;while(n<t){r+=String.fromCharCode.apply(String,e.slice(n,n+=D))}return r}function B(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i){n+=String.fromCharCode(e[i]&127)}return n}function L(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i){n+=String.fromCharCode(e[i])}return n}function P(e,t,r){var n=e.length;if(!t||t<0)t=0;if(!r||r<0||r>n)r=n;var i="";for(var a=t;a<r;++a){i+=W(e[a])}return i}function M(e,t,r){var n=e.slice(t,r);var i="";for(var a=0;a<n.length;a+=2){i+=String.fromCharCode(n[a]+n[a+1]*256)}return i}u.prototype.slice=function e(t,r){var n=this.length;t=~~t;r=r===undefined?n:~~r;if(t<0){t+=n;if(t<0)t=0}else if(t>n){t=n}if(r<0){r+=n;if(r<0)r=0}else if(r>n){r=n}if(r<t)r=t;var i;if(u.TYPED_ARRAY_SUPPORT){i=this.subarray(t,r);i.__proto__=u.prototype}else{var a=r-t;i=new u(a,undefined);for(var s=0;s<a;++s){i[s]=this[s+t]}}return i};function U(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUIntLE=function e(t,r,n){t=t|0;r=r|0;if(!n)U(t,r,this.length);var i=this[t];var a=1;var s=0;while(++s<r&&(a*=256)){i+=this[t+s]*a}return i};u.prototype.readUIntBE=function e(t,r,n){t=t|0;r=r|0;if(!n){U(t,r,this.length)}var i=this[t+--r];var a=1;while(r>0&&(a*=256)){i+=this[t+--r]*a}return i};u.prototype.readUInt8=function e(t,r){if(!r)U(t,1,this.length);return this[t]};u.prototype.readUInt16LE=function e(t,r){if(!r)U(t,2,this.length);return this[t]|this[t+1]<<8};u.prototype.readUInt16BE=function e(t,r){if(!r)U(t,2,this.length);return this[t]<<8|this[t+1]};u.prototype.readUInt32LE=function e(t,r){if(!r)U(t,4,this.length);return(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};u.prototype.readUInt32BE=function e(t,r){if(!r)U(t,4,this.length);return this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};u.prototype.readIntLE=function e(t,r,n){t=t|0;r=r|0;if(!n)U(t,r,this.length);var i=this[t];var a=1;var s=0;while(++s<r&&(a*=256)){i+=this[t+s]*a}a*=128;if(i>=a)i-=Math.pow(2,8*r);return i};u.prototype.readIntBE=function e(t,r,n){t=t|0;r=r|0;if(!n)U(t,r,this.length);var i=r;var a=1;var s=this[t+--i];while(i>0&&(a*=256)){s+=this[t+--i]*a}a*=128;if(s>=a)s-=Math.pow(2,8*r);return s};u.prototype.readInt8=function e(t,r){if(!r)U(t,1,this.length);if(!(this[t]&128))return this[t];return(255-this[t]+1)*-1};u.prototype.readInt16LE=function e(t,r){if(!r)U(t,2,this.length);var n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n};u.prototype.readInt16BE=function e(t,r){if(!r)U(t,2,this.length);var n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n};u.prototype.readInt32LE=function e(t,r){if(!r)U(t,4,this.length);return this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};u.prototype.readInt32BE=function e(t,r){if(!r)U(t,4,this.length);return this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};u.prototype.readFloatLE=function e(t,r){if(!r)U(t,4,this.length);return i.read(this,t,true,23,4)};u.prototype.readFloatBE=function e(t,r){if(!r)U(t,4,this.length);return i.read(this,t,false,23,4)};u.prototype.readDoubleLE=function e(t,r){if(!r)U(t,8,this.length);return i.read(this,t,true,52,8)};u.prototype.readDoubleBE=function e(t,r){if(!r)U(t,8,this.length);return i.read(this,t,false,52,8)};function F(e,t,r,n,i,a){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}u.prototype.writeUIntLE=function e(t,r,n,i){t=+t;r=r|0;n=n|0;if(!i){var a=Math.pow(2,8*n)-1;F(this,t,r,n,a,0)}var s=1;var o=0;this[r]=t&255;while(++o<n&&(s*=256)){this[r+o]=t/s&255}return r+n};u.prototype.writeUIntBE=function e(t,r,n,i){t=+t;r=r|0;n=n|0;if(!i){var a=Math.pow(2,8*n)-1;F(this,t,r,n,a,0)}var s=n-1;var o=1;this[r+s]=t&255;while(--s>=0&&(o*=256)){this[r+s]=t/o&255}return r+n};u.prototype.writeUInt8=function e(t,r,n){t=+t;r=r|0;if(!n)F(this,t,r,1,255,0);if(!u.TYPED_ARRAY_SUPPORT)t=Math.floor(t);this[r]=t&255;return r+1};function j(e,t,r,n){if(t<0)t=65535+t+1;for(var i=0,a=Math.min(e.length-r,2);i<a;++i){e[r+i]=(t&255<<8*(n?i:1-i))>>>(n?i:1-i)*8}}u.prototype.writeUInt16LE=function e(t,r,n){t=+t;r=r|0;if(!n)F(this,t,r,2,65535,0);if(u.TYPED_ARRAY_SUPPORT){this[r]=t&255;this[r+1]=t>>>8}else{j(this,t,r,true)}return r+2};u.prototype.writeUInt16BE=function e(t,r,n){t=+t;r=r|0;if(!n)F(this,t,r,2,65535,0);if(u.TYPED_ARRAY_SUPPORT){this[r]=t>>>8;this[r+1]=t&255}else{j(this,t,r,false)}return r+2};function Z(e,t,r,n){if(t<0)t=4294967295+t+1;for(var i=0,a=Math.min(e.length-r,4);i<a;++i){e[r+i]=t>>>(n?i:3-i)*8&255}}u.prototype.writeUInt32LE=function e(t,r,n){t=+t;r=r|0;if(!n)F(this,t,r,4,4294967295,0);if(u.TYPED_ARRAY_SUPPORT){this[r+3]=t>>>24;this[r+2]=t>>>16;this[r+1]=t>>>8;this[r]=t&255}else{Z(this,t,r,true)}return r+4};u.prototype.writeUInt32BE=function e(t,r,n){t=+t;r=r|0;if(!n)F(this,t,r,4,4294967295,0);if(u.TYPED_ARRAY_SUPPORT){this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255}else{Z(this,t,r,false)}return r+4};u.prototype.writeIntLE=function e(t,r,n,i){t=+t;r=r|0;if(!i){var a=Math.pow(2,8*n-1);F(this,t,r,n,a-1,-a)}var s=0;var o=1;var f=0;this[r]=t&255;while(++s<n&&(o*=256)){if(t<0&&f===0&&this[r+s-1]!==0){f=1}this[r+s]=(t/o>>0)-f&255}return r+n};u.prototype.writeIntBE=function e(t,r,n,i){t=+t;r=r|0;if(!i){var a=Math.pow(2,8*n-1);F(this,t,r,n,a-1,-a)}var s=n-1;var o=1;var f=0;this[r+s]=t&255;while(--s>=0&&(o*=256)){if(t<0&&f===0&&this[r+s+1]!==0){f=1}this[r+s]=(t/o>>0)-f&255}return r+n};u.prototype.writeInt8=function e(t,r,n){t=+t;r=r|0;if(!n)F(this,t,r,1,127,-128);if(!u.TYPED_ARRAY_SUPPORT)t=Math.floor(t);if(t<0)t=255+t+1;this[r]=t&255;return r+1};u.prototype.writeInt16LE=function e(t,r,n){t=+t;r=r|0;if(!n)F(this,t,r,2,32767,-32768);if(u.TYPED_ARRAY_SUPPORT){this[r]=t&255;this[r+1]=t>>>8}else{j(this,t,r,true)}return r+2};u.prototype.writeInt16BE=function e(t,r,n){t=+t;r=r|0;if(!n)F(this,t,r,2,32767,-32768);if(u.TYPED_ARRAY_SUPPORT){this[r]=t>>>8;this[r+1]=t&255}else{j(this,t,r,false)}return r+2};u.prototype.writeInt32LE=function e(t,r,n){t=+t;r=r|0;if(!n)F(this,t,r,4,2147483647,-2147483648);if(u.TYPED_ARRAY_SUPPORT){this[r]=t&255;this[r+1]=t>>>8;this[r+2]=t>>>16;this[r+3]=t>>>24}else{Z(this,t,r,true)}return r+4};u.prototype.writeInt32BE=function e(t,r,n){t=+t;r=r|0;if(!n)F(this,t,r,4,2147483647,-2147483648);if(t<0)t=4294967295+t+1;if(u.TYPED_ARRAY_SUPPORT){this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255}else{Z(this,t,r,false)}return r+4};function X(e,t,r,n,i,a){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Y(e,t,r,n,a){if(!a){X(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38)}i.write(e,t,r,n,23,4);return r+4}u.prototype.writeFloatLE=function e(t,r,n){return Y(this,t,r,true,n)};u.prototype.writeFloatBE=function e(t,r,n){return Y(this,t,r,false,n)};function V(e,t,r,n,a){if(!a){X(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308)}i.write(e,t,r,n,52,8);return r+8}u.prototype.writeDoubleLE=function e(t,r,n){return V(this,t,r,true,n)};u.prototype.writeDoubleBE=function e(t,r,n){return V(this,t,r,false,n)};u.prototype.copy=function e(t,r,n,i){if(!n)n=0;if(!i&&i!==0)i=this.length;if(r>=t.length)r=t.length;if(!r)r=0;if(i>0&&i<n)i=n;if(i===n)return 0;if(t.length===0||this.length===0)return 0;if(r<0){throw new RangeError("targetStart out of bounds")}if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");if(i>this.length)i=this.length;if(t.length-r<i-n){i=t.length-r+n}var a=i-n;var s;if(this===t&&n<r&&r<i){for(s=a-1;s>=0;--s){t[s+r]=this[s+n]}}else if(a<1e3||!u.TYPED_ARRAY_SUPPORT){for(s=0;s<a;++s){t[s+r]=this[s+n]}}else{Uint8Array.prototype.set.call(t,this.subarray(n,n+a),r)}return a};u.prototype.fill=function e(t,r,n,i){if(typeof t==="string"){if(typeof r==="string"){i=r;r=0;n=this.length}else if(typeof n==="string"){i=n;n=this.length}if(t.length===1){var a=t.charCodeAt(0);if(a<256){t=a}}if(i!==undefined&&typeof i!=="string"){throw new TypeError("encoding must be a string")}if(typeof i==="string"&&!u.isEncoding(i)){throw new TypeError("Unknown encoding: "+i)}}else if(typeof t==="number"){t=t&255}if(r<0||this.length<r||this.length<n){throw new RangeError("Out of range index")}if(n<=r){return this}r=r>>>0;n=n===undefined?this.length:n>>>0;if(!t)t=0;var s;if(typeof t==="number"){for(s=r;s<n;++s){this[s]=t}}else{var o=u.isBuffer(t)?t:q(new u(t,i).toString());var f=o.length;for(s=0;s<n-r;++s){this[s+r]=o[s%f]}}return this};var H=/[^+\/0-9A-Za-z-_]/g;function $(e){e=G(e).replace(H,"");if(e.length<2)return"";while(e.length%4!==0){e=e+"="}return e}function G(e){if(e.trim)return e.trim();return e.replace(/^\s+|\s+$/g,"")}function W(e){if(e<16)return"0"+e.toString(16);return e.toString(16)}function q(e,t){t=t||Infinity;var r;var n=e.length;var i=null;var a=[];for(var s=0;s<n;++s){r=e.charCodeAt(s);if(r>55295&&r<57344){if(!i){if(r>56319){if((t-=3)>-1)a.push(239,191,189);continue}else if(s+1===n){if((t-=3)>-1)a.push(239,191,189);continue}i=r;continue}if(r<56320){if((t-=3)>-1)a.push(239,191,189);i=r;continue}r=(i-55296<<10|r-56320)+65536}else if(i){if((t-=3)>-1)a.push(239,191,189)}i=null;if(r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else{throw new Error("Invalid code point")}}return a}function K(e){var t=[];for(var r=0;r<e.length;++r){t.push(e.charCodeAt(r)&255)}return t}function J(e,t){var r,n,i;var a=[];for(var s=0;s<e.length;++s){if((t-=2)<0)break;r=e.charCodeAt(s);n=r>>8;i=r%256;a.push(i);a.push(n)}return a}function Q(e){return n.toByteArray($(e))}function ee(e,t,r,n){for(var i=0;i<n;++i){if(i+r>=t.length||i>=e.length)break;t[i+r]=e[i]}return i}function te(e){return e!==e}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"base64-js":12,ieee754:34,isarray:35}],14:[function(e,t,r){"use strict";function n(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}var i=e("xmldom"),a=i.DOMParser,s=i.XMLSerializer;var o=e("./errors"),f=o.throwXmlTagNotFound;var u={};function l(e){return n({},"get",function t(r){if(e==="."){return r}return r[e]})}u.defaults={nullGetter:function e(t){if(!t.module){return"undefined"}if(t.module==="rawxml"){return""}return""},parser:l,delimiters:{start:"{",end:"}"}};u.mergeObjects=function(){var e={};var t=void 0,r=void 0;for(var n=0;n<arguments.length;n+=1){t=arguments[n];r=Object.keys(t);for(var i=0;i<r.length;i+=1){e[r[i]]=t[r[i]]}}return e};u.xml2str=function(e){var t=new s;return t.serializeToString(e)};u.str2xml=function(e,t){var r=new a({errorHandler:t});return r.parseFromString(e,"text/xml")};u.charMap={"&":"&amp;","'":"&apos;","<":"&lt;",">":"&gt;",'"':"&quot;"};var c=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;u.escapeRegExp=function(e){return e.replace(c,"\\$&")};u.charMapRegexes=Object.keys(u.charMap).map(function(e){var t=u.charMap[e];return{rstart:new RegExp(u.escapeRegExp(t),"g"),rend:new RegExp(u.escapeRegExp(e),"g"),start:t,end:e}});u.wordToUtf8=function(e){var t=void 0;for(var r=0,n=u.charMapRegexes.length;r<n;r++){t=u.charMapRegexes[r];e=e.replace(t.rstart,t.end)}return e};u.utf8ToWord=function(e){if(typeof e!=="string"){e=e.toString()}var t=void 0;for(var r=0,n=u.charMapRegexes.length;r<n;r++){t=u.charMapRegexes[r];e=e.replace(t.rend,t.start)}return e};u.concatArrays=function(e){var t=[];for(var r=0;r<e.length;r++){var n=e[r];for(var i=0,a=n.length;i<a;i++){t.push(n[i])}}return t};var h=new RegExp(String.fromCharCode(160),"g");u.convertSpaces=function(e){return e.replace(h," ")};u.pregMatchAll=function(e,t){var r=[];var n=void 0;while((n=e.exec(t))!=null){r.push({array:n,offset:n.index})}return r};u.getRight=function(e,t,r){for(var n=r,i=e.length;n<i;n++){var a=e[n];if(a.value==="</"+t+">"){return n}}f({position:"right",element:t,parsed:e,index:r})};u.getLeft=function(e,t,r){for(var n=r;n>=0;n--){var i=e[n];if(i.value.indexOf("<"+t)===0&&[">"," "].indexOf(i.value[t.length+1])!==-1){return n}}f({position:"left",element:t,parsed:e,index:r})};t.exports=u},{"./errors":16,xmldom:76}],15:[function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=e("./doc-utils");a.traits=e("./traits");a.moduleWrapper=e("./module-wrapper");var s=a.defaults,o=a.str2xml,f=a.xml2str,u=a.moduleWrapper,l=a.concatArrays;var c=e("./errors"),h=c.XTInternalError,d=c.throwFileTypeNotIdentified,p=c.throwFileTypeNotHandled;var v=function(){function e(){i(this,e);if(arguments.length>0){throw new Error("The constructor with parameters has been removed in docxtemplater 3.0, please check the upgrade guide.")}this.compiled={};this.modules=[];this.setOptions({})}n(e,[{key:"setModules",value:function e(t){this.modules.forEach(function(e){e.set(t)})}},{key:"sendEvent",value:function e(t){this.modules.forEach(function(e){e.on(t)})}},{key:"attachModule",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=r.prefix;if(n){t.prefix=n}this.modules.push(u(t));return this}},{key:"setOptions",value:function e(t){var r=this;this.options=t;Object.keys(s).forEach(function(e){var t=s[e];r[e]=r.options[e]!=null?r.options[e]:t});if(this.zip){this.updateFileTypeConfig()}return this}},{key:"loadZip",value:function e(t){if(t.loadAsync){throw new h("Docxtemplater doesn't handle JSZip version >=3, see changelog")}this.zip=t;this.updateFileTypeConfig();return this}},{key:"compileFile",value:function e(t){var r=this.createTemplateClass(t);r.parse();this.compiled[t]=r}},{key:"compile",value:function e(){var t=this;if(Object.keys(this.compiled).length){return this}this.options.xmlFileNames=[];this.modules=l([this.fileTypeConfig.baseModules.map(function(e){return e()}),this.modules]);this.options=this.modules.reduce(function(e,r){return r.optionsTransformer(e,t)},this.options);this.xmlDocuments=this.options.xmlFileNames.reduce(function(e,r){var n=t.zip.files[r].asText();e[r]=o(n);return e},{});this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments,data:this.data});this.getTemplatedFiles();this.setModules({compiled:this.compiled});this.templatedFiles.forEach(function(e){if(t.zip.files[e]!=null){t.compileFile(e)}});return this}},{key:"updateFileTypeConfig",value:function t(){var r=this;var n={docx:"word/document.xml",pptx:"ppt/presentation.xml",odt:"mimetype"};var i=Object.keys(n).reduce(function(e,t){if(e){return e}if(r.zip.files[n[t]]){return t}return e},null);if(i==="odt"){p(i)}if(!i){d()}this.fileType=i;this.fileTypeConfig=this.options.fileTypeConfig||e.FileTypeConfig[this.fileType];return this}},{key:"render",value:function e(){var t=this;this.compile();this.mapper=this.modules.reduce(function(e,t){return t.getRenderedMap(e)},{});Object.keys(this.mapper).forEach(function(e){var r=t.mapper[e],n=r.from,i=r.data;var a=t.compiled[n];a.setTags(i);a.render(e);t.zip.file(e,a.content,{createFolders:true})});this.sendEvent("syncing-zip");this.syncZip();return this}},{key:"syncZip",value:function e(){var t=this;Object.keys(this.xmlDocuments).forEach(function(e){t.zip.remove(e);var r=f(t.xmlDocuments[e]);return t.zip.file(e,r,{createFolders:true})})}},{key:"setData",value:function e(t){this.data=t;return this}},{key:"getZip",value:function e(){return this.zip}},{key:"createTemplateClass",value:function e(t){var r=this.zip.files[t].asText();return this.createTemplateClassFromContent(r,t)}},{key:"createTemplateClassFromContent",value:function t(r,n){var i=this;var a={filePath:n};Object.keys(s).forEach(function(e){a[e]=i[e]});a.fileTypeConfig=this.fileTypeConfig;a.modules=this.modules;return new e.XmlTemplater(r,a)}},{key:"getFullText",value:function e(t){return this.createTemplateClass(t||this.fileTypeConfig.textPath).getFullText()}},{key:"getTemplatedFiles",value:function e(){this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip);return this.templatedFiles}}]);return e}();v.DocUtils=a;v.Errors=e("./errors");v.XmlTemplater=e("./xml-templater");v.FileTypeConfig=e("./file-type-config");v.XmlMatcher=e("./xml-matcher");t.exports=v},{"./doc-utils":14,"./errors":16,"./file-type-config":17,"./module-wrapper":20,"./traits":29,"./xml-matcher":30,"./xml-templater":31}],16:[function(e,t,r){"use strict";function n(e){return e[0]}function i(e){return e[e.length-1]}function a(e){this.name="GenericError";this.message=e;this.stack=new Error(e).stack}a.prototype=Error.prototype;function s(e){this.name="TemplateError";this.message=e;this.stack=new Error(e).stack}s.prototype=new a;function o(e){this.name="RenderingError";this.message=e;this.stack=new Error(e).stack}o.prototype=new a;function f(e){this.name="ScopeParserError";this.message=e;this.stack=new Error(e).stack}f.prototype=new a;function u(e){this.name="InternalError";this.properties={explanation:"InternalError"};this.message=e;this.stack=new Error(e).stack}u.prototype=new a;function l(e){var t=new s("Multi error");t.properties={errors:e,id:"multi_error",explanation:"The template has multiple errors"};throw t}function c(e){var t=new s("Unopened tag");t.properties={xtag:i(e.xtag.split(" ")),id:"unopened_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'+e.xtag.substr(0,10)+'" is unopened'};return t}function h(e){var t=new s("Unclosed tag");t.properties={xtag:n(e.xtag.split(" ")).substr(1),id:"unclosed_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'+e.xtag.substr(0,10)+'" is unclosed'};return t}function d(e){var t=new s('No tag "'+e.element+'" was found at the '+e.position);t.properties={id:"no_xml_tag_found_at_"+e.position,explanation:'No tag "'+e.element+'" was found at the '+e.position,parsed:e.parsed,index:e.index,element:e.element};throw t}function p(e){var t=new u("End");t.properties={id:"utf8_decode",data:e,explanation:"Could not decode string to UTF8"};throw t}function v(e){var t=new u("Content must be a string");t.properties.id="xmltemplater_content_must_be_string";t.properties.type=e;throw t}function m(e){var t=new s("Raw tag not in paragraph");var r=e.part,n=r.value,i=r.offset;t.properties={id:"raw_tag_outerxml_invalid",explanation:'The tag "'+n+'" is not inside a paragraph',rootError:e.rootError,xtag:n,offset:i,postparsed:e.postparsed,expandTo:e.expandTo,index:e.index};throw t}function g(e){var t=new s("Raw tag should be the only text in paragraph");var r=e.part.value;t.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The tag "'+r+'" should be the only text in this paragraph',xtag:e.part.value,offset:e.part.offset,paragraphParts:e.paragraphParts};throw t}function w(e){var t=e.location;var r=t==="start"?"unclosed":"unopened";var n=t==="start"?"Unclosed":"Unopened";var i=new s(n+" loop");var a=e.part.value;i.properties={id:r+"_loop",explanation:'The loop with tag "'+a+'" is '+r,xtag:a};return i}function y(e){var t=e.tags;var r=new s("Closing tag does not match opening tag");r.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'+t[0].value+'" is closed by the tag "'+t[1].value+'"',openingtag:t[0].value,offset:[t[0].offset,t[1].offset],closingtag:t[1].value};return r}function _(e){var t=e.tag,r=e.rootError;var n=new f("Scope parser compilation failed");n.properties={id:"scopeparser_compilation_failed",tag:t,explanation:'The scope parser for the tag "'+t+'" failed to compile',rootError:r};return n}function b(e){var t=e.tag;var r=new s('The position of the loop tags "'+t+'" would produce invalid XML');r.properties={tag:t,id:"loop_position_invalid",explanation:'The tags "'+t+'" are misplaced in the document, for example one of them is in a table and the other one outside the table'};return r}function x(e){var t=new s('Unimplemented tag type "'+e.type+'"');t.properties={part:e,id:"unimplemented_tag_type"};throw t}function E(e){var t=new u("Malformed xml");t.properties={part:e,id:"malformed_xml"};throw t}function T(e){throw new u('Location should be one of "start" or "end" (given : '+e.location+")")}function k(e){var t=new u('The filetype "'+e+'" is not handled by docxtemplater');t.properties={id:"filetype_not_handled",explanation:'The file you are trying to generate is of type "'+e+'", but only docx and pptx formats are handled'};throw t}function A(){var e=new u("The filetype for this file could not be identified, is this file corrupted ?");e.properties={id:"filetype_not_identified"};throw e}t.exports={XTError:a,XTTemplateError:s,XTInternalError:u,XTScopeParserError:f,RenderingError:o,throwMultiError:l,throwXmlTagNotFound:d,throwDecodeUTF8Error:p,throwContentMustBeString:v,getUnmatchedLoopException:w,throwRawTagShouldBeOnlyTextInParagraph:g,throwRawTagNotInParagraph:m,getClosingTagNotMatchOpeningTag:y,throwUnimplementedTagType:x,getScopeCompilationError:_,getUnopenedTagException:c,getUnclosedTagException:h,throwMalformedXml:E,throwFileTypeNotIdentified:A,throwFileTypeNotHandled:k,getLoopPositionProducesInvalidXMLError:b,throwLocationInvalid:T}},{}],17:[function(e,t,r){"use strict";var n=e("./modules/loop");var i=e("./modules/space-preserve");var a=e("./modules/rawxml");var s=e("./modules/expand-pair-trait");var o=e("./modules/render");var f={getTemplatedFiles:function e(t){var r=t.file(/ppt\/(slides|slideMasters)\/(slide|slideMaster)\d+\.xml/).map(function(e){return e.name});return r.concat(["ppt/presentation.xml"])},textPath:"ppt/slides/slide1.xml",tagsXmlTextArray:["a:t","m:t"],tagsXmlLexedArray:["p:sp","a:tc","a:tr","a:table","a:p","a:r"],tagRawXml:"p:sp",tagTextXml:"a:t",baseModules:[n,s,a,o]};var u={getTemplatedFiles:function e(t){var r=["docProps/core.xml","docProps/app.xml","word/document.xml"];var n=t.file(/word\/(header|footer)\d+\.xml/).map(function(e){return e.name});return n.concat(r)},textPath:"word/document.xml",tagsXmlTextArray:["w:t","m:t","vt:lpstr","dc:title","dc:creator","cp:keywords"],tagsXmlLexedArray:["w:tc","w:tr","w:table","w:p","w:r"],tagRawXml:"w:p",tagTextXml:"w:t",baseModules:[n,i,s,a,o]};t.exports={docx:u,pptx:f}},{"./modules/expand-pair-trait":21,"./modules/loop":22,"./modules/rawxml":23,"./modules/render":24,"./modules/space-preserve":25}],18:[function(e,t,r){"use strict";var n=e("./errors"),i=n.getUnclosedTagException,a=n.getUnopenedTagException,s=n.throwMalformedXml;var o=e("./doc-utils"),f=o.concatArrays;function u(e,t){return e[0]<=t.offset&&t.offset<e[1]}function l(e,t){if(e.type==="tag"&&e.position==="start"&&e.text){if(t){s(e)}return true}if(e.type==="tag"&&e.position==="end"&&e.text){if(!t){s(e)}return false}return t}function c(e,t){return e.offset-t.offset}function h(e){var t="start";var r=1;if(e[e.length-2]==="/"){t="selfclosing"}if(e[1]==="/"){r=2;t="end"}var n=e.indexOf(" ");var i=n===-1?e.length-1:n;return{tag:e.slice(r,i),position:t}}function d(e,t,r){var n=0;var i=e.length;var a=f([t.map(function(e){return{tag:e,text:true}}),r.map(function(e){return{tag:e,text:false}})]).reduce(function(e,t){e[t.tag]=t.text;return e},{});var s=[];while(n<i){n=e.indexOf("<",n);if(n===-1){break}var o=n;n=e.indexOf(">",n);var u=e.slice(o,n+1);var l=h(u),c=l.tag,d=l.position;var p=a[c];if(p==null){continue}s.push({type:"tag",position:d,text:p,offset:o,value:u,tag:c})}return s}function p(e,t,r){if(e.length===0){return[]}var n=[];var s=false;var o={offset:0};var f=void 0;var u=0;e.forEach(function(e){while(r[u+1]){if(r[u+1].offset>e.offset){break}u++}f=t.substr(o.offset,e.offset-o.offset);if(e.position==="start"&&s||e.position==="end"&&!s){if(e.position==="start"){n.push(i({xtag:f,offset:o.offset}));e.error=true}else{n.push(a({xtag:f,offset:e.offset}));e.error=true}}else{s=!s}o=e});var l={offset:t.length};f=t.substr(o.offset,l.offset-o.offset);if(s){n.push(i({xtag:f,offset:o.offset}));l.error=true}return n}function v(e,t,r){var n=[];var i=-1;do{i=e.indexOf(t,i+1);if(i!==-1){n.push({offset:i,position:r})}}while(i!==-1);return n}function m(e){var t=this;this.innerContentParts=e;this.full="";this.parseDelimiters=function(e){t.full=t.innerContentParts.map(function(e){return e.value}).join("");var r=f([v(t.full,e.start,"start"),v(t.full,e.end,"end")]).sort(c);var n=0;var i=t.innerContentParts.map(function(e){n+=e.value.length;return{offset:n-e.value.length,lIndex:e.lIndex}});var a=p(r,t.full,i);var s={start:e.start.length,end:e.end.length};var o=0;var l=0;t.parsed=i.map(function(e,t){var n=e.offset;var i=[n,n+this.innerContentParts[t].value.length];var a=this.innerContentParts[t].value;var f=[];while(l<r.length&&u(i,r[l])){f.push(r[l]);l++}var c=[];var h=0;if(o>0){h=o;o=0}f.forEach(function(e){var t=a.substr(h,e.offset-n-h);if(t.length>0){c.push({type:"content",value:t,offset:h+n});h+=t.length}var r={type:"delimiter",position:e.position,offset:h+n};if(e.error){r.error=e.error}c.push(r);h=e.offset-n+s[e.position]});o=h-a.length;var d=a.substr(h);if(d.length>0){c.push({type:"content",value:d,offset:n})}return c},t);t.errors=a}}t.exports={parse:function e(t,r){var n=false;var i=[];t.forEach(function(e){n=l(e,n);if(n&&e.type==="content"){i.push(e)}});var a=new m(i);a.parseDelimiters(r);var s=[];var o=0;t.forEach(function(e){n=l(e,n);if(e.type==="content"){e.position=n?"insidetag":"outsidetag"}if(n&&e.type==="content"){Array.prototype.push.apply(s,a.parsed[o].map(function(e){if(e.type==="content"){e.position="insidetag"}return e}));o++}else{s.push(e)}});return{errors:a.errors,lexed:s}},xmlparse:function e(t,r){var n=d(t,r.text,r.other);var i=0;var a=n.reduce(function(e,r){var n=t.substr(i,r.offset-i);if(n.length>0){e.push({type:"content",value:n})}i=r.offset+r.value.length;delete r.offset;if(r.value.length>0){e.push(r)}return e},[]).map(function(e,t){e.lIndex=t;return e});var s=t.substr(i);if(s.length>0){a.push({type:"content",value:s})}return a}}},{"./doc-utils":14,"./errors":16}],19:[function(e,t,r){"use strict";function n(e,t){var r=-1;for(var n=0,i=e.length;n<i;n++){if(t[n]>=e[n].length){continue}if(r===-1||e[n][t[n]].offset<e[r][t[r]].offset){r=n}}if(r===-1){throw new Error("minIndex negative")}return r}t.exports=function(e){var t=e.reduce(function(e,t){return e+t.length},0);e=e.filter(function(e){return e.length>0});var r=new Array(t);var i=e.map(function(){return 0});var a=0;while(a<=t-1){var s=n(e,i);r[a]=e[s][i[s]];i[s]++;a++}return r}},{}],20:[function(e,t,r){"use strict";function n(){}function i(e){return e}t.exports=function(e){var t={set:n,parse:n,render:n,getTraits:n,optionsTransformer:i,errorsTransformer:i,getRenderedMap:i,postparse:i,on:n};if(Object.keys(t).every(function(t){return!e[t]})){throw new Error("This module cannot be wrapped, because it doesn't define any of the necessary functions")}Object.keys(t).forEach(function(r){e[r]=e[r]||t[r]});return e}},{}],21:[function(e,t,r){"use strict";var n=function(){function e(e,t){var r=[];var n=true;var i=false;var a=undefined;try{for(var s=e[Symbol.iterator](),o;!(n=(o=s.next()).done);n=true){r.push(o.value);if(t&&r.length===t)break}}catch(e){i=true;a=e}finally{try{if(!n&&s["return"])s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t)){return t}else if(Symbol.iterator in Object(t)){return e(t,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var i="expandPair";var a=e("../mergesort");var s=e("../doc-utils"),o=s.getLeft,f=s.getRight;var u=e("../module-wrapper");var l=e("../traits"),c=l.getExpandToDefault;var h=e("../errors"),d=h.getUnmatchedLoopException,p=h.getClosingTagNotMatchOpeningTag,v=h.throwLocationInvalid;function m(e){switch(e.location){case"start":return 1;case"end":return-1;default:v(e)}}function g(e){var t=[];var r=[];if(e.length===0){return{pairs:r,errors:t}}var i=1;var a=n(e,1),s=a[0];if(s.part.location==="start"){for(var o=1;o<e.length;o++){var f=e[o];i+=m(f.part);if(i===0){var u=g(e.slice(o+1));if(f.part.value!==s.part.value&&f.part.value!==""){t.push(p({tags:[s.part,f.part]}))}else{r=[[s,f]]}return{pairs:r.concat(u.pairs),errors:t.concat(u.errors)}}}}var l=s.part;t.push(d({part:l,location:l.location}));var c=g(e.slice(1));return{pairs:c.pairs,errors:t.concat(c.errors)}}var w={name:"ExpandPairTrait",postparse:function e(t,r){var n=r.getTraits,s=r.postparse;var u=n(i,t);u=u.map(function(e){return e||[]});u=a(u);var l=g(u),h=l.pairs,d=l.errors;var p=h.map(function(e){var r=e[0].part.expandTo;if(r==="auto"){var n=c(t.slice(e[0].offset,e[1].offset),e);if(n.error){d.push(n.error)}r=n.value}if(!r){return[e[0].offset,e[1].offset]}var i=o(t,r,e[0].offset);var a=f(t,r,e[1].offset);return[i,a]});var v=0;var m=void 0;var w=t.reduce(function(e,r,n){var i=v<h.length&&p[v][0]<=n;var a=h[v];var o=p[v];if(!i){e.push(r);return e}if(o[0]===n){m=[]}if(a[0].offset!==n&&a[1].offset!==n){m.push(r)}if(o[1]===n){var f=t[a[0].offset];delete f.location;delete f.expandTo;f.subparsed=s(m);e.push(f);v++}return e},[]);return{postparsed:w,errors:d}}};t.exports=function(){return u(w)}},{"../doc-utils":14,"../errors":16,"../mergesort":19,"../module-wrapper":20,"../traits":29}],22:[function(e,t,r){"use strict";var n=e("../doc-utils"),i=n.mergeObjects;var a=/^-([^\s]+)\s(.+)$/;var s=e("../module-wrapper");var o="loop";var f={name:"LoopModule",prefix:{start:"#",end:"/",dash:"-",inverted:"^"},parse:function e(t){var r=o;var n="placeholder";var i=this.prefix;if(t[0]===i.start){return{type:n,value:t.substr(1),expandTo:"auto",module:r,location:"start",inverted:false}}if(t[0]===i.inverted){return{type:n,value:t.substr(1),expandTo:"auto",module:r,location:"start",inverted:true}}if(t[0]===i.end){return{type:n,value:t.substr(1),module:r,location:"end"}}if(t[0]===i.dash){var s=t.replace(a,"$2");var f=t.replace(a,"$1");return{type:n,value:s,expandTo:f,module:r,location:"start",inverted:false}}return null},getTraits:function e(t,r){if(t!=="expandPair"){return}return r.reduce(function(e,t,r){if(t.type==="placeholder"&&t.module===o){e.push({part:t,offset:r})}return e},[])},render:function e(t,r){if(!t.type==="placeholder"||t.module!==o){return null}var n=[];var a=[];function s(e){var s=r.scopeManager.createSubScopeManager(e,t.value);var o=r.render(i({},r,{compiled:t.subparsed,tags:{},scopeManager:s}));n=n.concat(o.parts);a=a.concat(o.errors||[])}r.scopeManager.loopOver(t.value,s,t.inverted);return{value:n.join(""),errors:a}}};t.exports=function(){return s(f)}},{"../doc-utils":14,"../module-wrapper":20}],23:[function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=e("../traits");var s=e("../errors"),o=s.throwRawTagShouldBeOnlyTextInParagraph;var f="rawxml";var u=e("../module-wrapper");function l(e){var t=e.part,r=e.left,n=e.right,i=e.postparsed,a=e.index;var s=i.slice(r+1,n);s.forEach(function(e,n){if(n===a-r-1){return}if(e.type==="placeholder"||e.type==="content"&&e.position==="insidetag"){o({paragraphParts:s,part:t})}});return t}var c=function(){function e(){i(this,e);this.name="RawXmlModule";this.prefix="@"}n(e,[{key:"optionsTransformer",value:function e(t,r){this.fileTypeConfig=r.fileTypeConfig;return t}},{key:"parse",value:function e(t){var r="placeholder";if(t[0]!==this.prefix){return null}return{type:r,value:t.substr(1),module:f}}},{key:"postparse",value:function e(t){return a.expandToOne(t,{moduleName:f,getInner:l,expandTo:this.fileTypeConfig.tagRawXml})}},{key:"render",value:function e(t,r){if(t.module!==f){return null}var n=r.scopeManager.getValue(t.value);if(n==null){n=r.nullGetter(t)}return{value:n}}}]);return e}();t.exports=function(){return u(new c)}},{"../errors":16,"../module-wrapper":20,"../traits":29}],24:[function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=e("../module-wrapper");var s=e("../errors"),o=s.getScopeCompilationError;var f=function(){function e(){i(this,e);this.name="Render"}n(e,[{key:"set",value:function e(t){if(t.compiled){this.compiled=t.compiled}if(t.data!=null){this.data=t.data}}},{key:"getRenderedMap",value:function e(t){var r=this;return Object.keys(this.compiled).reduce(function(e,t){e[t]={from:t,data:r.data};return e},t)}},{key:"optionsTransformer",value:function e(t,r){this.parser=r.parser;return t}},{key:"postparse",value:function e(t){var r=this;var n=[];t.forEach(function(e){if(e.type==="placeholder"){var t=e.value;try{r.parser(t)}catch(e){n.push(o({tag:t,rootError:e}))}}});return{postparsed:t,errors:n}}}]);return e}();t.exports=function(){return a(new f)}},{"../errors":16,"../module-wrapper":20}],25:[function(e,t,r){"use strict";var n=e("../module-wrapper");var i={name:"SpacePreserveModule",postparse:function e(t){var r=[];var n=false;var i=t.reduce(function(e,t){if(t.type==="tag"&&t.position==="start"&&t.text&&t.value==="<w:t>"){n=true}if(n){if(t.type==="placeholder"&&!t.module){r[0].value='<w:t xml:space="preserve">'}r.push(t)}else{e.push(t)}if(t.type==="tag"&&t.position==="end"&&t.text&&t.value==="</w:t>"){Array.prototype.push.apply(e,r);n=false;r=[]}return e},[]);Array.prototype.push.apply(i,r);return i}};t.exports=function(){return n(i)}},{"../module-wrapper":20}],26:[function(e,t,r){"use strict";var n=e("./doc-utils"),i=n.wordToUtf8,a=n.concatArrays;function s(e,t,r,n){var i=void 0;for(var a=0,s=e.length;a<s;a++){var o=e[a];i=o.parse(t);if(i){i.offset=n;r.push(i);return r}}r.push({type:"placeholder",value:t,offset:n});return r}var o={postparse:function e(t,r){function n(e,t){return r.map(function(r){return r.getTraits(e,t)})}var i=[];function e(t){return r.reduce(function(t,r){var s=r.postparse(t,{postparse:e,getTraits:n});if(s.errors){i=a([i,s.errors]);return s.postparsed}return s},t)}return{postparsed:e(t),errors:i}},parse:function e(t,r){var n=false;var a="";var o=void 0;var f=[];return t.filter(function(e){return!e.error}).reduce(function e(t,u){if(u.type==="delimiter"){n=u.position==="start";if(u.position==="end"){a=i(a);t=s(r,a,t,o);o=null;Array.prototype.push.apply(t,f);f=[]}else{o=u.offset}a="";return t}if(!n){t.push(u);return t}if(u.type!=="content"||u.position!=="insidetag"){f.push(u);return t}a+=u.value;return t},[])}};t.exports=o},{"./doc-utils":14}],27:[function(e,t,r){"use strict";var n=e("./doc-utils"),i=n.utf8ToWord,a=n.concatArrays;var s=e("./errors"),o=s.throwUnimplementedTagType;function f(e,t){var r=void 0;for(var n=0,i=t.modules.length;n<i;n++){var a=t.modules[n];r=a.render(e,t);if(r){return r}}return false}function u(e){var t=e.compiled,r=e.scopeManager,n=e.nullGetter;var s=[];var u=t.map(function(t){var u=f(t,e);if(u){if(u.errors){s=a([s,u.errors])}return u.value}if(t.type==="placeholder"){var l=r.getValue(t.value);if(l==null){l=n(t)}return i(l)}if(t.type==="content"||t.type==="tag"){return t.value}o(t)});return{errors:s,parts:u}}t.exports={render:u}},{"./doc-utils":14,"./errors":16}],28:[function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=e("./errors"),s=a.XTScopeParserError;var o=function(){function e(t){i(this,e);this.scopePath=t.scopePath;this.scopeList=t.scopeList;this.parser=t.parser}n(e,[{key:"loopOver",value:function e(t,r,n){n=n||false;return this.loopOverValue(this.getValue(t),r,n)}},{key:"functorIfInverted",value:function e(t,r,n){if(t){r(n)}}},{key:"isValueFalsy",value:function e(t,r){return t==null||!t||r==="[object Array]"&&t.length===0}},{key:"loopOverValue",value:function e(t,r,n){var i=Object.prototype.toString.call(t);var a=this.scopeList[this.num];if(this.isValueFalsy(t,i)){return this.functorIfInverted(n,r,a)}if(i==="[object Array]"){for(var s=0,o;s<t.length;s++){o=t[s];this.functorIfInverted(!n,r,o)}return}if(i==="[object Object]"){return this.functorIfInverted(!n,r,t)}return this.functorIfInverted(!n,r,a)}},{key:"getValue",value:function e(t,r){this.num=r==null?this.scopeList.length-1:r;var n=void 0;var i=void 0;var a=this.scopeList[this.num];var o=this.parser(t,{scopePath:this.scopePath});try{i=o.get(a,{num:this.num,scopeList:this.scopeList})}catch(e){n=new s("Scope parser execution failed");n.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag "+t+" failed to execute",scope:a,tag:t,rootError:e};throw n}if(i==null&&this.num>0){return this.getValue(t,this.num-1)}return i}},{key:"createSubScopeManager",value:function t(r,n){return new e({parser:this.parser,scopeList:this.scopeList.concat(r),scopePath:this.scopePath.concat(n)})}}]);return e}();t.exports=function(e){e.scopePath=[];e.scopeList=[e.tags];return new o(e)}},{"./errors":16}],29:[function(e,t,r){"use strict";var n=e("./doc-utils"),i=n.getRight,a=n.getLeft,s=n.concatArrays;var o=e("./errors"),f=o.XTTemplateError,u=o.throwRawTagNotInParagraph,l=o.getLoopPositionProducesInvalidXMLError;function c(e,t){if(e.length===0){return false}var r=e[e.length-1];var n=r.tag.substr(1);var i=t.substr(2,t.length-3);return n.indexOf(i)===0}function h(e,t){e.push({tag:t});return e}function d(e){var t=e.filter(function(e){return e.type==="tag"}).map(function(e){return e.value});var r=[];for(var n=0,i;n<t.length;n++){i=t[n];if(i[1]==="/"){if(c(r,i)){r.pop()}else{r=h(r,i)}}else if(i[i.length-1]!=="/"){r=h(r,i)}}return r}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];if(n.tag.indexOf(e)===0){return true}}return false}function v(e,t){var r=d(e);var n=r.filter(function(e){return e.tag[1]==="/"}).length;var i=r.filter(function(e){var t=e.tag;return t[1]!=="/"&&t[t.length-2]!=="/"}).length;if(n!==i){return{error:l({tag:t[0].part.value})}}if(p("<w:tc",r)){return{value:"w:tr"}}if(p("<a:tc",r)){return{value:"a:tr"}}return{value:false}}function m(e,t,r){var n=e.expandTo||r.expandTo;var o=t.indexOf(e);if(!n){return t}var l=void 0,c=void 0;try{l=i(t,n,o);c=a(t,n,o)}catch(r){if(r instanceof f){u({part:e,rootError:r,postparsed:t,expandTo:n,index:o})}throw r}var h=t.slice(c,o);var d=t.slice(o+1,l+1);var p=r.getInner({index:o,part:e,leftParts:h,rightParts:d,left:c,right:l,postparsed:t});if(!p.length){p.expanded=[h,d];p=[p]}return s([t.slice(0,c),p,t.slice(l+1)])}function g(e,t){var r=[];if(e.errors){r=e.errors;e=e.postparsed}var n=e.reduce(function(e,r){if(r.type==="placeholder"&&r.module===t.moduleName){e.push(r)}return e},[]);n.forEach(function(n){try{e=m(n,e,t)}catch(e){if(e instanceof f){r.push(e)}else{throw e}}});return{postparsed:e,errors:r}}t.exports={expandToOne:g,getExpandToDefault:v}},{"./doc-utils":14,"./errors":16}],30:[function(e,t,r){"use strict";var n=e("./doc-utils"),i=n.pregMatchAll;function a(e){function t(){var t={array:Array.prototype.slice.call(arguments)};t.array.shift();var r=t.array[0]+t.array[1];t.array.unshift(r);t.array.pop();var n=t.array.pop();t.offset=n;t.first=true;e.matches.unshift(t)}if(e.content.indexOf("<")===-1&&e.content.indexOf(">")===-1){e.content.replace(/^()([^<>]*)$/,t)}var r=new RegExp("^()([^<]+)</(?:"+e.tagsXmlArrayJoined+")>");e.content.replace(r,t);function n(){var t={array:Array.prototype.slice.call(arguments)};t.array.pop();var r=t.array.pop();t.offset=r;t.last=true;if(t.array[0].indexOf("/>")!==-1){return}e.matches.push(t)}r=new RegExp("(<(?:"+e.tagsXmlArrayJoined+")[^>]*>)([^>]+)$");e.content.replace(r,n);return e}t.exports=function e(t,r){var n={};n.content=t;n.tagsXmlArray=r;n.tagsXmlArrayJoined=n.tagsXmlArray.join("|");var s=new RegExp("(?:(<(?:"+n.tagsXmlArrayJoined+")[^>]*>)([^<>]*)</(?:"+n.tagsXmlArrayJoined+")>)|(<(?:"+n.tagsXmlArrayJoined+")[^>]*/>)","g");n.matches=i(s,n.content);return a(n)}},{"./doc-utils":14}],31:[function(e,t,r){"use strict";var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s=e("./doc-utils"),o=s.wordToUtf8,f=s.convertSpaces,u=s.defaults;var l=e("./scope-manager");var c=e("./xml-matcher");var h=e("./errors"),d=h.throwMultiError,p=h.throwContentMustBeString;var v=e("./lexer");var m=e("./parser.js");var g=e("./render.js"),w=g.render;function y(e,t){var r=c(e,t);var n=r.matches.map(function(e){return e.array[2]});return o(f(n.join("")))}t.exports=function(){function e(t,r){a(this,e);this.fromJson(r);this.setModules({inspect:{filePath:this.filePath}});this.load(t)}i(e,[{key:"load",value:function e(t){if(typeof t!=="string"){p(typeof t==="undefined"?"undefined":n(t))}this.content=t}},{key:"setTags",value:function e(t){this.tags=t!=null?t:{};this.scopeManager=l({tags:this.tags,parser:this.parser});return this}},{key:"fromJson",value:function e(t){this.filePath=t.filePath;this.modules=t.modules;this.fileTypeConfig=t.fileTypeConfig;Object.keys(u).map(function(e){this[e]=t[e]!=null?t[e]:u[e]},this)}},{key:"getFullText",value:function e(){return y(this.content,this.fileTypeConfig.tagsXmlTextArray)}},{key:"setModules",value:function e(t){this.modules.forEach(function(e){e.set(t)})}},{key:"parse",value:function e(){var t=[];this.xmllexed=v.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray});this.setModules({inspect:{xmllexed:this.xmllexed}});var r=v.parse(this.xmllexed,this.delimiters),n=r.lexed,i=r.errors;t=t.concat(i);this.lexed=n;this.setModules({inspect:{lexed:this.lexed}});this.parsed=m.parse(this.lexed,this.modules);this.setModules({inspect:{parsed:this.parsed}});var a=m.postparse(this.parsed,this.modules),s=a.postparsed,o=a.errors;this.postparsed=s;this.setModules({inspect:{postparsed:this.postparsed}});t=t.concat(o);this.errorChecker(t);return this}},{key:"errorChecker",value:function e(t){var r=this;if(t.length){this.modules.forEach(function(e){t=e.errorsTransformer(t)});t.forEach(function(e){e.properties.file=r.filePath});d(t)}}},{key:"render",value:function e(t){this.filePath=t;var r={compiled:this.postparsed,tags:this.tags,modules:this.modules,parser:this.parser,nullGetter:this.nullGetter,filePath:this.filePath,render:w};r.scopeManager=l(r);var n=w(r),i=n.errors,a=n.parts;this.errorChecker(i);this.content=a.join("");this.setModules({inspect:{content:this.content}});return this}}]);return e}()},{"./doc-utils":14,"./errors":16,"./lexer":18,"./parser.js":26,"./render.js":27,"./scope-manager":28,"./xml-matcher":30}],32:[function(e,t,r){function n(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}t.exports=n;n.EventEmitter=n;n.prototype._events=undefined;n.prototype._maxListeners=undefined;n.defaultMaxListeners=10;n.prototype.setMaxListeners=function(e){if(!a(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");this._maxListeners=e;return this};n.prototype.emit=function(e){var t,r,n,a,f,u;if(!this._events)this._events={};if(e==="error"){if(!this._events.error||s(this._events.error)&&!this._events.error.length){t=arguments[1];if(t instanceof Error){throw t}else{var l=new Error('Uncaught, unspecified "error" event. ('+t+")");l.context=t;throw l}}}r=this._events[e];if(o(r))return false;if(i(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1);r.apply(this,a)}}else if(s(r)){a=Array.prototype.slice.call(arguments,1);u=r.slice();n=u.length;for(f=0;f<n;f++)u[f].apply(this,a)}return true};n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",e,i(t.listener)?t.listener:t);if(!this._events[e])this._events[e]=t;else if(s(this._events[e]))this._events[e].push(t);else this._events[e]=[this._events[e],t];if(s(this._events[e])&&!this._events[e].warned){if(!o(this._maxListeners)){r=this._maxListeners}else{r=n.defaultMaxListeners}if(r&&r>0&&this._events[e].length>r){this._events[e].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[e].length);if(typeof console.trace==="function"){console.trace()}}}return this};n.prototype.on=n.prototype.addListener;n.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var r=false;function n(){this.removeListener(e,n);if(!r){r=true;t.apply(this,arguments)}}n.listener=t;this.on(e,n);return this};n.prototype.removeListener=function(e,t){var r,n,a,o;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;r=this._events[e];a=r.length;n=-1;if(r===t||i(r.listener)&&r.listener===t){delete this._events[e];if(this._events.removeListener)this.emit("removeListener",e,t)}else if(s(r)){for(o=a;o-- >0;){if(r[o]===t||r[o].listener&&r[o].listener===t){n=o;break}}if(n<0)return this;if(r.length===1){r.length=0;delete this._events[e]}else{r.splice(n,1)}if(this._events.removeListener)this.emit("removeListener",e,t)}return this};n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[e])delete this._events[e];return this}if(arguments.length===0){for(t in this._events){if(t==="removeListener")continue;this.removeAllListeners(t)}this.removeAllListeners("removeListener");this._events={};return this}r=this._events[e];if(i(r)){this.removeListener(e,r)}else if(r){while(r.length)this.removeListener(e,r[r.length-1])}delete this._events[e];return this};n.prototype.listeners=function(e){var t;if(!this._events||!this._events[e])t=[];else if(i(this._events[e]))t=[this._events[e]];else t=this._events[e].slice();return t};n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;else if(t)return t.length}return 0};n.listenerCount=function(e,t){return e.listenerCount(t)};function i(e){return typeof e==="function"}function a(e){return typeof e==="number"}function s(e){return typeof e==="object"&&e!==null}function o(e){return e===void 0}},{}],33:[function(e,t,r){var n=n||function(e){"use strict";if(typeof e==="undefined"||typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return}var t=e.document,r=function(){return e.URL||e.webkitURL||e},n=t.createElementNS("http://www.w3.org/1999/xhtml","a"),i="download"in n,a=function(e){var t=new MouseEvent("click");e.dispatchEvent(t)},s=/constructor/i.test(e.HTMLElement)||e.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent),f=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},u="application/octet-stream",l=1e3*40,c=function(e){var t=function(){if(typeof e==="string"){r().revokeObjectURL(e)}else{e.remove()}};setTimeout(t,l)},h=function(e,t,r){t=[].concat(t);var n=t.length;while(n--){var i=e["on"+t[n]];if(typeof i==="function"){try{i.call(e,r||e)}catch(e){f(e)}}}},d=function(e){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)){return new Blob([String.fromCharCode(65279),e],{type:e.type})}return e},p=function(t,f,l){if(!l){t=d(t)}var p=this,v=t.type,m=v===u,g,w=function(){h(p,"writestart progress write writeend".split(" "))},y=function(){if((o||m&&s)&&e.FileReader){var n=new FileReader;n.onloadend=function(){var t=o?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");var r=e.open(t,"_blank");if(!r)e.location.href=t;t=undefined;p.readyState=p.DONE;w()};n.readAsDataURL(t);p.readyState=p.INIT;return}if(!g){g=r().createObjectURL(t)}if(m){e.location.href=g}else{var i=e.open(g,"_blank");if(!i){e.location.href=g}}p.readyState=p.DONE;w();c(g)};p.readyState=p.INIT;if(i){g=r().createObjectURL(t);setTimeout(function(){n.href=g;n.download=f;a(n);w();c(g);p.readyState=p.DONE});return}y()},v=p.prototype,m=function(e,t,r){return new p(e,t||e.name||"download",r)};if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob){return function(e,t,r){t=t||e.name||"download";if(!r){e=d(e)}return navigator.msSaveOrOpenBlob(e,t)}}v.abort=function(){};v.readyState=v.INIT=0;v.WRITING=1;v.DONE=2;v.error=v.onwritestart=v.onprogress=v.onwrite=v.onabort=v.onerror=v.onwriteend=null;return m}(typeof self!=="undefined"&&self||typeof window!=="undefined"&&window||this.content);if(typeof t!=="undefined"&&t.exports){t.exports.saveAs=n}else if(typeof define!=="undefined"&&define!==null&&define.amd!==null){define("FileSaver.js",function(){return n})}},{}],34:[function(e,t,r){r.read=function(e,t,r,n,i){var a,s;var o=i*8-n-1;var f=(1<<o)-1;var u=f>>1;var l=-7;var c=r?i-1:0;var h=r?-1:1;var d=e[t+c];c+=h;a=d&(1<<-l)-1;d>>=-l;l+=o;for(;l>0;a=a*256+e[t+c],c+=h,l-=8){}s=a&(1<<-l)-1;a>>=-l;l+=n;for(;l>0;s=s*256+e[t+c],c+=h,l-=8){}if(a===0){a=1-u}else if(a===f){return s?NaN:(d?-1:1)*Infinity}else{s=s+Math.pow(2,n);a=a-u}return(d?-1:1)*s*Math.pow(2,a-n)};r.write=function(e,t,r,n,i,a){var s,o,f;var u=a*8-i-1;var l=(1<<u)-1;var c=l>>1;var h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0;var d=n?0:a-1;var p=n?1:-1;var v=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){o=isNaN(t)?1:0;s=l}else{s=Math.floor(Math.log(t)/Math.LN2);if(t*(f=Math.pow(2,-s))<1){s--;f*=2}if(s+c>=1){t+=h/f}else{t+=h*Math.pow(2,1-c)}if(t*f>=2){s++;f/=2}if(s+c>=l){o=0;s=l}else if(s+c>=1){o=(t*f-1)*Math.pow(2,i);s=s+c}else{o=t*Math.pow(2,c-1)*Math.pow(2,i);s=0}}for(;i>=8;e[r+d]=o&255,d+=p,o/=256,i-=8){}s=s<<i|o;u+=i;for(;u>0;e[r+d]=s&255,d+=p,s/=256,u-=8){}e[r+d-p]|=v*128}},{}],35:[function(e,t,r){var n={}.toString;t.exports=Array.isArray||function(e){return n.call(e)=="[object Array]"}},{}],36:[function(e,t,r){"use strict";var n=e("./dataReader");function i(e){if(e){this.data=e;this.length=this.data.length;this.index=0;this.zero=0;for(var t=0;t<this.data.length;t++){e[t]=e[t]&255}}}i.prototype=new n;i.prototype.byteAt=function(e){return this.data[this.zero+e]};i.prototype.lastIndexOfSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3);for(var a=this.length-4;a>=0;--a){if(this.data[a]===t&&this.data[a+1]===r&&this.data[a+2]===n&&this.data[a+3]===i){return a-this.zero}}return-1};i.prototype.readData=function(e){this.checkOffset(e);if(e===0){return[]}var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);this.index+=e;return t};t.exports=i},{"./dataReader":41}],37:[function(e,t,r){"use strict";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e,t){var r="";var i,a,s,o,f,u,l;var c=0;while(c<e.length){i=e.charCodeAt(c++);a=e.charCodeAt(c++);s=e.charCodeAt(c++);o=i>>2;f=(i&3)<<4|a>>4;u=(a&15)<<2|s>>6;l=s&63;if(isNaN(a)){u=l=64}else if(isNaN(s)){l=64}r=r+n.charAt(o)+n.charAt(f)+n.charAt(u)+n.charAt(l)}return r};r.decode=function(e,t){var r="";var i,a,s;var o,f,u,l;var c=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(c<e.length){o=n.indexOf(e.charAt(c++));f=n.indexOf(e.charAt(c++));u=n.indexOf(e.charAt(c++));l=n.indexOf(e.charAt(c++));i=o<<2|f>>4;a=(f&15)<<4|u>>2;s=(u&3)<<6|l;r=r+String.fromCharCode(i);if(u!=64){r=r+String.fromCharCode(a)}if(l!=64){r=r+String.fromCharCode(s)}}return r}},{}],38:[function(e,t,r){"use strict";function n(){this.compressedSize=0;this.uncompressedSize=0;this.crc32=0;this.compressionMethod=null;this.compressedContent=null}n.prototype={getContent:function(){return null},getCompressedContent:function(){return null}};t.exports=n},{}],39:[function(e,t,r){"use strict";r.STORE={magic:"\0\0",compress:function(e,t){return e},uncompress:function(e){return e},compressInputType:null,uncompressInputType:null};r.DEFLATE=e("./flate")},{"./flate":44}],40:[function(e,t,r){"use strict";var n=e("./utils");var i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];t.exports=function e(t,r){if(typeof t==="undefined"||!t.length){return 0}var a=n.getTypeOf(t)!=="string";if(typeof r=="undefined"){r=0}var s=0;var o=0;var f=0;r=r^-1;for(var u=0,l=t.length;u<l;u++){f=a?t[u]:t.charCodeAt(u);o=(r^f)&255;s=i[o];r=r>>>8^s}return r^-1}},{"./utils":57}],41:[function(e,t,r){"use strict";var n=e("./utils");function i(e){this.data=null;this.length=0;this.index=0;this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0){throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")}},setIndex:function(e){this.checkIndex(e);this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t=0,r;this.checkOffset(e);for(r=this.index+e-1;r>=this.index;r--){t=(t<<8)+this.byteAt(r)}this.index+=e;return t},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(e&31)<<1)}};t.exports=i},{"./utils":57}],42:[function(e,t,r){"use strict";r.base64=false;r.binary=false;r.dir=false;r.createFolders=false;r.date=null;r.compression=null;r.compressionOptions=null;r.comment=null;r.unixPermissions=null;r.dosPermissions=null},{}],43:[function(e,t,r){"use strict";var n=e("./utils");r.string2binary=function(e){return n.string2binary(e)};r.string2Uint8Array=function(e){return n.transformTo("uint8array",e)};r.uint8Array2String=function(e){return n.transformTo("string",e)};r.string2Blob=function(e){var t=n.transformTo("arraybuffer",e);return n.arrayBuffer2Blob(t)};r.arrayBuffer2Blob=function(e){return n.arrayBuffer2Blob(e)};r.transformTo=function(e,t){return n.transformTo(e,t)};r.getTypeOf=function(e){return n.getTypeOf(e)};r.checkSupport=function(e){return n.checkSupport(e)};r.MAX_VALUE_16BITS=n.MAX_VALUE_16BITS;r.MAX_VALUE_32BITS=n.MAX_VALUE_32BITS;r.pretty=function(e){return n.pretty(e)};r.findCompression=function(e){return n.findCompression(e)};r.isRegExp=function(e){return n.isRegExp(e)}},{"./utils":57}],44:[function(e,t,r){"use strict";var n=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Uint32Array!=="undefined";var i=e("pako");r.uncompressInputType=n?"uint8array":"array";r.compressInputType=n?"uint8array":"array";r.magic="\b\0";r.compress=function(e,t){return i.deflateRaw(e,{level:t.level||-1})};r.uncompress=function(e){return i.inflateRaw(e)}},{pako:60}],45:[function(e,t,r){"use strict";var n=e("./base64");function i(e,t){if(!(this instanceof i))return new i(e,t);this.files={};this.comment=null;this.root="";if(e){this.load(e,t)}this.clone=function(){var e=new i;for(var t in this){if(typeof this[t]!=="function"){e[t]=this[t]}}return e}}i.prototype=e("./object");i.prototype.load=e("./load");i.support=e("./support");i.defaults=e("./defaults");i.utils=e("./deprecatedPublicUtils");i.base64={encode:function(e){return n.encode(e)},decode:function(e){return n.decode(e)}};i.compressions=e("./compressions");t.exports=i},{"./base64":37,"./compressions":39,"./defaults":42,"./deprecatedPublicUtils":43,"./load":46,"./object":49,"./support":53}],46:[function(e,t,r){"use strict";var n=e("./base64");var i=e("./utf8");var a=e("./utils");var s=e("./zipEntries");t.exports=function(e,t){var r,o,f,u;t=a.extend(t||{},{base64:false,checkCRC32:false,optimizedBinaryString:false,createFolders:false,decodeFileName:i.utf8decode});if(t.base64){e=n.decode(e)}o=new s(e,t);r=o.files;for(f=0;f<r.length;f++){u=r[f];this.file(u.fileNameStr,u.decompressed,{binary:true,optimizedBinaryString:true,date:u.date,dir:u.dir,comment:u.fileCommentStr.length?u.fileCommentStr:null,unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions,createFolders:t.createFolders})}if(o.zipComment.length){this.comment=o.zipComment}return this}},{"./base64":37,"./utf8":56,"./utils":57,"./zipEntries":58}],47:[function(e,t,r){(function(e){"use strict";t.exports=function(t,r){return new e(t,r)};t.exports.test=function(t){return e.isBuffer(t)}}).call(this,e("buffer").Buffer)},{buffer:13}],48:[function(e,t,r){"use strict";var n=e("./uint8ArrayReader");function i(e){this.data=e;this.length=this.data.length;this.index=0;this.zero=0}i.prototype=new n;i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);this.index+=e;return t};t.exports=i},{"./uint8ArrayReader":54}],49:[function(e,t,r){"use strict";var n=e("./support");var i=e("./utils");var a=e("./crc32");var s=e("./signature");var o=e("./defaults");var f=e("./base64");var u=e("./compressions");var l=e("./compressedObject");var c=e("./nodeBuffer");var h=e("./utf8");var d=e("./stringWriter");var p=e("./uint8ArrayWriter");var v=function(e){if(e._data instanceof l){e._data=e._data.getContent();e.options.binary=true;e.options.base64=false;if(i.getTypeOf(e._data)==="uint8array"){var t=e._data;e._data=new Uint8Array(t.length);if(t.length!==0){e._data.set(t,0)}}}return e._data};var m=function(e){var t=v(e),r=i.getTypeOf(t);if(r==="string"){if(!e.options.binary){if(n.nodebuffer){return c(t,"utf-8")}}return e.asBinary()}return t};var g=function(e){var t=v(this);if(t===null||typeof t==="undefined"){return""}if(this.options.base64){t=f.decode(t)}if(e&&this.options.binary){t=N.utf8decode(t)}else{t=i.transformTo("string",t)}if(!e&&!this.options.binary){t=i.transformTo("string",N.utf8encode(t))}return t};var w=function(e,t,r){this.name=e;this.dir=r.dir;this.date=r.date;this.comment=r.comment;this.unixPermissions=r.unixPermissions;this.dosPermissions=r.dosPermissions;this._data=t;this.options=r;this._initialMetadata={dir:r.dir,date:r.date}};w.prototype={asText:function(){return g.call(this,true)},asBinary:function(){return g.call(this,false)},asNodeBuffer:function(){var e=m(this);return i.transformTo("nodebuffer",e)},asUint8Array:function(){var e=m(this);return i.transformTo("uint8array",e)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var y=function(e,t){var r="",n;for(n=0;n<t;n++){r+=String.fromCharCode(e&255);e=e>>>8}return r};var _=function(e){e=e||{};if(e.base64===true&&(e.binary===null||e.binary===undefined)){e.binary=true}e=i.extend(e,o);e.date=e.date||new Date;if(e.compression!==null)e.compression=e.compression.toUpperCase();return e};var b=function(e,t,r){var n=i.getTypeOf(t),a;r=_(r);if(typeof r.unixPermissions==="string"){r.unixPermissions=parseInt(r.unixPermissions,8)}if(r.unixPermissions&&r.unixPermissions&16384){r.dir=true}if(r.dosPermissions&&r.dosPermissions&16){r.dir=true}if(r.dir){e=E(e)}if(r.createFolders&&(a=x(e))){T.call(this,a,true)}if(r.dir||t===null||typeof t==="undefined"){r.base64=false;r.binary=false;t=null;n=null}else if(n==="string"){if(r.binary&&!r.base64){if(r.optimizedBinaryString!==true){t=i.string2binary(t)}}}else{r.base64=false;r.binary=true;if(!n&&!(t instanceof l)){throw new Error("The data of '"+e+"' is in an unsupported format !")}if(n==="arraybuffer"){t=i.transformTo("uint8array",t)}}var s=new w(e,t,r);this.files[e]=s;return s};var x=function(e){if(e.slice(-1)=="/"){e=e.substring(0,e.length-1)}var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""};var E=function(e){if(e.slice(-1)!="/"){e+="/"}return e};var T=function(e,t){t=typeof t!=="undefined"?t:false;e=E(e);if(!this.files[e]){b.call(this,e,null,{dir:true,createFolders:t})}return this.files[e]};var k=function(e,t,r){var n=new l,s;if(e._data instanceof l){n.uncompressedSize=e._data.uncompressedSize;n.crc32=e._data.crc32;if(n.uncompressedSize===0||e.dir){t=u["STORE"];n.compressedContent="";n.crc32=0}else if(e._data.compressionMethod===t.magic){n.compressedContent=e._data.getCompressedContent()}else{s=e._data.getContent();n.compressedContent=t.compress(i.transformTo(t.compressInputType,s),r)}}else{s=m(e);if(!s||s.length===0||e.dir){t=u["STORE"];s=""}n.uncompressedSize=s.length;n.crc32=a(s);n.compressedContent=t.compress(i.transformTo(t.compressInputType,s),r)}n.compressedSize=n.compressedContent.length;n.compressionMethod=t.magic;return n};var A=function(e,t){var r=e;if(!e){r=t?16893:33204}return(r&65535)<<16};var S=function(e,t){return(e||0)&63};var C=function(e,t,r,n,o,f){var u=r.compressedContent,l=f!==h.utf8encode,c=i.transformTo("string",f(t.name)),d=i.transformTo("string",h.utf8encode(t.name)),p=t.comment||"",v=i.transformTo("string",f(p)),m=i.transformTo("string",h.utf8encode(p)),g=d.length!==t.name.length,w=m.length!==p.length,_=t.options,b,x,E="",T="",k="",C,N;if(t._initialMetadata.dir!==t.dir){C=t.dir}else{C=_.dir}if(t._initialMetadata.date!==t.date){N=t.date}else{N=_.date}var I=0;var R=0;if(C){I|=16}if(o==="UNIX"){R=798;I|=A(t.unixPermissions,C)}else{R=20;I|=S(t.dosPermissions,C)}b=N.getHours();b=b<<6;b=b|N.getMinutes();b=b<<5;b=b|N.getSeconds()/2;x=N.getFullYear()-1980;x=x<<4;x=x|N.getMonth()+1;x=x<<5;x=x|N.getDate();if(g){T=y(1,1)+y(a(c),4)+d;E+="up"+y(T.length,2)+T}if(w){k=y(1,1)+y(this.crc32(v),4)+m;E+="uc"+y(k.length,2)+k}var O="";O+="\n\0";O+=!l&&(g||w)?"\0\b":"\0\0";O+=r.compressionMethod;O+=y(b,2);O+=y(x,2);O+=y(r.crc32,4);O+=y(r.compressedSize,4);O+=y(r.uncompressedSize,4);O+=y(c.length,2);O+=y(E.length,2);var D=s.LOCAL_FILE_HEADER+O+c+E;var z=s.CENTRAL_FILE_HEADER+y(R,2)+O+y(v.length,2)+"\0\0"+"\0\0"+y(I,4)+y(n,4)+c+E+v;return{fileRecord:D,dirRecord:z,compressedObject:r}};var N={load:function(e,t){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(e){var t=[],r,n,a,s;for(r in this.files){if(!this.files.hasOwnProperty(r)){continue}a=this.files[r];s=new w(a.name,a._data,i.extend(a.options));n=r.slice(this.root.length,r.length);if(r.slice(0,this.root.length)===this.root&&e(n,s)){t.push(s)}}return t},file:function(e,t,r){if(arguments.length===1){if(i.isRegExp(e)){var n=e;return this.filter(function(e,t){return!t.dir&&n.test(e)})}else{return this.filter(function(t,r){return!r.dir&&t===e})[0]||null}}else{e=this.root+e;b.call(this,e,t,r)}return this},folder:function(e){if(!e){return this}if(i.isRegExp(e)){return this.filter(function(t,r){return r.dir&&e.test(t)})}var t=this.root+e;var r=T.call(this,t);var n=this.clone();n.root=r.name;return n},remove:function(e){e=this.root+e;var t=this.files[e];if(!t){if(e.slice(-1)!="/"){e+="/"}t=this.files[e]}if(t&&!t.dir){delete this.files[e]}else{var r=this.filter(function(t,r){return r.name.slice(0,e.length)===e});for(var n=0;n<r.length;n++){delete this.files[r[n].name]}}return this},generate:function(e){e=i.extend(e||{},{base64:true,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:h.utf8encode});i.checkSupport(e.type);if(e.platform==="darwin"||e.platform==="freebsd"||e.platform==="linux"||e.platform==="sunos"){e.platform="UNIX"}if(e.platform==="win32"){e.platform="DOS"}var t=[],r=0,n=0,a,o,l=i.transformTo("string",e.encodeFileName(e.comment||this.comment||""));for(var c in this.files){if(!this.files.hasOwnProperty(c)){continue}var v=this.files[c];var m=v.options.compression||e.compression.toUpperCase();var g=u[m];if(!g){throw new Error(m+" is not a valid compression method !")}var w=v.options.compressionOptions||e.compressionOptions||{};var _=k.call(this,v,g,w);var b=C.call(this,c,v,_,r,e.platform,e.encodeFileName);r+=b.fileRecord.length+_.compressedSize;n+=b.dirRecord.length;t.push(b)}var x="";x=s.CENTRAL_DIRECTORY_END+"\0\0"+"\0\0"+y(t.length,2)+y(t.length,2)+y(n,4)+y(r,4)+y(l.length,2)+l;var E=e.type.toLowerCase();if(E==="uint8array"||E==="arraybuffer"||E==="blob"||E==="nodebuffer"){a=new p(r+n+x.length)}else{a=new d(r+n+x.length)}for(o=0;o<t.length;o++){a.append(t[o].fileRecord);a.append(t[o].compressedObject.compressedContent)}for(o=0;o<t.length;o++){a.append(t[o].dirRecord)}a.append(x);var T=a.finalize();switch(e.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return i.transformTo(e.type.toLowerCase(),T);case"blob":return i.arrayBuffer2Blob(i.transformTo("arraybuffer",T),e.mimeType);case"base64":return e.base64?f.encode(T):T;default:return T}},crc32:function(e,t){return a(e,t)},utf8encode:function(e){return i.transformTo("string",h.utf8encode(e))},utf8decode:function(e){return h.utf8decode(e)}};t.exports=N},{"./base64":37,"./compressedObject":38,"./compressions":39,"./crc32":40,"./defaults":42,"./nodeBuffer":47,"./signature":50,"./stringWriter":52,"./support":53,"./uint8ArrayWriter":55,"./utf8":56,"./utils":57}],50:[function(e,t,r){"use strict";r.LOCAL_FILE_HEADER="PK";r.CENTRAL_FILE_HEADER="PK";r.CENTRAL_DIRECTORY_END="PK";r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK";r.ZIP64_CENTRAL_DIRECTORY_END="PK";r.DATA_DESCRIPTOR="PK\b"},{}],51:[function(e,t,r){"use strict";var n=e("./dataReader");var i=e("./utils");function a(e,t){this.data=e;if(!t){this.data=i.string2binary(this.data)}this.length=this.data.length;this.index=0;this.zero=0}a.prototype=new n;a.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)};a.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero};a.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);this.index+=e;return t};t.exports=a},{"./dataReader":41,"./utils":57}],52:[function(e,t,r){"use strict";var n=e("./utils");var i=function(){this.data=[]};i.prototype={append:function(e){e=n.transformTo("string",e);this.data.push(e)},finalize:function(){return this.data.join("")}};t.exports=i},{"./utils":57}],53:[function(e,t,r){(function(e){"use strict";r.base64=true;r.array=true;r.string=true;r.arraybuffer=typeof ArrayBuffer!=="undefined"&&typeof Uint8Array!=="undefined";r.nodebuffer=typeof e!=="undefined";r.uint8array=typeof Uint8Array!=="undefined";if(typeof ArrayBuffer==="undefined"){r.blob=false}else{var t=new ArrayBuffer(0);try{r.blob=new Blob([t],{type:"application/zip"}).size===0}catch(e){try{var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;var i=new n;i.append(t);r.blob=i.getBlob("application/zip").size===0}catch(e){r.blob=false}}}}).call(this,e("buffer").Buffer)},{buffer:13}],54:[function(e,t,r){"use strict";var n=e("./arrayReader");function i(e){if(e){this.data=e;this.length=this.data.length;this.index=0;this.zero=0}}i.prototype=new n;i.prototype.readData=function(e){this.checkOffset(e);if(e===0){return new Uint8Array(0)}var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);this.index+=e;return t};t.exports=i},{"./arrayReader":36}],55:[function(e,t,r){"use strict";var n=e("./utils");var i=function(e){this.data=new Uint8Array(e);this.index=0};i.prototype={append:function(e){if(e.length!==0){e=n.transformTo("uint8array",e);this.data.set(e,this.index);this.index+=e.length}},finalize:function(){return this.data}};t.exports=i},{"./utils":57}],56:[function(e,t,r){"use strict";var n=e("./utils");var i=e("./support");var a=e("./nodeBuffer");var s=new Array(256);for(var o=0;o<256;o++){s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1}s[254]=s[254]=1;var f=function(e){var t,r,n,a,s,o=e.length,f=0;for(a=0;a<o;a++){r=e.charCodeAt(a);if((r&64512)===55296&&a+1<o){n=e.charCodeAt(a+1);if((n&64512)===56320){r=65536+(r-55296<<10)+(n-56320);a++}}f+=r<128?1:r<2048?2:r<65536?3:4}if(i.uint8array){t=new Uint8Array(f)}else{t=new Array(f)}for(s=0,a=0;s<f;a++){r=e.charCodeAt(a);if((r&64512)===55296&&a+1<o){n=e.charCodeAt(a+1);if((n&64512)===56320){r=65536+(r-55296<<10)+(n-56320);a++}}if(r<128){t[s++]=r}else if(r<2048){t[s++]=192|r>>>6;t[s++]=128|r&63}else if(r<65536){t[s++]=224|r>>>12;t[s++]=128|r>>>6&63;t[s++]=128|r&63}else{t[s++]=240|r>>>18;t[s++]=128|r>>>12&63;t[s++]=128|r>>>6&63;t[s++]=128|r&63}}return t};var u=function(e,t){var r;t=t||e.length;if(t>e.length){t=e.length}r=t-1;while(r>=0&&(e[r]&192)===128){r--}if(r<0){return t}if(r===0){return t}return r+s[e[r]]>t?r:t};var l=function(e){var t,r,i,a,o;var f=e.length;var u=new Array(f*2);for(i=0,r=0;r<f;){a=e[r++];if(a<128){u[i++]=a;continue}o=s[a];if(o>4){u[i++]=65533;r+=o-1;continue}a&=o===2?31:o===3?15:7;while(o>1&&r<f){a=a<<6|e[r++]&63;o--}if(o>1){u[i++]=65533;continue}if(a<65536){u[i++]=a}else{a-=65536;u[i++]=55296|a>>10&1023;u[i++]=56320|a&1023}}if(u.length!==i){if(u.subarray){u=u.subarray(0,i)}else{u.length=i}}return n.applyFromCharCode(u)};r.utf8encode=function e(t){if(i.nodebuffer){return a(t,"utf-8")}return f(t)};r.utf8decode=function e(t){if(i.nodebuffer){return n.transformTo("nodebuffer",t).toString("utf-8")}t=n.transformTo(i.uint8array?"uint8array":"array",t);var r=[],a=0,s=t.length,o=65536;while(a<s){var f=u(t,Math.min(a+o,s));if(i.uint8array){r.push(l(t.subarray(a,f)))}else{r.push(l(t.slice(a,f)))}a=f}return r.join("")}},{"./nodeBuffer":47,"./support":53,"./utils":57}],57:[function(e,t,r){"use strict";var n=e("./support");var i=e("./compressions");var a=e("./nodeBuffer");r.string2binary=function(e){var t="";for(var r=0;r<e.length;r++){t+=String.fromCharCode(e.charCodeAt(r)&255)}return t};r.arrayBuffer2Blob=function(e,t){r.checkSupport("blob");t=t||"application/zip";try{return new Blob([e],{type:t})}catch(r){try{var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;var i=new n;i.append(e);return i.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};function s(e){return e}function o(e,t){for(var r=0;r<e.length;++r){t[r]=e.charCodeAt(r)&255}return t}function f(e){var t=65536;var n=[],i=e.length,s=r.getTypeOf(e),o=0,f=true;try{switch(s){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,a(0));break}}catch(e){f=false}if(!f){var u="";for(var l=0;l<e.length;l++){u+=String.fromCharCode(e[l])}return u}while(o<i&&t>1){try{if(s==="array"||s==="nodebuffer"){n.push(String.fromCharCode.apply(null,e.slice(o,Math.min(o+t,i))))}else{n.push(String.fromCharCode.apply(null,e.subarray(o,Math.min(o+t,i))))}o+=t}catch(e){t=Math.floor(t/2)}}return n.join("")}r.applyFromCharCode=f;function u(e,t){for(var r=0;r<e.length;r++){t[r]=e[r]}return t}var l={};l["string"]={string:s,array:function(e){return o(e,new Array(e.length))},arraybuffer:function(e){return l["string"]["uint8array"](e).buffer},uint8array:function(e){return o(e,new Uint8Array(e.length))},nodebuffer:function(e){return o(e,a(e.length))}};l["array"]={string:f,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a(e)}};l["arraybuffer"]={string:function(e){return f(new Uint8Array(e))},array:function(e){return u(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a(new Uint8Array(e))}};l["uint8array"]={string:f,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return a(e)}};l["nodebuffer"]={string:f,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return l["nodebuffer"]["uint8array"](e).buffer},uint8array:function(e){return u(e,new Uint8Array(e.length))},nodebuffer:s};r.transformTo=function(e,t){if(!t){t=""}if(!e){return t}r.checkSupport(e);var n=r.getTypeOf(t);var i=l[n][e](t);return i};r.getTypeOf=function(e){if(typeof e==="string"){return"string"}if(Object.prototype.toString.call(e)==="[object Array]"){return"array"}if(n.nodebuffer&&a.test(e)){return"nodebuffer"}if(n.uint8array&&e instanceof Uint8Array){return"uint8array"}if(n.arraybuffer&&e instanceof ArrayBuffer){return"arraybuffer"}};r.checkSupport=function(e){var t=n[e.toLowerCase()];if(!t){throw new Error(e+" is not supported by this browser")}};r.MAX_VALUE_16BITS=65535;r.MAX_VALUE_32BITS=-1;r.pretty=function(e){var t="",r,n;for(n=0;n<(e||"").length;n++){r=e.charCodeAt(n);t+="\\x"+(r<16?"0":"")+r.toString(16).toUpperCase()}return t};r.findCompression=function(e){for(var t in i){if(!i.hasOwnProperty(t)){continue}if(i[t].magic===e){return i[t]}}return null};r.isRegExp=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"};r.extend=function(){var e={},t,r;for(t=0;t<arguments.length;t++){for(r in arguments[t]){if(arguments[t].hasOwnProperty(r)&&typeof e[r]==="undefined"){e[r]=arguments[t][r]}}}return e}},{"./compressions":39,"./nodeBuffer":47,"./support":53}],58:[function(e,t,r){"use strict";var n=e("./stringReader");var i=e("./nodeBufferReader");var a=e("./uint8ArrayReader");var s=e("./arrayReader");var o=e("./utils");var f=e("./signature");var u=e("./zipEntry");var l=e("./support");var c=e("./object");function h(e,t){this.files=[];this.loadOptions=t;if(e){this.load(e)}}h.prototype={checkSignature:function(e){var t=this.reader.readString(4);if(t!==e){throw new Error("Corrupted zip or bug : unexpected signature "+"("+o.pretty(t)+", expected "+o.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4);var i=n===t;this.reader.setIndex(r);return i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength);var t=l.uint8array?"uint8array":"array";var r=o.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.versionMadeBy=this.reader.readString(2);this.versionNeeded=this.reader.readInt(2);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData={};var e=this.zip64EndOfCentralSize-44,t=0,r,n,i;while(t<e){r=this.reader.readInt(2);n=this.reader.readInt(4);i=this.reader.readString(n);this.zip64ExtensibleData[r]={id:r,length:n,value:i}}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);this.disksCount=this.reader.readInt(4);if(this.disksCount>1){throw new Error("Multi-volumes zip are not supported")}},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++){t=this.files[e];this.reader.setIndex(t.localHeaderOffset);this.checkSignature(f.LOCAL_FILE_HEADER);t.readLocalPart(this.reader);t.handleUTF8();t.processAttributes()}},readCentralDir:function(){var e;this.reader.setIndex(this.centralDirOffset);while(this.reader.readString(4)===f.CENTRAL_FILE_HEADER){e=new u({zip64:this.zip64},this.loadOptions);e.readCentralPart(this.reader);this.files.push(e)}if(this.centralDirRecords!==this.files.length){if(this.centralDirRecords!==0&&this.files.length===0){throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)}else{}}},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(f.CENTRAL_DIRECTORY_END);if(e<0){var t=!this.isSignature(0,f.LOCAL_FILE_HEADER);if(t){throw new Error("Can't find end of central directory : is this a zip file ? "+"If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html")}else{throw new Error("Corrupted zip : can't find end of central directory")}}this.reader.setIndex(e);var r=e;this.checkSignature(f.CENTRAL_DIRECTORY_END);this.readBlockEndOfCentral();if(this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){this.zip64=true;e=this.reader.lastIndexOfSignature(f.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(e<0){throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator")}this.reader.setIndex(e);this.checkSignature(f.ZIP64_CENTRAL_DIRECTORY_LOCATOR);this.readBlockZip64EndOfCentralLocator();if(!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,f.ZIP64_CENTRAL_DIRECTORY_END)){this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(f.ZIP64_CENTRAL_DIRECTORY_END);if(this.relativeOffsetEndOfZip64CentralDir<0){throw new Error("Corrupted zip : can't find the ZIP64 end of central directory")}}this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);this.checkSignature(f.ZIP64_CENTRAL_DIRECTORY_END);this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;if(this.zip64){n+=20;n+=12+this.zip64EndOfCentralSize}var i=r-n;if(i>0){if(this.isSignature(r,f.CENTRAL_FILE_HEADER)){}else{this.reader.zero=i}}else if(i<0){throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")}},prepareReader:function(e){var t=o.getTypeOf(e);o.checkSupport(t);if(t==="string"&&!l.uint8array){this.reader=new n(e,this.loadOptions.optimizedBinaryString)}else if(t==="nodebuffer"){this.reader=new i(e)}else if(l.uint8array){this.reader=new a(o.transformTo("uint8array",e))}else if(l.array){this.reader=new s(o.transformTo("array",e))}else{throw new Error("Unexpected error: unsupported type '"+t+"'")}},load:function(e){this.prepareReader(e);this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};t.exports=h},{"./arrayReader":36,"./nodeBufferReader":48,"./object":49,"./signature":50,"./stringReader":51,"./support":53,"./uint8ArrayReader":54,"./utils":57,"./zipEntry":59}],59:[function(e,t,r){"use strict";var n=e("./stringReader");var i=e("./utils");var a=e("./compressedObject");var s=e("./object");var o=e("./support");var f=0;var u=3;function l(e,t){this.options=e;this.loadOptions=t}l.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},prepareCompressedContent:function(e,t,r){return function(){var n=e.index;e.setIndex(t);var i=e.readData(r);e.setIndex(n);return i}},prepareContent:function(e,t,r,n,a){return function(){var e=i.transformTo(n.uncompressInputType,this.getCompressedContent());var t=n.uncompress(e);if(t.length!==a){throw new Error("Bug : uncompressed data size mismatch")}return t}},readLocalPart:function(e){var t,r;e.skip(22);this.fileNameLength=e.readInt(2);r=e.readInt(2);this.fileName=e.readData(this.fileNameLength);e.skip(r);if(this.compressedSize==-1||this.uncompressedSize==-1){throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory "+"(compressedSize == -1 || uncompressedSize == -1)")}t=i.findCompression(this.compressionMethod);if(t===null){throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")")}this.decompressed=new a;this.decompressed.compressedSize=this.compressedSize;this.decompressed.uncompressedSize=this.uncompressedSize;this.decompressed.crc32=this.crc32;this.decompressed.compressionMethod=this.compressionMethod;this.decompressed.getCompressedContent=this.prepareCompressedContent(e,e.index,this.compressedSize,t);this.decompressed.getContent=this.prepareContent(e,e.index,this.compressedSize,t,this.uncompressedSize);if(this.loadOptions.checkCRC32){this.decompressed=i.transformTo("string",this.decompressed.getContent());if(s.crc32(this.decompressed)!==this.crc32){throw new Error("Corrupted zip : CRC32 mismatch")}}},readCentralPart:function(e){this.versionMadeBy=e.readInt(2);this.versionNeeded=e.readInt(2);this.bitFlag=e.readInt(2);this.compressionMethod=e.readString(2);this.date=e.readDate();this.crc32=e.readInt(4);this.compressedSize=e.readInt(4);this.uncompressedSize=e.readInt(4);this.fileNameLength=e.readInt(2);this.extraFieldsLength=e.readInt(2);this.fileCommentLength=e.readInt(2);this.diskNumberStart=e.readInt(2);this.internalFileAttributes=e.readInt(2);this.externalFileAttributes=e.readInt(4);this.localHeaderOffset=e.readInt(4);if(this.isEncrypted()){throw new Error("Encrypted zip are not supported")}this.fileName=e.readData(this.fileNameLength);this.readExtraFields(e);this.parseZIP64ExtraField(e);this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null;this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=this.externalFileAttributes&16?true:false;if(e===f){this.dosPermissions=this.externalFileAttributes&63}if(e===u){this.unixPermissions=this.externalFileAttributes>>16&65535}if(!this.dir&&this.fileNameStr.slice(-1)==="/"){this.dir=true}},parseZIP64ExtraField:function(e){if(!this.extraFields[1]){return}var t=new n(this.extraFields[1].value);if(this.uncompressedSize===i.MAX_VALUE_32BITS){this.uncompressedSize=t.readInt(8)}if(this.compressedSize===i.MAX_VALUE_32BITS){this.compressedSize=t.readInt(8)}if(this.localHeaderOffset===i.MAX_VALUE_32BITS){this.localHeaderOffset=t.readInt(8)}if(this.diskNumberStart===i.MAX_VALUE_32BITS){this.diskNumberStart=t.readInt(4)}},readExtraFields:function(e){var t=e.index,r,n,i;this.extraFields=this.extraFields||{};while(e.index<t+this.extraFieldsLength){r=e.readInt(2);n=e.readInt(2);i=e.readString(n);this.extraFields[r]={id:r,length:n,value:i}}},handleUTF8:function(){var e=o.uint8array?"uint8array":"array";if(this.useUTF8()){this.fileNameStr=s.utf8decode(this.fileName);this.fileCommentStr=s.utf8decode(this.fileComment)}else{var t=this.findExtraFieldUnicodePath();if(t!==null){this.fileNameStr=t}else{var r=i.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(n!==null){this.fileCommentStr=n}else{var a=i.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=new n(e.value);if(t.readInt(1)!==1){return null}if(s.crc32(this.fileName)!==t.readInt(4)){return null}return s.utf8decode(t.readString(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=new n(e.value);if(t.readInt(1)!==1){return null}if(s.crc32(this.fileComment)!==t.readInt(4)){return null}return s.utf8decode(t.readString(e.length-5))}return null}};t.exports=l},{"./compressedObject":38,"./object":49,"./stringReader":51,"./support":53,"./utils":57}],60:[function(e,t,r){"use strict";var n=e("./lib/utils/common").assign;var i=e("./lib/deflate");var a=e("./lib/inflate");var s=e("./lib/zlib/constants");var o={};n(o,i,a,s);t.exports=o},{"./lib/deflate":61,"./lib/inflate":62,"./lib/utils/common":63,"./lib/zlib/constants":66}],61:[function(e,t,r){"use strict";var n=e("./zlib/deflate");var i=e("./utils/common");var a=e("./utils/strings");var s=e("./zlib/messages");var o=e("./zlib/zstream");var f=Object.prototype.toString;var u=0;var l=4;var c=0;var h=1;var d=2;var p=-1;var v=0;var m=8;function g(e){if(!(this instanceof g))return new g(e);this.options=i.assign({level:p,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:v,to:""},e||{});var t=this.options;if(t.raw&&t.windowBits>0){t.windowBits=-t.windowBits}else if(t.gzip&&t.windowBits>0&&t.windowBits<16){t.windowBits+=16}this.err=0;this.msg="";this.ended=false;this.chunks=[];this.strm=new o;this.strm.avail_out=0;var r=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==c){throw new Error(s[r])}if(t.header){n.deflateSetHeader(this.strm,t.header)}if(t.dictionary){var u;if(typeof t.dictionary==="string"){u=a.string2buf(t.dictionary)}else if(f.call(t.dictionary)==="[object ArrayBuffer]"){u=new Uint8Array(t.dictionary)}else{u=t.dictionary}r=n.deflateSetDictionary(this.strm,u);if(r!==c){throw new Error(s[r])}this._dict_set=true}}g.prototype.push=function(e,t){var r=this.strm;var s=this.options.chunkSize;var o,p;if(this.ended){return false}p=t===~~t?t:t===true?l:u;if(typeof e==="string"){r.input=a.string2buf(e)}else if(f.call(e)==="[object ArrayBuffer]"){r.input=new Uint8Array(e)}else{r.input=e}r.next_in=0;r.avail_in=r.input.length;do{if(r.avail_out===0){r.output=new i.Buf8(s);r.next_out=0;r.avail_out=s}o=n.deflate(r,p);if(o!==h&&o!==c){this.onEnd(o);this.ended=true;return false}if(r.avail_out===0||r.avail_in===0&&(p===l||p===d)){if(this.options.to==="string"){this.onData(a.buf2binstring(i.shrinkBuf(r.output,r.next_out)))}else{this.onData(i.shrinkBuf(r.output,r.next_out))}}}while((r.avail_in>0||r.avail_out===0)&&o!==h);if(p===l){o=n.deflateEnd(this.strm);this.onEnd(o);this.ended=true;return o===c}if(p===d){this.onEnd(c);r.avail_out=0;return true}return true};g.prototype.onData=function(e){this.chunks.push(e)};g.prototype.onEnd=function(e){if(e===c){if(this.options.to==="string"){this.result=this.chunks.join("")}else{this.result=i.flattenChunks(this.chunks)}}this.chunks=[];this.err=e;this.msg=this.strm.msg};function w(e,t){var r=new g(t);r.push(e,true);if(r.err){throw r.msg||s[r.err]}return r.result}function y(e,t){t=t||{};t.raw=true;return w(e,t)}function _(e,t){t=t||{};t.gzip=true;return w(e,t)}r.Deflate=g;r.deflate=w;r.deflateRaw=y;r.gzip=_},{"./utils/common":63,"./utils/strings":64,"./zlib/deflate":68,"./zlib/messages":73,"./zlib/zstream":75}],62:[function(e,t,r){"use strict";var n=e("./zlib/inflate");var i=e("./utils/common");var a=e("./utils/strings");var s=e("./zlib/constants");var o=e("./zlib/messages");var f=e("./zlib/zstream");var u=e("./zlib/gzheader");var l=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;if(t.raw&&t.windowBits>=0&&t.windowBits<16){t.windowBits=-t.windowBits;if(t.windowBits===0){t.windowBits=-15}}if(t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)){t.windowBits+=32}if(t.windowBits>15&&t.windowBits<48){if((t.windowBits&15)===0){t.windowBits|=15}}this.err=0;this.msg="";this.ended=false;this.chunks=[];this.strm=new f;this.strm.avail_out=0;var r=n.inflateInit2(this.strm,t.windowBits);if(r!==s.Z_OK){throw new Error(o[r])}this.header=new u;n.inflateGetHeader(this.strm,this.header)}c.prototype.push=function(e,t){var r=this.strm;var o=this.options.chunkSize;var f=this.options.dictionary;var u,c;var h,d,p;var v;var m=false;if(this.ended){return false}c=t===~~t?t:t===true?s.Z_FINISH:s.Z_NO_FLUSH;if(typeof e==="string"){r.input=a.binstring2buf(e)}else if(l.call(e)==="[object ArrayBuffer]"){r.input=new Uint8Array(e)}else{r.input=e}r.next_in=0;r.avail_in=r.input.length;do{if(r.avail_out===0){r.output=new i.Buf8(o);r.next_out=0;r.avail_out=o}u=n.inflate(r,s.Z_NO_FLUSH);if(u===s.Z_NEED_DICT&&f){if(typeof f==="string"){v=a.string2buf(f)}else if(l.call(f)==="[object ArrayBuffer]"){v=new Uint8Array(f)}else{v=f}u=n.inflateSetDictionary(this.strm,v)}if(u===s.Z_BUF_ERROR&&m===true){u=s.Z_OK;m=false}if(u!==s.Z_STREAM_END&&u!==s.Z_OK){this.onEnd(u);this.ended=true;return false}if(r.next_out){if(r.avail_out===0||u===s.Z_STREAM_END||r.avail_in===0&&(c===s.Z_FINISH||c===s.Z_SYNC_FLUSH)){if(this.options.to==="string"){h=a.utf8border(r.output,r.next_out);d=r.next_out-h;p=a.buf2string(r.output,h);r.next_out=d;r.avail_out=o-d;if(d){i.arraySet(r.output,r.output,h,d,0)}this.onData(p)}else{this.onData(i.shrinkBuf(r.output,r.next_out))}}}if(r.avail_in===0&&r.avail_out===0){m=true}}while((r.avail_in>0||r.avail_out===0)&&u!==s.Z_STREAM_END);if(u===s.Z_STREAM_END){c=s.Z_FINISH}if(c===s.Z_FINISH){u=n.inflateEnd(this.strm);this.onEnd(u);this.ended=true;return u===s.Z_OK}if(c===s.Z_SYNC_FLUSH){this.onEnd(s.Z_OK);r.avail_out=0;return true}return true};c.prototype.onData=function(e){this.chunks.push(e)};c.prototype.onEnd=function(e){if(e===s.Z_OK){if(this.options.to==="string"){this.result=this.chunks.join("")}else{this.result=i.flattenChunks(this.chunks)}}this.chunks=[];this.err=e;this.msg=this.strm.msg};function h(e,t){var r=new c(t);r.push(e,true);if(r.err){throw r.msg||o[r.err]}return r.result}function d(e,t){t=t||{};t.raw=true;return h(e,t)}r.Inflate=c;r.inflate=h;r.inflateRaw=d;r.ungzip=h},{"./utils/common":63,"./utils/strings":64,"./zlib/constants":66,"./zlib/gzheader":69,"./zlib/inflate":71,"./zlib/messages":73,"./zlib/zstream":75}],63:[function(e,t,r){"use strict";var n=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Int32Array!=="undefined";r.assign=function(e){var t=Array.prototype.slice.call(arguments,1);while(t.length){var r=t.shift();if(!r){continue}if(typeof r!=="object"){throw new TypeError(r+"must be non-object")}for(var n in r){if(r.hasOwnProperty(n)){e[n]=r[n]}}}return e};r.shrinkBuf=function(e,t){if(e.length===t){return e}if(e.subarray){return e.subarray(0,t)}e.length=t;return e};var i={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray){e.set(t.subarray(r,r+n),i);return}for(var a=0;a<n;a++){e[i+a]=t[r+a]}},flattenChunks:function(e){var t,r,n,i,a,s;n=0;for(t=0,r=e.length;t<r;t++){n+=e[t].length}s=new Uint8Array(n);i=0;for(t=0,r=e.length;t<r;t++){a=e[t];s.set(a,i);i+=a.length}return s}};var a={arraySet:function(e,t,r,n,i){for(var a=0;a<n;a++){e[i+a]=t[r+a]}},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){if(e){r.Buf8=Uint8Array;r.Buf16=Uint16Array;r.Buf32=Int32Array;r.assign(r,i)}else{r.Buf8=Array;r.Buf16=Array;r.Buf32=Array;r.assign(r,a)}};r.setTyped(n)},{}],64:[function(e,t,r){"use strict";var n=e("./common");var i=true;var a=true;try{String.fromCharCode.apply(null,[0])}catch(e){i=false}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=false}var s=new n.Buf8(256);for(var o=0;o<256;o++){s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1}s[254]=s[254]=1;r.string2buf=function(e){var t,r,i,a,s,o=e.length,f=0;for(a=0;a<o;a++){r=e.charCodeAt(a);if((r&64512)===55296&&a+1<o){i=e.charCodeAt(a+1);if((i&64512)===56320){r=65536+(r-55296<<10)+(i-56320);a++}}f+=r<128?1:r<2048?2:r<65536?3:4}t=new n.Buf8(f);for(s=0,a=0;s<f;a++){r=e.charCodeAt(a);if((r&64512)===55296&&a+1<o){i=e.charCodeAt(a+1);if((i&64512)===56320){r=65536+(r-55296<<10)+(i-56320);a++}}if(r<128){t[s++]=r}else if(r<2048){t[s++]=192|r>>>6;t[s++]=128|r&63}else if(r<65536){t[s++]=224|r>>>12;t[s++]=128|r>>>6&63;t[s++]=128|r&63}else{t[s++]=240|r>>>18;t[s++]=128|r>>>12&63;t[s++]=128|r>>>6&63;t[s++]=128|r&63}}return t};function f(e,t){if(t<65537){if(e.subarray&&a||!e.subarray&&i){return String.fromCharCode.apply(null,n.shrinkBuf(e,t))}}var r="";for(var s=0;s<t;s++){r+=String.fromCharCode(e[s])}return r}r.buf2binstring=function(e){return f(e,e.length)};r.binstring2buf=function(e){var t=new n.Buf8(e.length);for(var r=0,i=t.length;r<i;r++){t[r]=e.charCodeAt(r)}return t};r.buf2string=function(e,t){var r,n,i,a;var o=t||e.length;var u=new Array(o*2);for(n=0,r=0;r<o;){i=e[r++];if(i<128){u[n++]=i;continue}a=s[i];if(a>4){u[n++]=65533;r+=a-1;continue}i&=a===2?31:a===3?15:7;while(a>1&&r<o){i=i<<6|e[r++]&63;a--}if(a>1){u[n++]=65533;continue}if(i<65536){u[n++]=i}else{i-=65536;u[n++]=55296|i>>10&1023;u[n++]=56320|i&1023}}return f(u,n)};r.utf8border=function(e,t){var r;t=t||e.length;if(t>e.length){t=e.length}r=t-1;while(r>=0&&(e[r]&192)===128){r--}if(r<0){return t}if(r===0){return t}return r+s[e[r]]>t?r:t}},{"./common":63}],65:[function(e,t,r){"use strict";function n(e,t,r,n){var i=e&65535|0,a=e>>>16&65535|0,s=0;while(r!==0){s=r>2e3?2e3:r;r-=s;do{i=i+t[n++]|0;a=a+i|0}while(--s);i%=65521;a%=65521}return i|a<<16|0}t.exports=n},{}],66:[function(e,t,r){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],67:[function(e,t,r){"use strict";function n(){var e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++){e=e&1?3988292384^e>>>1:e>>>1}t[r]=e}return t}var i=n();function a(e,t,r,n){var a=i,s=n+r;e^=-1;for(var o=n;o<s;o++){e=e>>>8^a[(e^t[o])&255]}return e^-1}t.exports=a},{}],68:[function(e,t,r){"use strict";var n=e("../utils/common");var i=e("./trees");var a=e("./adler32");var s=e("./crc32");var o=e("./messages");var f=0;var u=1;var l=3;var c=4;var h=5;var d=0;var p=1;var v=-2;var m=-3;var g=-5;var w=-1;var y=1;var _=2;var b=3;var x=4;var E=0;var T=2;var k=8;var A=9;var S=15;var C=8;var N=29;var I=256;var R=I+1+N;var O=30;var D=19;var z=2*R+1;var B=15;var L=3;var P=258;var M=P+L+1;var U=32;var F=42;var j=69;var Z=73;var X=91;var Y=103;var V=113;var H=666;var $=1;var G=2;var W=3;var q=4;var K=3;function J(e,t){e.msg=o[t];return t}function Q(e){return(e<<1)-(e>4?9:0)}function ee(e){var t=e.length;while(--t>=0){e[t]=0}}function te(e){var t=e.state;var r=t.pending;if(r>e.avail_out){r=e.avail_out}if(r===0){return}n.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out);e.next_out+=r;t.pending_out+=r;e.total_out+=r;e.avail_out-=r;t.pending-=r;if(t.pending===0){t.pending_out=0}}function re(e,t){i._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t);e.block_start=e.strstart;te(e.strm)}function ne(e,t){e.pending_buf[e.pending++]=t}function ie(e,t){e.pending_buf[e.pending++]=t>>>8&255;e.pending_buf[e.pending++]=t&255}function ae(e,t,r,i){var o=e.avail_in;if(o>i){o=i}if(o===0){return 0}e.avail_in-=o;n.arraySet(t,e.input,e.next_in,o,r);if(e.state.wrap===1){e.adler=a(e.adler,t,o,r)}else if(e.state.wrap===2){e.adler=s(e.adler,t,o,r)}e.next_in+=o;e.total_in+=o;return o}function se(e,t){var r=e.max_chain_length;var n=e.strstart;var i;var a;var s=e.prev_length;var o=e.nice_match;var f=e.strstart>e.w_size-M?e.strstart-(e.w_size-M):0;var u=e.window;var l=e.w_mask;var c=e.prev;var h=e.strstart+P;var d=u[n+s-1];var p=u[n+s];if(e.prev_length>=e.good_match){r>>=2}if(o>e.lookahead){o=e.lookahead}do{i=t;if(u[i+s]!==p||u[i+s-1]!==d||u[i]!==u[n]||u[++i]!==u[n+1]){continue}n+=2;i++;do{}while(u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&n<h);a=P-(h-n);n=h-P;if(a>s){e.match_start=t;s=a;if(a>=o){break}d=u[n+s-1];p=u[n+s]}}while((t=c[t&l])>f&&--r!==0);if(s<=e.lookahead){return s}return e.lookahead}function oe(e){var t=e.w_size;var r,i,a,s,o;do{s=e.window_size-e.lookahead-e.strstart;if(e.strstart>=t+(t-M)){n.arraySet(e.window,e.window,t,t,0);e.match_start-=t;e.strstart-=t;e.block_start-=t;i=e.hash_size;r=i;do{a=e.head[--r];e.head[r]=a>=t?a-t:0}while(--i);i=t;r=i;do{a=e.prev[--r];e.prev[r]=a>=t?a-t:0}while(--i);s+=t}if(e.strm.avail_in===0){break}i=ae(e.strm,e.window,e.strstart+e.lookahead,s);e.lookahead+=i;if(e.lookahead+e.insert>=L){o=e.strstart-e.insert;e.ins_h=e.window[o];e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;while(e.insert){e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+L-1])&e.hash_mask;e.prev[o&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=o;o++;e.insert--;if(e.lookahead+e.insert<L){break}}}}while(e.lookahead<M&&e.strm.avail_in!==0)}function fe(e,t){var r=65535;if(r>e.pending_buf_size-5){r=e.pending_buf_size-5}for(;;){if(e.lookahead<=1){oe(e);if(e.lookahead===0&&t===f){return $}if(e.lookahead===0){break}}e.strstart+=e.lookahead;e.lookahead=0;var n=e.block_start+r;if(e.strstart===0||e.strstart>=n){e.lookahead=e.strstart-n;e.strstart=n;re(e,false);if(e.strm.avail_out===0){return $}}if(e.strstart-e.block_start>=e.w_size-M){re(e,false);if(e.strm.avail_out===0){return $}}}e.insert=0;if(t===c){re(e,true);if(e.strm.avail_out===0){return W}return q}if(e.strstart>e.block_start){re(e,false);if(e.strm.avail_out===0){return $}}return $}function ue(e,t){var r;var n;for(;;){if(e.lookahead<M){oe(e);if(e.lookahead<M&&t===f){return $}if(e.lookahead===0){break}}r=0;if(e.lookahead>=L){e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+L-1])&e.hash_mask;r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=e.strstart}if(r!==0&&e.strstart-r<=e.w_size-M){e.match_length=se(e,r)}if(e.match_length>=L){n=i._tr_tally(e,e.strstart-e.match_start,e.match_length-L);e.lookahead-=e.match_length;if(e.match_length<=e.max_lazy_match&&e.lookahead>=L){e.match_length--;do{e.strstart++;e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+L-1])&e.hash_mask;r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=e.strstart}while(--e.match_length!==0);e.strstart++}else{e.strstart+=e.match_length;e.match_length=0;e.ins_h=e.window[e.strstart];e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask}}else{n=i._tr_tally(e,0,e.window[e.strstart]);e.lookahead--;e.strstart++}if(n){re(e,false);if(e.strm.avail_out===0){return $}}}e.insert=e.strstart<L-1?e.strstart:L-1;if(t===c){re(e,true);if(e.strm.avail_out===0){return W}return q}if(e.last_lit){re(e,false);if(e.strm.avail_out===0){return $}}return G}function le(e,t){var r;var n;var a;for(;;){if(e.lookahead<M){oe(e);if(e.lookahead<M&&t===f){return $}if(e.lookahead===0){break}}r=0;if(e.lookahead>=L){e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+L-1])&e.hash_mask;r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=e.strstart}e.prev_length=e.match_length;e.prev_match=e.match_start;e.match_length=L-1;if(r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-M){e.match_length=se(e,r);if(e.match_length<=5&&(e.strategy===y||e.match_length===L&&e.strstart-e.match_start>4096)){e.match_length=L-1}}if(e.prev_length>=L&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-L;n=i._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-L);e.lookahead-=e.prev_length-1;e.prev_length-=2;do{if(++e.strstart<=a){e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+L-1])&e.hash_mask;r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=e.strstart}}while(--e.prev_length!==0);e.match_available=0;e.match_length=L-1;e.strstart++;if(n){re(e,false);if(e.strm.avail_out===0){return $}}}else if(e.match_available){n=i._tr_tally(e,0,e.window[e.strstart-1]);if(n){re(e,false)}e.strstart++;e.lookahead--;if(e.strm.avail_out===0){return $}}else{e.match_available=1;e.strstart++;e.lookahead--}}if(e.match_available){n=i._tr_tally(e,0,e.window[e.strstart-1]);e.match_available=0}e.insert=e.strstart<L-1?e.strstart:L-1;if(t===c){re(e,true);if(e.strm.avail_out===0){return W}return q}if(e.last_lit){re(e,false);if(e.strm.avail_out===0){return $}}return G}function ce(e,t){var r;var n;var a,s;var o=e.window;for(;;){if(e.lookahead<=P){oe(e);if(e.lookahead<=P&&t===f){return $}if(e.lookahead===0){break}}e.match_length=0;if(e.lookahead>=L&&e.strstart>0){a=e.strstart-1;n=o[a];if(n===o[++a]&&n===o[++a]&&n===o[++a]){s=e.strstart+P;do{}while(n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&a<s);e.match_length=P-(s-a);if(e.match_length>e.lookahead){e.match_length=e.lookahead}}}if(e.match_length>=L){r=i._tr_tally(e,1,e.match_length-L);e.lookahead-=e.match_length;e.strstart+=e.match_length;e.match_length=0}else{r=i._tr_tally(e,0,e.window[e.strstart]);e.lookahead--;e.strstart++}if(r){re(e,false);if(e.strm.avail_out===0){return $}}}e.insert=0;if(t===c){re(e,true);if(e.strm.avail_out===0){return W}return q}if(e.last_lit){re(e,false);if(e.strm.avail_out===0){return $}}return G}function he(e,t){var r;for(;;){if(e.lookahead===0){oe(e);if(e.lookahead===0){if(t===f){return $}break}}e.match_length=0;r=i._tr_tally(e,0,e.window[e.strstart]);e.lookahead--;e.strstart++;if(r){re(e,false);if(e.strm.avail_out===0){return $}}}e.insert=0;if(t===c){re(e,true);if(e.strm.avail_out===0){return W}return q}if(e.last_lit){re(e,false);if(e.strm.avail_out===0){return $}}return G}function de(e,t,r,n,i){this.good_length=e;this.max_lazy=t;this.nice_length=r;this.max_chain=n;this.func=i}var pe;pe=[new de(0,0,0,0,fe),new de(4,4,8,4,ue),new de(4,5,16,8,ue),new de(4,6,32,32,ue),new de(4,4,16,16,le),new de(8,16,32,32,le),new de(8,16,128,128,le),new de(8,32,128,256,le),new de(32,128,258,1024,le),new de(32,258,258,4096,le)];function ve(e){e.window_size=2*e.w_size;ee(e.head);e.max_lazy_match=pe[e.level].max_lazy;e.good_match=pe[e.level].good_length;e.nice_match=pe[e.level].nice_length;e.max_chain_length=pe[e.level].max_chain;e.strstart=0;e.block_start=0;e.lookahead=0;e.insert=0;e.match_length=e.prev_length=L-1;e.match_available=0;e.ins_h=0}function me(){this.strm=null;this.status=0;this.pending_buf=null;this.pending_buf_size=0;this.pending_out=0;this.pending=0;this.wrap=0;this.gzhead=null;this.gzindex=0;this.method=k;this.last_flush=-1;this.w_size=0;this.w_bits=0;this.w_mask=0;this.window=null;this.window_size=0;this.prev=null;this.head=null;this.ins_h=0;this.hash_size=0;this.hash_bits=0;this.hash_mask=0;this.hash_shift=0;this.block_start=0;this.match_length=0;this.prev_match=0;this.match_available=0;this.strstart=0;this.match_start=0;this.lookahead=0;this.prev_length=0;this.max_chain_length=0;this.max_lazy_match=0;this.level=0;this.strategy=0;this.good_match=0;this.nice_match=0;this.dyn_ltree=new n.Buf16(z*2);this.dyn_dtree=new n.Buf16((2*O+1)*2);this.bl_tree=new n.Buf16((2*D+1)*2);ee(this.dyn_ltree);ee(this.dyn_dtree);ee(this.bl_tree);this.l_desc=null;this.d_desc=null;this.bl_desc=null;this.bl_count=new n.Buf16(B+1);this.heap=new n.Buf16(2*R+1);ee(this.heap);this.heap_len=0;this.heap_max=0;this.depth=new n.Buf16(2*R+1);ee(this.depth);this.l_buf=0;this.lit_bufsize=0;this.last_lit=0;this.d_buf=0;this.opt_len=0;this.static_len=0;this.matches=0;this.insert=0;this.bi_buf=0;this.bi_valid=0}function ge(e){var t;if(!e||!e.state){return J(e,v)}e.total_in=e.total_out=0;e.data_type=T;t=e.state;t.pending=0;t.pending_out=0;if(t.wrap<0){t.wrap=-t.wrap}t.status=t.wrap?F:V;e.adler=t.wrap===2?0:1;t.last_flush=f;i._tr_init(t);return d}function we(e){var t=ge(e);if(t===d){ve(e.state)}return t}function ye(e,t){if(!e||!e.state){return v}if(e.state.wrap!==2){return v}e.state.gzhead=t;return d}function _e(e,t,r,i,a,s){if(!e){return v}var o=1;if(t===w){t=6}if(i<0){o=0;i=-i}else if(i>15){o=2;i-=16}if(a<1||a>A||r!==k||i<8||i>15||t<0||t>9||s<0||s>x){return J(e,v)}if(i===8){i=9}var f=new me;e.state=f;f.strm=e;f.wrap=o;f.gzhead=null;f.w_bits=i;f.w_size=1<<f.w_bits;f.w_mask=f.w_size-1;f.hash_bits=a+7;f.hash_size=1<<f.hash_bits;f.hash_mask=f.hash_size-1;f.hash_shift=~~((f.hash_bits+L-1)/L);f.window=new n.Buf8(f.w_size*2);f.head=new n.Buf16(f.hash_size);f.prev=new n.Buf16(f.w_size);f.lit_bufsize=1<<a+6;f.pending_buf_size=f.lit_bufsize*4;f.pending_buf=new n.Buf8(f.pending_buf_size);f.d_buf=1*f.lit_bufsize;f.l_buf=(1+2)*f.lit_bufsize;f.level=t;f.strategy=s;f.method=r;return we(e)}function be(e,t){return _e(e,t,k,S,C,E)}function xe(e,t){var r,n;var a,o;if(!e||!e.state||t>h||t<0){return e?J(e,v):v}n=e.state;if(!e.output||!e.input&&e.avail_in!==0||n.status===H&&t!==c){return J(e,e.avail_out===0?g:v)}n.strm=e;r=n.last_flush;n.last_flush=t;if(n.status===F){if(n.wrap===2){e.adler=0;ne(n,31);ne(n,139);ne(n,8);if(!n.gzhead){ne(n,0);ne(n,0);ne(n,0);ne(n,0);ne(n,0);ne(n,n.level===9?2:n.strategy>=_||n.level<2?4:0);ne(n,K);n.status=V}else{ne(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(!n.gzhead.extra?0:4)+(!n.gzhead.name?0:8)+(!n.gzhead.comment?0:16));ne(n,n.gzhead.time&255);ne(n,n.gzhead.time>>8&255);ne(n,n.gzhead.time>>16&255);ne(n,n.gzhead.time>>24&255);ne(n,n.level===9?2:n.strategy>=_||n.level<2?4:0);ne(n,n.gzhead.os&255);if(n.gzhead.extra&&n.gzhead.extra.length){ne(n,n.gzhead.extra.length&255);ne(n,n.gzhead.extra.length>>8&255)}if(n.gzhead.hcrc){e.adler=s(e.adler,n.pending_buf,n.pending,0)}n.gzindex=0;n.status=j}}else{var m=k+(n.w_bits-8<<4)<<8;var w=-1;if(n.strategy>=_||n.level<2){w=0}else if(n.level<6){w=1}else if(n.level===6){w=2}else{w=3}m|=w<<6;if(n.strstart!==0){m|=U}m+=31-m%31;n.status=V;ie(n,m);if(n.strstart!==0){ie(n,e.adler>>>16);ie(n,e.adler&65535)}e.adler=1}}if(n.status===j){if(n.gzhead.extra){a=n.pending;while(n.gzindex<(n.gzhead.extra.length&65535)){if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>a){e.adler=s(e.adler,n.pending_buf,n.pending-a,a)}te(e);a=n.pending;if(n.pending===n.pending_buf_size){break}}ne(n,n.gzhead.extra[n.gzindex]&255);n.gzindex++}if(n.gzhead.hcrc&&n.pending>a){e.adler=s(e.adler,n.pending_buf,n.pending-a,a)}if(n.gzindex===n.gzhead.extra.length){n.gzindex=0;n.status=Z}}else{n.status=Z}}if(n.status===Z){if(n.gzhead.name){a=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>a){e.adler=s(e.adler,n.pending_buf,n.pending-a,a)}te(e);a=n.pending;if(n.pending===n.pending_buf_size){o=1;break}}if(n.gzindex<n.gzhead.name.length){o=n.gzhead.name.charCodeAt(n.gzindex++)&255}else{o=0}ne(n,o)}while(o!==0);if(n.gzhead.hcrc&&n.pending>a){e.adler=s(e.adler,n.pending_buf,n.pending-a,a)}if(o===0){n.gzindex=0;n.status=X}}else{n.status=X}}if(n.status===X){if(n.gzhead.comment){a=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>a){e.adler=s(e.adler,n.pending_buf,n.pending-a,a)}te(e);a=n.pending;if(n.pending===n.pending_buf_size){o=1;break}}if(n.gzindex<n.gzhead.comment.length){o=n.gzhead.comment.charCodeAt(n.gzindex++)&255}else{o=0}ne(n,o)}while(o!==0);if(n.gzhead.hcrc&&n.pending>a){e.adler=s(e.adler,n.pending_buf,n.pending-a,a)}if(o===0){n.status=Y}}else{n.status=Y}}if(n.status===Y){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size){te(e)}if(n.pending+2<=n.pending_buf_size){ne(n,e.adler&255);ne(n,e.adler>>8&255);e.adler=0;n.status=V}}else{n.status=V}}if(n.pending!==0){te(e);if(e.avail_out===0){n.last_flush=-1;return d}}else if(e.avail_in===0&&Q(t)<=Q(r)&&t!==c){return J(e,g)}if(n.status===H&&e.avail_in!==0){return J(e,g)}if(e.avail_in!==0||n.lookahead!==0||t!==f&&n.status!==H){var y=n.strategy===_?he(n,t):n.strategy===b?ce(n,t):pe[n.level].func(n,t);if(y===W||y===q){n.status=H}if(y===$||y===W){if(e.avail_out===0){n.last_flush=-1}return d}if(y===G){if(t===u){i._tr_align(n)}else if(t!==h){i._tr_stored_block(n,0,0,false);if(t===l){ee(n.head);if(n.lookahead===0){n.strstart=0;n.block_start=0;n.insert=0}}}te(e);if(e.avail_out===0){n.last_flush=-1;return d}}}if(t!==c){return d}if(n.wrap<=0){return p}if(n.wrap===2){ne(n,e.adler&255);ne(n,e.adler>>8&255);ne(n,e.adler>>16&255);ne(n,e.adler>>24&255);ne(n,e.total_in&255);ne(n,e.total_in>>8&255);ne(n,e.total_in>>16&255);ne(n,e.total_in>>24&255)}else{ie(n,e.adler>>>16);ie(n,e.adler&65535)}te(e);if(n.wrap>0){n.wrap=-n.wrap}return n.pending!==0?d:p}function Ee(e){var t;if(!e||!e.state){return v}t=e.state.status;if(t!==F&&t!==j&&t!==Z&&t!==X&&t!==Y&&t!==V&&t!==H){return J(e,v)}e.state=null;return t===V?J(e,m):d}function Te(e,t){var r=t.length;var i;var s,o;var f;var u;var l;var c;var h;if(!e||!e.state){return v}i=e.state;f=i.wrap;if(f===2||f===1&&i.status!==F||i.lookahead){return v}if(f===1){e.adler=a(e.adler,t,r,0)}i.wrap=0;if(r>=i.w_size){if(f===0){ee(i.head);i.strstart=0;i.block_start=0;i.insert=0}h=new n.Buf8(i.w_size);n.arraySet(h,t,r-i.w_size,i.w_size,0);t=h;r=i.w_size}u=e.avail_in;l=e.next_in;c=e.input;e.avail_in=r;e.next_in=0;e.input=t;oe(i);while(i.lookahead>=L){s=i.strstart;o=i.lookahead-(L-1);do{i.ins_h=(i.ins_h<<i.hash_shift^i.window[s+L-1])&i.hash_mask;i.prev[s&i.w_mask]=i.head[i.ins_h];i.head[i.ins_h]=s;s++}while(--o);i.strstart=s;i.lookahead=L-1;oe(i)}i.strstart+=i.lookahead;i.block_start=i.strstart;i.insert=i.lookahead;i.lookahead=0;i.match_length=i.prev_length=L-1;i.match_available=0;e.next_in=l;e.input=c;e.avail_in=u;i.wrap=f;return d}r.deflateInit=be;r.deflateInit2=_e;r.deflateReset=we;r.deflateResetKeep=ge;r.deflateSetHeader=ye;r.deflate=xe;r.deflateEnd=Ee;r.deflateSetDictionary=Te;r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":63,"./adler32":65,"./crc32":67,"./messages":73,"./trees":74}],69:[function(e,t,r){"use strict";function n(){this.text=0;this.time=0;this.xflags=0;this.os=0;this.extra=null;this.extra_len=0;this.name="";this.comment="";this.hcrc=0;this.done=false}t.exports=n},{}],70:[function(e,t,r){"use strict";var n=30;var i=12;t.exports=function e(t,r){var a;var s;var o;var f;var u;var l;var c;var h;var d;var p;var v;var m;var g;var w;var y;var _;var b;var x;var E;var T;var k;var A;var S;var C,N;a=t.state;s=t.next_in;C=t.input;o=s+(t.avail_in-5);f=t.next_out;N=t.output;u=f-(r-t.avail_out);l=f+(t.avail_out-257);c=a.dmax;h=a.wsize;d=a.whave;p=a.wnext;v=a.window;m=a.hold;g=a.bits;w=a.lencode;y=a.distcode;_=(1<<a.lenbits)-1;b=(1<<a.distbits)-1;e:do{if(g<15){m+=C[s++]<<g;g+=8;m+=C[s++]<<g;g+=8}x=w[m&_];t:for(;;){E=x>>>24;m>>>=E;g-=E;E=x>>>16&255;if(E===0){N[f++]=x&65535}else if(E&16){T=x&65535;E&=15;if(E){if(g<E){m+=C[s++]<<g;g+=8}T+=m&(1<<E)-1;m>>>=E;g-=E}if(g<15){m+=C[s++]<<g;g+=8;m+=C[s++]<<g;g+=8}x=y[m&b];r:for(;;){E=x>>>24;m>>>=E;g-=E;E=x>>>16&255;if(E&16){k=x&65535;E&=15;if(g<E){m+=C[s++]<<g;g+=8;if(g<E){m+=C[s++]<<g;g+=8}}k+=m&(1<<E)-1;if(k>c){t.msg="invalid distance too far back";a.mode=n;break e}m>>>=E;g-=E;E=f-u;if(k>E){E=k-E;if(E>d){if(a.sane){t.msg="invalid distance too far back";a.mode=n;break e}}A=0;S=v;if(p===0){A+=h-E;if(E<T){T-=E;do{N[f++]=v[A++]}while(--E);A=f-k;S=N}}else if(p<E){A+=h+p-E;E-=p;if(E<T){T-=E;do{N[f++]=v[A++]}while(--E);A=0;if(p<T){E=p;T-=E;do{N[f++]=v[A++]}while(--E);A=f-k;S=N}}}else{A+=p-E;if(E<T){T-=E;do{N[f++]=v[A++]}while(--E);A=f-k;S=N}}while(T>2){N[f++]=S[A++];N[f++]=S[A++];N[f++]=S[A++];T-=3}if(T){N[f++]=S[A++];if(T>1){N[f++]=S[A++]}}}else{A=f-k;do{N[f++]=N[A++];N[f++]=N[A++];N[f++]=N[A++];T-=3}while(T>2);if(T){N[f++]=N[A++];if(T>1){N[f++]=N[A++]}}}}else if((E&64)===0){x=y[(x&65535)+(m&(1<<E)-1)];continue r}else{t.msg="invalid distance code";a.mode=n;break e}break}}else if((E&64)===0){x=w[(x&65535)+(m&(1<<E)-1)];continue t}else if(E&32){a.mode=i;break e}else{t.msg="invalid literal/length code";a.mode=n;break e}break}}while(s<o&&f<l);T=g>>3;s-=T;g-=T<<3;m&=(1<<g)-1;t.next_in=s;t.next_out=f;t.avail_in=s<o?5+(o-s):5-(s-o);t.avail_out=f<l?257+(l-f):257-(f-l);a.hold=m;a.bits=g;return}},{}],71:[function(e,t,r){"use strict";var n=e("../utils/common");var i=e("./adler32");var a=e("./crc32");var s=e("./inffast");var o=e("./inftrees");var f=0;var u=1;var l=2;var c=4;var h=5;var d=6;var p=0;var v=1;var m=2;var g=-2;var w=-3;var y=-4;var _=-5;var b=8;var x=1;var E=2;var T=3;var k=4;var A=5;var S=6;var C=7;var N=8;var I=9;var R=10;var O=11;var D=12;var z=13;var B=14;var L=15;var P=16;var M=17;var U=18;var F=19;var j=20;var Z=21;var X=22;var Y=23;var V=24;var H=25;var $=26;var G=27;var W=28;var q=29;var K=30;var J=31;var Q=32;var ee=852;var te=592;var re=15;var ne=re;function ie(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function ae(){this.mode=0;this.last=false;this.wrap=0;this.havedict=false;this.flags=0;this.dmax=0;this.check=0;this.total=0;this.head=null;this.wbits=0;this.wsize=0;this.whave=0;this.wnext=0;this.window=null;this.hold=0;this.bits=0;this.length=0;this.offset=0;this.extra=0;this.lencode=null;this.distcode=null;this.lenbits=0;this.distbits=0;this.ncode=0;this.nlen=0;this.ndist=0;this.have=0;this.next=null;this.lens=new n.Buf16(320);this.work=new n.Buf16(288);this.lendyn=null;this.distdyn=null;this.sane=0;this.back=0;this.was=0}function se(e){var t;if(!e||!e.state){return g}t=e.state;e.total_in=e.total_out=t.total=0;e.msg="";if(t.wrap){e.adler=t.wrap&1}t.mode=x;t.last=0;t.havedict=0;t.dmax=32768;t.head=null;t.hold=0;t.bits=0;t.lencode=t.lendyn=new n.Buf32(ee);t.distcode=t.distdyn=new n.Buf32(te);t.sane=1;t.back=-1;return p}function oe(e){var t;if(!e||!e.state){return g}t=e.state;t.wsize=0;t.whave=0;t.wnext=0;return se(e)}function fe(e,t){var r;var n;if(!e||!e.state){return g}n=e.state;if(t<0){r=0;t=-t}else{r=(t>>4)+1;if(t<48){t&=15}}if(t&&(t<8||t>15)){return g}if(n.window!==null&&n.wbits!==t){n.window=null}n.wrap=r;n.wbits=t;return oe(e)}function ue(e,t){var r;var n;if(!e){return g}n=new ae;e.state=n;n.window=null;r=fe(e,t);if(r!==p){e.state=null}return r}function le(e){return ue(e,ne)}var ce=true;var he,de;function pe(e){if(ce){var t;he=new n.Buf32(512);de=new n.Buf32(32);t=0;while(t<144){e.lens[t++]=8}while(t<256){e.lens[t++]=9}while(t<280){e.lens[t++]=7}while(t<288){e.lens[t++]=8}o(u,e.lens,0,288,he,0,e.work,{bits:9});t=0;while(t<32){e.lens[t++]=5}o(l,e.lens,0,32,de,0,e.work,{bits:5});ce=false}e.lencode=he;e.lenbits=9;e.distcode=de;e.distbits=5}function ve(e,t,r,i){var a;var s=e.state;if(s.window===null){s.wsize=1<<s.wbits;s.wnext=0;s.whave=0;s.window=new n.Buf8(s.wsize)}if(i>=s.wsize){n.arraySet(s.window,t,r-s.wsize,s.wsize,0);s.wnext=0;s.whave=s.wsize}else{a=s.wsize-s.wnext;if(a>i){a=i}n.arraySet(s.window,t,r-i,a,s.wnext);i-=a;if(i){n.arraySet(s.window,t,r-i,i,0);s.wnext=i;s.whave=s.wsize}else{s.wnext+=a;if(s.wnext===s.wsize){s.wnext=0}if(s.whave<s.wsize){s.whave+=a}}}return 0}function me(e,t){var r;var ee,te;var re;var ne;var ae,se;var oe;var fe;var ue,le;var ce;var he;var de;var me=0;var ge,we,ye;var _e,be,xe;var Ee;var Te;var ke=new n.Buf8(4);var Ae;var Se;var Ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0){return g}r=e.state;if(r.mode===D){r.mode=z}ne=e.next_out;te=e.output;se=e.avail_out;re=e.next_in;ee=e.input;ae=e.avail_in;oe=r.hold;fe=r.bits;ue=ae;le=se;Te=p;e:for(;;){switch(r.mode){case x:if(r.wrap===0){r.mode=z;break}while(fe<16){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}if(r.wrap&2&&oe===35615){r.check=0;ke[0]=oe&255;ke[1]=oe>>>8&255;r.check=a(r.check,ke,2,0);oe=0;fe=0;r.mode=E;break}r.flags=0;if(r.head){r.head.done=false}if(!(r.wrap&1)||(((oe&255)<<8)+(oe>>8))%31){e.msg="incorrect header check";r.mode=K;break}if((oe&15)!==b){e.msg="unknown compression method";r.mode=K;break}oe>>>=4;fe-=4;Ee=(oe&15)+8;if(r.wbits===0){r.wbits=Ee}else if(Ee>r.wbits){e.msg="invalid window size";r.mode=K;break}r.dmax=1<<Ee;e.adler=r.check=1;r.mode=oe&512?R:D;oe=0;fe=0;break;case E:while(fe<16){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}r.flags=oe;if((r.flags&255)!==b){e.msg="unknown compression method";r.mode=K;break}if(r.flags&57344){e.msg="unknown header flags set";r.mode=K;break}if(r.head){r.head.text=oe>>8&1}if(r.flags&512){ke[0]=oe&255;ke[1]=oe>>>8&255;r.check=a(r.check,ke,2,0)}oe=0;fe=0;r.mode=T;case T:while(fe<32){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}if(r.head){r.head.time=oe}if(r.flags&512){ke[0]=oe&255;ke[1]=oe>>>8&255;ke[2]=oe>>>16&255;ke[3]=oe>>>24&255;r.check=a(r.check,ke,4,0)}oe=0;fe=0;r.mode=k;case k:while(fe<16){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}if(r.head){r.head.xflags=oe&255;r.head.os=oe>>8}if(r.flags&512){ke[0]=oe&255;ke[1]=oe>>>8&255;r.check=a(r.check,ke,2,0)}oe=0;fe=0;r.mode=A;case A:if(r.flags&1024){while(fe<16){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}r.length=oe;if(r.head){r.head.extra_len=oe}if(r.flags&512){ke[0]=oe&255;ke[1]=oe>>>8&255;r.check=a(r.check,ke,2,0)}oe=0;fe=0}else if(r.head){r.head.extra=null}r.mode=S;case S:if(r.flags&1024){ce=r.length;if(ce>ae){ce=ae}if(ce){if(r.head){Ee=r.head.extra_len-r.length;if(!r.head.extra){r.head.extra=new Array(r.head.extra_len)}n.arraySet(r.head.extra,ee,re,ce,Ee)}if(r.flags&512){r.check=a(r.check,ee,ce,re)}ae-=ce;re+=ce;r.length-=ce}if(r.length){break e}}r.length=0;r.mode=C;case C:if(r.flags&2048){if(ae===0){break e}ce=0;do{Ee=ee[re+ce++];if(r.head&&Ee&&r.length<65536){r.head.name+=String.fromCharCode(Ee)}}while(Ee&&ce<ae);if(r.flags&512){r.check=a(r.check,ee,ce,re)}ae-=ce;re+=ce;if(Ee){break e}}else if(r.head){r.head.name=null}r.length=0;r.mode=N;case N:if(r.flags&4096){if(ae===0){break e}ce=0;do{Ee=ee[re+ce++];if(r.head&&Ee&&r.length<65536){r.head.comment+=String.fromCharCode(Ee)}}while(Ee&&ce<ae);if(r.flags&512){r.check=a(r.check,ee,ce,re)}ae-=ce;re+=ce;if(Ee){break e}}else if(r.head){r.head.comment=null}r.mode=I;case I:if(r.flags&512){while(fe<16){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}if(oe!==(r.check&65535)){e.msg="header crc mismatch";r.mode=K;break}oe=0;fe=0}if(r.head){r.head.hcrc=r.flags>>9&1;r.head.done=true}e.adler=r.check=0;r.mode=D;break;case R:while(fe<32){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}e.adler=r.check=ie(oe);oe=0;fe=0;r.mode=O;case O:if(r.havedict===0){e.next_out=ne;e.avail_out=se;e.next_in=re;e.avail_in=ae;r.hold=oe;r.bits=fe;return m}e.adler=r.check=1;r.mode=D;case D:if(t===h||t===d){break e}case z:if(r.last){oe>>>=fe&7;fe-=fe&7;r.mode=G;break}while(fe<3){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}r.last=oe&1;oe>>>=1;fe-=1;switch(oe&3){case 0:r.mode=B;break;case 1:pe(r);r.mode=j;if(t===d){oe>>>=2;fe-=2;break e}break;case 2:r.mode=M;break;case 3:e.msg="invalid block type";r.mode=K}oe>>>=2;fe-=2;break;case B:oe>>>=fe&7;fe-=fe&7;while(fe<32){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}if((oe&65535)!==(oe>>>16^65535)){e.msg="invalid stored block lengths";r.mode=K;break}r.length=oe&65535;oe=0;fe=0;r.mode=L;if(t===d){break e}case L:r.mode=P;case P:ce=r.length;if(ce){if(ce>ae){ce=ae}if(ce>se){ce=se}if(ce===0){break e}n.arraySet(te,ee,re,ce,ne);ae-=ce;re+=ce;se-=ce;ne+=ce;r.length-=ce;break}r.mode=D;break;case M:while(fe<14){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}r.nlen=(oe&31)+257;oe>>>=5;fe-=5;r.ndist=(oe&31)+1;oe>>>=5;fe-=5;r.ncode=(oe&15)+4;oe>>>=4;fe-=4;if(r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols";r.mode=K;break}r.have=0;r.mode=U;case U:while(r.have<r.ncode){while(fe<3){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}r.lens[Ce[r.have++]]=oe&7;oe>>>=3;fe-=3}while(r.have<19){r.lens[Ce[r.have++]]=0}r.lencode=r.lendyn;r.lenbits=7;Ae={bits:r.lenbits};Te=o(f,r.lens,0,19,r.lencode,0,r.work,Ae);r.lenbits=Ae.bits;if(Te){e.msg="invalid code lengths set";r.mode=K;break}r.have=0;r.mode=F;case F:while(r.have<r.nlen+r.ndist){for(;;){me=r.lencode[oe&(1<<r.lenbits)-1];ge=me>>>24;we=me>>>16&255;ye=me&65535;if(ge<=fe){break}if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}if(ye<16){oe>>>=ge;fe-=ge;r.lens[r.have++]=ye}else{if(ye===16){Se=ge+2;while(fe<Se){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}oe>>>=ge;fe-=ge;if(r.have===0){e.msg="invalid bit length repeat";r.mode=K;break}Ee=r.lens[r.have-1];ce=3+(oe&3);oe>>>=2;fe-=2}else if(ye===17){Se=ge+3;while(fe<Se){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}oe>>>=ge;fe-=ge;Ee=0;ce=3+(oe&7);oe>>>=3;fe-=3}else{Se=ge+7;while(fe<Se){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}oe>>>=ge;fe-=ge;Ee=0;ce=11+(oe&127);oe>>>=7;fe-=7}if(r.have+ce>r.nlen+r.ndist){e.msg="invalid bit length repeat";r.mode=K;break}while(ce--){r.lens[r.have++]=Ee}}}if(r.mode===K){break}if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block";r.mode=K;break}r.lenbits=9;Ae={bits:r.lenbits};Te=o(u,r.lens,0,r.nlen,r.lencode,0,r.work,Ae);r.lenbits=Ae.bits;if(Te){e.msg="invalid literal/lengths set";r.mode=K;break}r.distbits=6;r.distcode=r.distdyn;Ae={bits:r.distbits};Te=o(l,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Ae);r.distbits=Ae.bits;if(Te){e.msg="invalid distances set";r.mode=K;break}r.mode=j;if(t===d){break e}case j:r.mode=Z;case Z:if(ae>=6&&se>=258){e.next_out=ne;e.avail_out=se;e.next_in=re;e.avail_in=ae;r.hold=oe;r.bits=fe;s(e,le);ne=e.next_out;te=e.output;se=e.avail_out;re=e.next_in;ee=e.input;ae=e.avail_in;oe=r.hold;fe=r.bits;if(r.mode===D){r.back=-1}break}r.back=0;for(;;){me=r.lencode[oe&(1<<r.lenbits)-1];ge=me>>>24;we=me>>>16&255;ye=me&65535;if(ge<=fe){break}if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}if(we&&(we&240)===0){_e=ge;be=we;xe=ye;for(;;){me=r.lencode[xe+((oe&(1<<_e+be)-1)>>_e)];ge=me>>>24;we=me>>>16&255;ye=me&65535;if(_e+ge<=fe){break}if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}oe>>>=_e;fe-=_e;r.back+=_e}oe>>>=ge;fe-=ge;r.back+=ge;r.length=ye;if(we===0){r.mode=$;break}if(we&32){r.back=-1;r.mode=D;break}if(we&64){e.msg="invalid literal/length code";r.mode=K;break}r.extra=we&15;r.mode=X;case X:if(r.extra){Se=r.extra;while(fe<Se){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}r.length+=oe&(1<<r.extra)-1;oe>>>=r.extra;fe-=r.extra;r.back+=r.extra}r.was=r.length;r.mode=Y;case Y:for(;;){me=r.distcode[oe&(1<<r.distbits)-1];ge=me>>>24;we=me>>>16&255;ye=me&65535;if(ge<=fe){break}if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}if((we&240)===0){_e=ge;be=we;xe=ye;for(;;){me=r.distcode[xe+((oe&(1<<_e+be)-1)>>_e)];ge=me>>>24;we=me>>>16&255;ye=me&65535;if(_e+ge<=fe){break}if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}oe>>>=_e;fe-=_e;r.back+=_e}oe>>>=ge;fe-=ge;r.back+=ge;if(we&64){e.msg="invalid distance code";r.mode=K;break}r.offset=ye;r.extra=we&15;r.mode=V;case V:if(r.extra){Se=r.extra;while(fe<Se){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}r.offset+=oe&(1<<r.extra)-1;oe>>>=r.extra;fe-=r.extra;r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back";r.mode=K;break}r.mode=H;case H:if(se===0){break e}ce=le-se;if(r.offset>ce){ce=r.offset-ce;if(ce>r.whave){if(r.sane){e.msg="invalid distance too far back";r.mode=K;break}}if(ce>r.wnext){ce-=r.wnext;he=r.wsize-ce}else{he=r.wnext-ce}if(ce>r.length){ce=r.length}de=r.window}else{de=te;he=ne-r.offset;ce=r.length}if(ce>se){ce=se}se-=ce;r.length-=ce;do{te[ne++]=de[he++]}while(--ce);if(r.length===0){r.mode=Z}break;case $:if(se===0){break e}te[ne++]=r.length;se--;r.mode=Z;break;case G:if(r.wrap){while(fe<32){if(ae===0){break e}ae--;oe|=ee[re++]<<fe;fe+=8}le-=se;e.total_out+=le;r.total+=le;if(le){e.adler=r.check=r.flags?a(r.check,te,le,ne-le):i(r.check,te,le,ne-le)}le=se;if((r.flags?oe:ie(oe))!==r.check){e.msg="incorrect data check";r.mode=K;break}oe=0;fe=0}r.mode=W;case W:if(r.wrap&&r.flags){while(fe<32){if(ae===0){break e}ae--;oe+=ee[re++]<<fe;fe+=8}if(oe!==(r.total&4294967295)){e.msg="incorrect length check";r.mode=K;break}oe=0;fe=0}r.mode=q;case q:Te=v;break e;case K:Te=w;break e;case J:return y;case Q:default:return g}}e.next_out=ne;e.avail_out=se;e.next_in=re;e.avail_in=ae;r.hold=oe;r.bits=fe;if(r.wsize||le!==e.avail_out&&r.mode<K&&(r.mode<G||t!==c)){if(ve(e,e.output,e.next_out,le-e.avail_out)){r.mode=J;return y}}ue-=e.avail_in;le-=e.avail_out;e.total_in+=ue;e.total_out+=le;r.total+=le;if(r.wrap&&le){e.adler=r.check=r.flags?a(r.check,te,le,e.next_out-le):i(r.check,te,le,e.next_out-le)}e.data_type=r.bits+(r.last?64:0)+(r.mode===D?128:0)+(r.mode===j||r.mode===L?256:0);if((ue===0&&le===0||t===c)&&Te===p){Te=_}return Te}function ge(e){if(!e||!e.state){return g}var t=e.state;if(t.window){t.window=null}e.state=null;return p}function we(e,t){var r;if(!e||!e.state){return g}r=e.state;if((r.wrap&2)===0){return g}r.head=t;t.done=false;return p}function ye(e,t){var r=t.length;var n;var a;var s;if(!e||!e.state){return g}n=e.state;if(n.wrap!==0&&n.mode!==O){return g}if(n.mode===O){a=1;a=i(a,t,r,0);if(a!==n.check){return w}}s=ve(e,t,r,r);if(s){n.mode=J;return y}n.havedict=1;return p}r.inflateReset=oe;r.inflateReset2=fe;r.inflateResetKeep=se;r.inflateInit=le;r.inflateInit2=ue;r.inflate=me;r.inflateEnd=ge;r.inflateGetHeader=we;r.inflateSetDictionary=ye;r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":63,"./adler32":65,"./crc32":67,"./inffast":70,"./inftrees":72}],72:[function(e,t,r){"use strict";var n=e("../utils/common");var i=15;var a=852;var s=592;var o=0;var f=1;var u=2;var l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0];var c=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78];var h=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0];var d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function e(t,r,p,v,m,g,w,y){var _=y.bits;var b=0;var x=0;var E=0,T=0;var k=0;var A=0;var S=0;var C=0;var N=0;var I=0;var R;var O;var D;var z;var B;var L=null;var P=0;var M;var U=new n.Buf16(i+1);var F=new n.Buf16(i+1);var j=null;var Z=0;var X,Y,V;for(b=0;b<=i;b++){U[b]=0}for(x=0;x<v;x++){U[r[p+x]]++}k=_;for(T=i;T>=1;T--){if(U[T]!==0){break}}if(k>T){k=T}if(T===0){m[g++]=1<<24|64<<16|0;m[g++]=1<<24|64<<16|0;y.bits=1;return 0}for(E=1;E<T;E++){if(U[E]!==0){break}}if(k<E){k=E}C=1;for(b=1;b<=i;b++){C<<=1;C-=U[b];if(C<0){return-1}}if(C>0&&(t===o||T!==1)){return-1}F[1]=0;for(b=1;b<i;b++){F[b+1]=F[b]+U[b]}for(x=0;x<v;x++){if(r[p+x]!==0){w[F[r[p+x]]++]=x}}if(t===o){L=j=w;M=19}else if(t===f){L=l;P-=257;j=c;Z-=257;M=256}else{L=h;j=d;M=-1}I=0;x=0;b=E;B=g;A=k;S=0;D=-1;N=1<<k;z=N-1;if(t===f&&N>a||t===u&&N>s){return 1}for(;;){X=b-S;if(w[x]<M){Y=0;V=w[x]}else if(w[x]>M){Y=j[Z+w[x]];V=L[P+w[x]]}else{Y=32+64;V=0}R=1<<b-S;O=1<<A;E=O;do{O-=R;m[B+(I>>S)+O]=X<<24|Y<<16|V|0}while(O!==0);R=1<<b-1;while(I&R){R>>=1}if(R!==0){I&=R-1;I+=R}else{I=0}x++;if(--U[b]===0){if(b===T){break}b=r[p+w[x]]}if(b>k&&(I&z)!==D){if(S===0){S=k}B+=E;A=b-S;C=1<<A;while(A+S<T){C-=U[A+S];if(C<=0){break}A++;C<<=1}N+=1<<A;if(t===f&&N>a||t===u&&N>s){return 1}D=I&z;m[D]=k<<24|A<<16|B-g|0}}if(I!==0){m[B+I]=b-S<<24|64<<16|0}y.bits=k;return 0}},{"../utils/common":63}],73:[function(e,t,r){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],74:[function(e,t,r){"use strict";var n=e("../utils/common");var i=4;var a=0;var s=1;var o=2;function f(e){var t=e.length;while(--t>=0){e[t]=0}}var u=0;var l=1;var c=2;var h=3;var d=258;var p=29;var v=256;var m=v+1+p;var g=30;var w=19;var y=2*m+1;var _=15;var b=16;var x=7;var E=256;var T=16;var k=17;var A=18;var S=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];var C=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var N=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var R=512;var O=new Array((m+2)*2);f(O);var D=new Array(g*2);f(D);var z=new Array(R);f(z);var B=new Array(d-h+1);f(B);var L=new Array(p);f(L);var P=new Array(g);f(P);function M(e,t,r,n,i){this.static_tree=e;this.extra_bits=t;this.extra_base=r;this.elems=n;this.max_length=i;this.has_stree=e&&e.length}var U;var F;var j;function Z(e,t){this.dyn_tree=e;this.max_code=0;this.stat_desc=t}function X(e){return e<256?z[e]:z[256+(e>>>7)]}function Y(e,t){e.pending_buf[e.pending++]=t&255;e.pending_buf[e.pending++]=t>>>8&255}function V(e,t,r){if(e.bi_valid>b-r){e.bi_buf|=t<<e.bi_valid&65535;Y(e,e.bi_buf);e.bi_buf=t>>b-e.bi_valid;e.bi_valid+=r-b}else{e.bi_buf|=t<<e.bi_valid&65535;e.bi_valid+=r}}function H(e,t,r){V(e,r[t*2],r[t*2+1])}function $(e,t){var r=0;do{r|=e&1;e>>>=1;r<<=1}while(--t>0);return r>>>1}function G(e){if(e.bi_valid===16){Y(e,e.bi_buf);e.bi_buf=0;e.bi_valid=0}else if(e.bi_valid>=8){e.pending_buf[e.pending++]=e.bi_buf&255;e.bi_buf>>=8;e.bi_valid-=8}}function W(e,t){var r=t.dyn_tree;var n=t.max_code;var i=t.stat_desc.static_tree;var a=t.stat_desc.has_stree;var s=t.stat_desc.extra_bits;var o=t.stat_desc.extra_base;var f=t.stat_desc.max_length;var u;var l,c;var h;var d;var p;var v=0;for(h=0;h<=_;h++){e.bl_count[h]=0}r[e.heap[e.heap_max]*2+1]=0;for(u=e.heap_max+1;u<y;u++){l=e.heap[u];h=r[r[l*2+1]*2+1]+1;if(h>f){h=f;v++}r[l*2+1]=h;if(l>n){continue}e.bl_count[h]++;d=0;if(l>=o){d=s[l-o]}p=r[l*2];e.opt_len+=p*(h+d);if(a){e.static_len+=p*(i[l*2+1]+d)}}if(v===0){return}do{h=f-1;while(e.bl_count[h]===0){h--}e.bl_count[h]--;e.bl_count[h+1]+=2;e.bl_count[f]--;v-=2}while(v>0);for(h=f;h!==0;h--){l=e.bl_count[h];while(l!==0){c=e.heap[--u];if(c>n){continue}if(r[c*2+1]!==h){e.opt_len+=(h-r[c*2+1])*r[c*2];r[c*2+1]=h}l--}}}function q(e,t,r){var n=new Array(_+1);var i=0;var a;var s;for(a=1;a<=_;a++){n[a]=i=i+r[a-1]<<1}for(s=0;s<=t;s++){var o=e[s*2+1];if(o===0){continue}e[s*2]=$(n[o]++,o)}}function K(){var e;var t;var r;var n;var i;var a=new Array(_+1);r=0;for(n=0;n<p-1;n++){L[n]=r;for(e=0;e<1<<S[n];e++){B[r++]=n}}B[r-1]=n;i=0;for(n=0;n<16;n++){P[n]=i;for(e=0;e<1<<C[n];e++){z[i++]=n}}i>>=7;for(;n<g;n++){P[n]=i<<7;for(e=0;e<1<<C[n]-7;e++){z[256+i++]=n}}for(t=0;t<=_;t++){a[t]=0}e=0;while(e<=143){O[e*2+1]=8;e++;a[8]++}while(e<=255){O[e*2+1]=9;e++;a[9]++}while(e<=279){O[e*2+1]=7;e++;a[7]++}while(e<=287){O[e*2+1]=8;e++;a[8]++}q(O,m+1,a);for(e=0;e<g;e++){D[e*2+1]=5;D[e*2]=$(e,5)}U=new M(O,S,v+1,m,_);F=new M(D,C,0,g,_);j=new M(new Array(0),N,0,w,x)}function J(e){var t;for(t=0;t<m;t++){e.dyn_ltree[t*2]=0}for(t=0;t<g;t++){e.dyn_dtree[t*2]=0}for(t=0;t<w;t++){e.bl_tree[t*2]=0}e.dyn_ltree[E*2]=1;e.opt_len=e.static_len=0;e.last_lit=e.matches=0}function Q(e){if(e.bi_valid>8){Y(e,e.bi_buf)}else if(e.bi_valid>0){e.pending_buf[e.pending++]=e.bi_buf}e.bi_buf=0;e.bi_valid=0}function ee(e,t,r,i){Q(e);if(i){Y(e,r);Y(e,~r)}n.arraySet(e.pending_buf,e.window,t,r,e.pending);e.pending+=r}function te(e,t,r,n){var i=t*2;var a=r*2;return e[i]<e[a]||e[i]===e[a]&&n[t]<=n[r]}function re(e,t,r){var n=e.heap[r];var i=r<<1;while(i<=e.heap_len){if(i<e.heap_len&&te(t,e.heap[i+1],e.heap[i],e.depth)){i++}if(te(t,n,e.heap[i],e.depth)){break}e.heap[r]=e.heap[i];r=i;i<<=1}e.heap[r]=n}function ne(e,t,r){var n;var i;var a=0;var s;var o;if(e.last_lit!==0){do{n=e.pending_buf[e.d_buf+a*2]<<8|e.pending_buf[e.d_buf+a*2+1];i=e.pending_buf[e.l_buf+a];a++;if(n===0){H(e,i,t)}else{s=B[i];H(e,s+v+1,t);o=S[s];if(o!==0){i-=L[s];V(e,i,o)}n--;s=X(n);H(e,s,r);o=C[s];if(o!==0){n-=P[s];V(e,n,o)}}}while(a<e.last_lit)}H(e,E,t)}function ie(e,t){var r=t.dyn_tree;var n=t.stat_desc.static_tree;var i=t.stat_desc.has_stree;var a=t.stat_desc.elems;var s,o;var f=-1;var u;e.heap_len=0;e.heap_max=y;for(s=0;s<a;s++){if(r[s*2]!==0){e.heap[++e.heap_len]=f=s;e.depth[s]=0}else{r[s*2+1]=0}}while(e.heap_len<2){u=e.heap[++e.heap_len]=f<2?++f:0;r[u*2]=1;e.depth[u]=0;e.opt_len--;if(i){e.static_len-=n[u*2+1]}}t.max_code=f;for(s=e.heap_len>>1;s>=1;s--){re(e,r,s)}u=a;do{s=e.heap[1];e.heap[1]=e.heap[e.heap_len--];re(e,r,1);o=e.heap[1];e.heap[--e.heap_max]=s;e.heap[--e.heap_max]=o;r[u*2]=r[s*2]+r[o*2];e.depth[u]=(e.depth[s]>=e.depth[o]?e.depth[s]:e.depth[o])+1;r[s*2+1]=r[o*2+1]=u;e.heap[1]=u++;re(e,r,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1];W(e,t);q(r,f,e.bl_count)}function ae(e,t,r){var n;var i=-1;var a;var s=t[0*2+1];var o=0;var f=7;var u=4;if(s===0){f=138;u=3}t[(r+1)*2+1]=65535;for(n=0;n<=r;n++){a=s;s=t[(n+1)*2+1];if(++o<f&&a===s){continue}else if(o<u){e.bl_tree[a*2]+=o}else if(a!==0){if(a!==i){e.bl_tree[a*2]++}e.bl_tree[T*2]++}else if(o<=10){e.bl_tree[k*2]++}else{e.bl_tree[A*2]++}o=0;i=a;if(s===0){f=138;u=3}else if(a===s){f=6;u=3}else{f=7;u=4}}}function se(e,t,r){var n;var i=-1;var a;var s=t[0*2+1];var o=0;var f=7;var u=4;if(s===0){f=138;u=3}for(n=0;n<=r;n++){a=s;s=t[(n+1)*2+1];if(++o<f&&a===s){continue}else if(o<u){do{H(e,a,e.bl_tree)}while(--o!==0)}else if(a!==0){if(a!==i){H(e,a,e.bl_tree);o--}H(e,T,e.bl_tree);V(e,o-3,2)}else if(o<=10){H(e,k,e.bl_tree);V(e,o-3,3)}else{H(e,A,e.bl_tree);V(e,o-11,7)}o=0;i=a;if(s===0){f=138;u=3}else if(a===s){f=6;u=3}else{f=7;u=4}}}function oe(e){var t;ae(e,e.dyn_ltree,e.l_desc.max_code);ae(e,e.dyn_dtree,e.d_desc.max_code);ie(e,e.bl_desc);for(t=w-1;t>=3;t--){if(e.bl_tree[I[t]*2+1]!==0){break}}e.opt_len+=3*(t+1)+5+5+4;return t}function fe(e,t,r,n){var i;V(e,t-257,5);V(e,r-1,5);V(e,n-4,4);for(i=0;i<n;i++){V(e,e.bl_tree[I[i]*2+1],3)}se(e,e.dyn_ltree,t-1);se(e,e.dyn_dtree,r-1)}function ue(e){var t=4093624447;var r;for(r=0;r<=31;r++,t>>>=1){if(t&1&&e.dyn_ltree[r*2]!==0){return a}}if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0){return s}for(r=32;r<v;r++){if(e.dyn_ltree[r*2]!==0){return s}}return a}var le=false;function ce(e){if(!le){K();le=true}e.l_desc=new Z(e.dyn_ltree,U);e.d_desc=new Z(e.dyn_dtree,F);e.bl_desc=new Z(e.bl_tree,j);e.bi_buf=0;e.bi_valid=0;J(e)}function he(e,t,r,n){V(e,(u<<1)+(n?1:0),3);ee(e,t,r,true)}function de(e){V(e,l<<1,3);H(e,E,O);G(e)}function pe(e,t,r,n){var a,s;var f=0;if(e.level>0){if(e.strm.data_type===o){e.strm.data_type=ue(e)}ie(e,e.l_desc);ie(e,e.d_desc);f=oe(e);a=e.opt_len+3+7>>>3;s=e.static_len+3+7>>>3;if(s<=a){a=s}}else{a=s=r+5}if(r+4<=a&&t!==-1){he(e,t,r,n)}else if(e.strategy===i||s===a){V(e,(l<<1)+(n?1:0),3);ne(e,O,D)}else{V(e,(c<<1)+(n?1:0),3);fe(e,e.l_desc.max_code+1,e.d_desc.max_code+1,f+1);ne(e,e.dyn_ltree,e.dyn_dtree)}J(e);if(n){Q(e)}}function ve(e,t,r){e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255;e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255;e.pending_buf[e.l_buf+e.last_lit]=r&255;e.last_lit++;if(t===0){e.dyn_ltree[r*2]++}else{e.matches++;t--;e.dyn_ltree[(B[r]+v+1)*2]++;e.dyn_dtree[X(t)*2]++}return e.last_lit===e.lit_bufsize-1}r._tr_init=ce;r._tr_stored_block=he;r._tr_flush_block=pe;r._tr_tally=ve;r._tr_align=de},{"../utils/common":63}],75:[function(e,t,r){"use strict";function n(){this.input=null;this.next_in=0;this.avail_in=0;this.total_in=0;this.output=null;this.next_out=0;this.avail_out=0;this.total_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}t.exports=n},{}],76:[function(e,t,r){function n(e){this.options=e||{locator:{}}}n.prototype.parseFromString=function(e,t){var r=this.options;var n=new l;var s=r.domBuilder||new a;var o=r.errorHandler;var f=r.locator;var u=r.xmlns||{};var c={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};if(f){s.setDocumentLocator(f)}n.errorHandler=i(o,s,f);n.domBuilder=r.domBuilder||s;if(/\/x?html?$/.test(t)){c.nbsp="";c.copy="";u[""]="http://www.w3.org/1999/xhtml"}u.xml=u.xml||"http://www.w3.org/XML/1998/namespace";if(e){n.parse(e,u,c)}else{n.errorHandler.error("invalid doc source")}return s.doc};function i(e,t,r){if(!e){if(t instanceof a){return t}e=t}var n={};var i=e instanceof Function;r=r||{};function s(t){var a=e[t];if(!a&&i){a=e.length==2?function(r){e(t,r)}:e}n[t]=a&&function(e){a("[xmldom "+t+"]\t"+e+o(r))}||function(){}}s("warning");s("error");s("fatalError");return n}function a(){this.cdata=false}function s(e,t){t.lineNumber=e.lineNumber;t.columnNumber=e.columnNumber}a.prototype={startDocument:function(){this.doc=(new c).createDocument(null,null,null);if(this.locator){this.doc.documentURI=this.locator.systemId}},startElement:function(e,t,r,n){var i=this.doc;var a=i.createElementNS(e,r||t);var o=n.length;u(this,a);this.currentElement=a;this.locator&&s(this.locator,a);for(var f=0;f<o;f++){var e=n.getURI(f);var l=n.getValue(f);var r=n.getQName(f);var c=i.createAttributeNS(e,r);this.locator&&s(n.getLocator(f),c);c.value=c.nodeValue=l;a.setAttributeNode(c)}},endElement:function(e,t,r){var n=this.currentElement;var i=n.tagName;this.currentElement=n.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var r=this.doc.createProcessingInstruction(e,t);this.locator&&s(this.locator,r);u(this,r)},ignorableWhitespace:function(e,t,r){},characters:function(e,t,r){e=f.apply(this,arguments);if(e){if(this.cdata){var n=this.doc.createCDATASection(e)}else{var n=this.doc.createTextNode(e)}if(this.currentElement){this.currentElement.appendChild(n)}else if(/^\s*$/.test(e)){this.doc.appendChild(n)}this.locator&&s(this.locator,n)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){if(this.locator=e){e.lineNumber=0}},comment:function(e,t,r){e=f.apply(this,arguments);var n=this.doc.createComment(e);this.locator&&s(this.locator,n);u(this,n)},startCDATA:function(){this.cdata=true},endCDATA:function(){this.cdata=false},startDTD:function(e,t,r){var n=this.doc.implementation;if(n&&n.createDocumentType){var i=n.createDocumentType(e,t,r);this.locator&&s(this.locator,i);u(this,i)}},warning:function(e){console.warn("[xmldom warning]\t"+e,o(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,o(this.locator))},fatalError:function(e){console.error("[xmldom fatalError]\t"+e,o(this.locator));throw e}};function o(e){if(e){return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}}function f(e,t,r){if(typeof e=="string"){return e.substr(t,r)}else{if(e.length>=t+r||t){return new java.lang.String(e,t,r)+""}return e}}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){a.prototype[e]=function(){return null}});function u(e,t){if(!e.currentElement){e.doc.appendChild(t)}else{e.currentElement.appendChild(t)}}var l=e("./sax").XMLReader;var c=r.DOMImplementation=e("./dom").DOMImplementation;r.XMLSerializer=e("./dom").XMLSerializer;r.DOMParser=n},{"./dom":77,"./sax":78}],77:[function(e,t,r){function n(e,t){for(var r in e){t[r]=e[r]}}function i(e,t){var r=e.prototype;if(Object.create){var i=Object.create(t.prototype);r.__proto__=i}if(!(r instanceof t)){function a(){}a.prototype=t.prototype;a=new a;n(r,a);e.prototype=r=a}if(r.constructor!=e){if(typeof e!="function"){console.error("unknow Class:"+e)}r.constructor=e}}var a="http://www.w3.org/1999/xhtml";var s={};var o=s.ELEMENT_NODE=1;var f=s.ATTRIBUTE_NODE=2;var u=s.TEXT_NODE=3;var l=s.CDATA_SECTION_NODE=4;var c=s.ENTITY_REFERENCE_NODE=5;var h=s.ENTITY_NODE=6;var d=s.PROCESSING_INSTRUCTION_NODE=7;var p=s.COMMENT_NODE=8;var v=s.DOCUMENT_NODE=9;var m=s.DOCUMENT_TYPE_NODE=10;var g=s.DOCUMENT_FRAGMENT_NODE=11;var w=s.NOTATION_NODE=12;var y={};var _={};var b=y.INDEX_SIZE_ERR=(_[1]="Index size error",1);var x=y.DOMSTRING_SIZE_ERR=(_[2]="DOMString size error",2);var E=y.HIERARCHY_REQUEST_ERR=(_[3]="Hierarchy request error",3);var T=y.WRONG_DOCUMENT_ERR=(_[4]="Wrong document",4);var k=y.INVALID_CHARACTER_ERR=(_[5]="Invalid character",5);var A=y.NO_DATA_ALLOWED_ERR=(_[6]="No data allowed",6);var S=y.NO_MODIFICATION_ALLOWED_ERR=(_[7]="No modification allowed",7);var C=y.NOT_FOUND_ERR=(_[8]="Not found",8);var N=y.NOT_SUPPORTED_ERR=(_[9]="Not supported",9);var I=y.INUSE_ATTRIBUTE_ERR=(_[10]="Attribute in use",10);var R=y.INVALID_STATE_ERR=(_[11]="Invalid state",11);var O=y.SYNTAX_ERR=(_[12]="Syntax error",12);var D=y.INVALID_MODIFICATION_ERR=(_[13]="Invalid modification",13);var z=y.NAMESPACE_ERR=(_[14]="Invalid namespace",14);var B=y.INVALID_ACCESS_ERR=(_[15]="Invalid access",15);function L(e,t){if(t instanceof Error){var r=t}else{r=this;Error.call(this,_[e]);this.message=_[e];if(Error.captureStackTrace)Error.captureStackTrace(this,L)}r.code=e;if(t)this.message=this.message+": "+t;return r}L.prototype=Error.prototype;n(y,L);function P(){}P.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var r=[],n=0;n<this.length;n++){me(this[n],r,e,t)}return r.join("")}};function M(e,t){this._node=e;this._refresh=t;U(this)}function U(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var r=e._refresh(e._node);ye(e,"length",r.length);n(r,e);e._inc=t}}M.prototype.item=function(e){U(this);return this[e]};i(M,P);function F(){}function j(e,t){var r=e.length;while(r--){if(e[r]===t){return r}}}function Z(e,t,r,n){if(n){t[j(t,n)]=r}else{t[t.length++]=r}if(e){r.ownerElement=e;var i=e.ownerDocument;if(i){n&&q(i,e,n);W(i,e,r)}}}function X(e,t,r){var n=j(t,r);if(n>=0){var i=t.length-1;while(n<i){t[n]=t[++n]}t.length=i;if(e){var a=e.ownerDocument;if(a){q(a,e,r);r.ownerElement=null}}}else{throw L(C,new Error(e.tagName+"@"+r))}}F.prototype={length:0,item:P.prototype.item,getNamedItem:function(e){var t=this.length;while(t--){var r=this[t];if(r.nodeName==e){return r}}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement){throw new L(I)}var r=this.getNamedItem(e.nodeName);Z(this._ownerElement,this,e,r);return r},setNamedItemNS:function(e){var t=e.ownerElement,r;if(t&&t!=this._ownerElement){throw new L(I)}r=this.getNamedItemNS(e.namespaceURI,e.localName);Z(this._ownerElement,this,e,r);return r},removeNamedItem:function(e){var t=this.getNamedItem(e);X(this._ownerElement,this,t);return t},removeNamedItemNS:function(e,t){var r=this.getNamedItemNS(e,t);X(this._ownerElement,this,r);return r},getNamedItemNS:function(e,t){var r=this.length;while(r--){var n=this[r];if(n.localName==t&&n.namespaceURI==e){return n}}return null}};function Y(e){this._features={};if(e){for(var t in e){this._features=e[t]}}}Y.prototype={hasFeature:function(e,t){var r=this._features[e.toLowerCase()];if(r&&(!t||t in r)){return true}else{return false}},createDocument:function(e,t,r){var n=new G;n.implementation=this;n.childNodes=new P;n.doctype=r;if(r){n.appendChild(r)}if(t){var i=n.createElementNS(e,t);n.appendChild(i)}return n},createDocumentType:function(e,t,r){var n=new oe;n.name=e;n.nodeName=e;n.publicId=t;n.systemId=r;return n}};function V(){}V.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return Q(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t);if(t){this.removeChild(t)}},removeChild:function(e){return J(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(e){return we(this.ownerDocument||this,this,e)},normalize:function(){var e=this.firstChild;while(e){var t=e.nextSibling;if(t&&t.nodeType==u&&e.nodeType==u){this.removeChild(t);e.appendData(t.data)}else{e.normalize();e=t}}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){var t=this;while(t){var r=t._nsMap;if(r){for(var n in r){if(r[n]==e){return n}}}t=t.nodeType==f?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){var t=this;while(t){var r=t._nsMap;if(r){if(e in r){return r[e]}}t=t.nodeType==f?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){var t=this.lookupPrefix(e);return t==null}};function H(e){return e=="<"&&"&lt;"||e==">"&&"&gt;"||e=="&"&&"&amp;"||e=='"'&&"&quot;"||"&#"+e.charCodeAt()+";"}n(s,V);n(s,V.prototype);function $(e,t){if(t(e)){return true}if(e=e.firstChild){do{if($(e,t)){return true}}while(e=e.nextSibling)}}function G(){}function W(e,t,r){e&&e._inc++;var n=r.namespaceURI;if(n=="http://www.w3.org/2000/xmlns/"){t._nsMap[r.prefix?r.localName:""]=r.value}}function q(e,t,r,n){e&&e._inc++;var i=r.namespaceURI;if(i=="http://www.w3.org/2000/xmlns/"){delete t._nsMap[r.prefix?r.localName:""]}}function K(e,t,r){if(e&&e._inc){e._inc++;var n=t.childNodes;if(r){n[n.length++]=r}else{var i=t.firstChild;var a=0;while(i){n[a++]=i;i=i.nextSibling}n.length=a}}}function J(e,t){var r=t.previousSibling;var n=t.nextSibling;if(r){r.nextSibling=n}else{e.firstChild=n}if(n){n.previousSibling=r}else{e.lastChild=r}K(e.ownerDocument,e);return t}function Q(e,t,r){var n=t.parentNode;if(n){n.removeChild(t)}if(t.nodeType===g){var i=t.firstChild;if(i==null){return t}var a=t.lastChild}else{i=a=t}var s=r?r.previousSibling:e.lastChild;i.previousSibling=s;a.nextSibling=r;if(s){s.nextSibling=i}else{e.firstChild=i}if(r==null){e.lastChild=a}else{r.previousSibling=a}do{i.parentNode=e}while(i!==a&&(i=i.nextSibling));K(e.ownerDocument||e,e);if(t.nodeType==g){t.firstChild=t.lastChild=null}return t}function ee(e,t){var r=t.parentNode;if(r){var n=e.lastChild;r.removeChild(t);var n=e.lastChild}var n=e.lastChild;t.parentNode=e;t.previousSibling=n;t.nextSibling=null;if(n){n.nextSibling=t}else{e.firstChild=t}e.lastChild=t;K(e.ownerDocument,e,t);return t}G.prototype={nodeName:"#document",nodeType:v,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==g){var r=e.firstChild;while(r){var n=r.nextSibling;this.insertBefore(r,t);r=n}return e}if(this.documentElement==null&&e.nodeType==o){this.documentElement=e}return Q(this,e,t),e.ownerDocument=this,e},removeChild:function(e){if(this.documentElement==e){this.documentElement=null}return J(this,e)},importNode:function(e,t){return ge(this,e,t)},getElementById:function(e){var t=null;$(this.documentElement,function(r){if(r.nodeType==o){if(r.getAttribute("id")==e){t=r;return true}}});return t},createElement:function(e){var t=new te;t.ownerDocument=this;t.nodeName=e;t.tagName=e;t.childNodes=new P;var r=t.attributes=new F;r._ownerElement=t;return t},createDocumentFragment:function(){var e=new ce;e.ownerDocument=this;e.childNodes=new P;return e},createTextNode:function(e){var t=new ie;t.ownerDocument=this;t.appendData(e);return t},createComment:function(e){var t=new ae;t.ownerDocument=this;t.appendData(e);return t},createCDATASection:function(e){var t=new se;t.ownerDocument=this;t.appendData(e);return t},createProcessingInstruction:function(e,t){var r=new he;r.ownerDocument=this;r.tagName=r.target=e;r.nodeValue=r.data=t;return r},createAttribute:function(e){var t=new re;t.ownerDocument=this;t.name=e;t.nodeName=e;t.localName=e;t.specified=true;return t},createEntityReference:function(e){var t=new le;t.ownerDocument=this;t.nodeName=e;return t},createElementNS:function(e,t){var r=new te;var n=t.split(":");var i=r.attributes=new F;r.childNodes=new P;r.ownerDocument=this;r.nodeName=t;r.tagName=t;r.namespaceURI=e;if(n.length==2){r.prefix=n[0];r.localName=n[1]}else{r.localName=t}i._ownerElement=r;return r},createAttributeNS:function(e,t){var r=new re;var n=t.split(":");r.ownerDocument=this;r.nodeName=t;r.name=t;r.namespaceURI=e;r.specified=true;if(n.length==2){r.prefix=n[0];r.localName=n[1]}else{r.localName=t}return r}};i(G,V);function te(){this._nsMap={}}te.prototype={nodeType:o,hasAttribute:function(e){return this.getAttributeNode(e)!=null},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var r=this.ownerDocument.createAttribute(e);r.value=r.nodeValue=""+t;this.setAttributeNode(r)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){if(e.nodeType===g){return this.insertBefore(e,null)}else{return ee(this,e)}},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);r&&this.removeAttributeNode(r)},hasAttributeNS:function(e,t){return this.getAttributeNodeNS(e,t)!=null},getAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);return r&&r.value||""},setAttributeNS:function(e,t,r){var n=this.ownerDocument.createAttributeNS(e,t);n.value=n.nodeValue=""+r;this.setAttributeNode(n)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new M(this,function(t){var r=[];$(t,function(n){if(n!==t&&n.nodeType==o&&(e==="*"||n.tagName==e)){r.push(n)}});return r})},getElementsByTagNameNS:function(e,t){return new M(this,function(r){var n=[];$(r,function(i){if(i!==r&&i.nodeType===o&&(e==="*"||i.namespaceURI===e)&&(t==="*"||i.localName==t)){n.push(i)}});return n})}};G.prototype.getElementsByTagName=te.prototype.getElementsByTagName;G.prototype.getElementsByTagNameNS=te.prototype.getElementsByTagNameNS;i(te,V);function re(){}re.prototype.nodeType=f;i(re,V);function ne(){}ne.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e;this.nodeValue=this.data=e;this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(_[E])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,r){var n=this.data.substring(0,e);var i=this.data.substring(e+t);r=n+r+i;this.nodeValue=this.data=r;this.length=r.length}};i(ne,V);function ie(){}ie.prototype={nodeName:"#text",nodeType:u,splitText:function(e){var t=this.data;var r=t.substring(e);t=t.substring(0,e);this.data=this.nodeValue=t;this.length=t.length;var n=this.ownerDocument.createTextNode(r);if(this.parentNode){this.parentNode.insertBefore(n,this.nextSibling)}return n}};i(ie,ne);function ae(){}ae.prototype={nodeName:"#comment",nodeType:p};i(ae,ne);function se(){}se.prototype={nodeName:"#cdata-section",nodeType:l};i(se,ne);function oe(){}oe.prototype.nodeType=m;i(oe,V);function fe(){}fe.prototype.nodeType=w;i(fe,V);function ue(){}ue.prototype.nodeType=h;i(ue,V);function le(){}le.prototype.nodeType=c;i(le,V);function ce(){}ce.prototype.nodeName="#document-fragment";ce.prototype.nodeType=g;i(ce,V);function he(){}he.prototype.nodeType=d;i(he,V);function de(){}de.prototype.serializeToString=function(e,t,r){return pe.call(e,t,r)};V.prototype.toString=pe;function pe(e,t){var r=[];var n=this.nodeType==9?this.documentElement:this;var i=n.prefix;var a=n.namespaceURI;if(a&&i==null){var i=n.lookupPrefix(a);if(i==null){var s=[{namespace:a,prefix:null}]}}me(this,r,e,t,s);return r.join("")}function ve(e,t,r){var n=e.prefix||"";var i=e.namespaceURI;if(!n&&!i){return false}if(n==="xml"&&i==="http://www.w3.org/XML/1998/namespace"||i=="http://www.w3.org/2000/xmlns/"){return false}var a=r.length;while(a--){var s=r[a];if(s.prefix==n){return s.namespace!=i}}return true}function me(e,t,r,n,i){if(n){e=n(e);if(e){if(typeof e=="string"){t.push(e);return}}else{return}}switch(e.nodeType){case o:if(!i)i=[];var s=i.length;var h=e.attributes;var w=h.length;var y=e.firstChild;var _=e.tagName;r=a===e.namespaceURI||r;t.push("<",_);for(var b=0;b<w;b++){var x=h.item(b);if(x.prefix=="xmlns"){i.push({prefix:x.localName,namespace:x.value})}else if(x.nodeName=="xmlns"){i.push({prefix:"",namespace:x.value})}}for(var b=0;b<w;b++){var x=h.item(b);if(ve(x,r,i)){var E=x.prefix||"";var T=x.namespaceURI;var k=E?" xmlns:"+E:" xmlns";t.push(k,'="',T,'"');i.push({prefix:E,namespace:T})}me(x,t,r,n,i)}if(ve(e,r,i)){var E=e.prefix||"";var T=e.namespaceURI;var k=E?" xmlns:"+E:" xmlns";t.push(k,'="',T,'"');i.push({prefix:E,namespace:T})}if(y||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(_)){t.push(">");if(r&&/^script$/i.test(_)){while(y){if(y.data){t.push(y.data)}else{me(y,t,r,n,i)}y=y.nextSibling}}else{while(y){me(y,t,r,n,i);y=y.nextSibling}}t.push("</",_,">")}else{t.push("/>")}return;case v:case g:var y=e.firstChild;while(y){me(y,t,r,n,i);y=y.nextSibling}return;case f:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,H),'"');case u:return t.push(e.data.replace(/[<&]/g,H));case l:return t.push("<![CDATA[",e.data,"]]>");case p:return t.push("\x3c!--",e.data,"--\x3e");case m:var A=e.publicId;var S=e.systemId;t.push("<!DOCTYPE ",e.name);if(A){t.push(' PUBLIC "',A);if(S&&S!="."){t.push('" "',S)}t.push('">')}else if(S&&S!="."){t.push(' SYSTEM "',S,'">')}else{var C=e.internalSubset;if(C){t.push(" [",C,"]")}t.push(">")}return;case d:return t.push("<?",e.target," ",e.data,"?>");case c:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function ge(e,t,r){var n;switch(t.nodeType){case o:n=t.cloneNode(false);n.ownerDocument=e;case g:break;case f:r=true;break}if(!n){n=t.cloneNode(false)}n.ownerDocument=e;n.parentNode=null;if(r){var i=t.firstChild;while(i){n.appendChild(ge(e,i,r));i=i.nextSibling}}return n}function we(e,t,r){var n=new t.constructor;for(var i in t){var a=t[i];if(typeof a!="object"){if(a!=n[i]){n[i]=a}}}if(t.childNodes){n.childNodes=new P}n.ownerDocument=e;switch(n.nodeType){case o:var s=t.attributes;var u=n.attributes=new F;var l=s.length;u._ownerElement=n;for(var c=0;c<l;c++){n.setAttributeNode(we(e,s.item(c),true))}break;case f:r=true}if(r){var h=t.firstChild;while(h){n.appendChild(we(e,h,r));h=h.nextSibling}}return n}function ye(e,t,r){e[t]=r}try{if(Object.defineProperty){Object.defineProperty(M.prototype,"length",{get:function(){U(this);return this.$$length}});Object.defineProperty(V.prototype,"textContent",{get:function(){return _e(this)},set:function(e){switch(this.nodeType){case o:case g:while(this.firstChild){this.removeChild(this.firstChild)}if(e||String(e)){this.appendChild(this.ownerDocument.createTextNode(e))}break;default:this.data=e;this.value=e;this.nodeValue=e}}});function _e(e){switch(e.nodeType){case o:case g:var t=[];e=e.firstChild;while(e){if(e.nodeType!==7&&e.nodeType!==8){t.push(_e(e))}e=e.nextSibling}return t.join("");default:return e.nodeValue}}ye=function(e,t,r){e["$$"+t]=r}}}catch(e){}r.DOMImplementation=Y;r.XMLSerializer=de},{}],78:[function(e,t,r){var n=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;var i=new RegExp("[\\-\\.0-9"+n.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]");var a=new RegExp("^"+n.source+i.source+"*(?::"+n.source+i.source+"*)?$");var s=0;var o=1;var f=2;var u=3;var l=4;var c=5;var h=6;var d=7;function p(){}p.prototype={parse:function(e,t,r){var n=this.domBuilder;n.startDocument();b(t,t={});v(e,t,r,n,this.errorHandler);n.endDocument()}};function v(e,t,r,n,i){function a(e){if(e>65535){e-=65536;var t=55296+(e>>10),r=56320+(e&1023);return String.fromCharCode(t,r)}else{return String.fromCharCode(e)}}function s(e){var t=e.slice(1,-1);if(t in r){return r[t]}else if(t.charAt(0)==="#"){return a(parseInt(t.substr(1).replace("x","0x")))}else{i.error("entity not found:"+e);return e}}function o(t){if(t>v){var r=e.substring(v,t).replace(/&#?\w+;/g,s);h&&f(v);n.characters(r,0,t-v);v=t}}function f(t,r){while(t>=l&&(r=c.exec(e))){u=r.index;l=u+r[0].length;h.lineNumber++}h.columnNumber=t-u+1}var u=0;var l=0;var c=/.*(?:\r\n?|\n)|.*$/g;var h=n.locator;var d=[{currentNSMap:t}];var p={};var v=0;while(true){try{var b=e.indexOf("<",v);if(b<0){if(!e.substr(v).match(/^\s*$/)){var k=n.doc;var A=k.createTextNode(e.substr(v));k.appendChild(A);n.currentElement=A}return}if(b>v){o(b)}switch(e.charAt(b+1)){case"/":var S=e.indexOf(">",b+3);var C=e.substring(b+2,S);var N=d.pop();if(S<0){C=e.substring(b+2).replace(/[\s<].*/,"");i.error("end tag name: "+C+" is not complete:"+N.tagName);S=b+1+C.length}else if(C.match(/\s</)){C=C.replace(/[\s<].*/,"");i.error("end tag name: "+C+" maybe not complete");S=b+1+C.length}var I=N.localNSMap;var R=N.tagName==C;var O=R||N.tagName&&N.tagName.toLowerCase()==C.toLowerCase();if(O){n.endElement(N.uri,N.localName,C);if(I){for(var D in I){n.endPrefixMapping(D)}}if(!R){i.fatalError("end tag name: "+C+" is not match the current start tagName:"+N.tagName)}}else{d.push(N)}S++;break;case"?":h&&f(b);S=E(e,b,n);break;case"!":h&&f(b);S=x(e,b,n,i);break;default:h&&f(b);var z=new T;var B=d[d.length-1].currentNSMap;var S=g(e,b,z,B,s,i);var L=z.length;if(!z.closed&&_(e,S,z.tagName,p)){z.closed=true;if(!r.nbsp){i.warning("unclosed xml attribute")}}if(h&&L){var P=m(h,{});for(var M=0;M<L;M++){var U=z[M];f(U.offset);U.locator=m(h,{})}n.locator=P;if(w(z,n,B)){d.push(z)}n.locator=h}else{if(w(z,n,B)){d.push(z)}}if(z.uri==="http://www.w3.org/1999/xhtml"&&!z.closed){S=y(e,S,z.tagName,s,n)}else{S++}}}catch(e){i.error("element parse error: "+e);S=-1}if(S>v){v=S}else{o(Math.max(b,v)+1)}}}function m(e,t){t.lineNumber=e.lineNumber;t.columnNumber=e.columnNumber;return t}function g(e,t,r,n,i,a){var p;var v;var m=++t;var g=s;while(true){var w=e.charAt(m);switch(w){case"=":if(g===o){p=e.slice(t,m);g=u}else if(g===f){g=u}else{throw new Error("attribute equal must after attrName")}break;case"'":case'"':if(g===u||g===o){if(g===o){a.warning('attribute value must after "="');p=e.slice(t,m)}t=m+1;m=e.indexOf(w,t);if(m>0){v=e.slice(t,m).replace(/&#?\w+;/g,i);r.add(p,v,t-1);g=c}else{throw new Error("attribute value no end '"+w+"' match")}}else if(g==l){v=e.slice(t,m).replace(/&#?\w+;/g,i);r.add(p,v,t);a.warning('attribute "'+p+'" missed start quot('+w+")!!");t=m+1;g=c}else{throw new Error('attribute value must after "="')}break;case"/":switch(g){case s:r.setTagName(e.slice(t,m));case c:case h:case d:g=d;r.closed=true;case l:case o:case f:break;default:throw new Error("attribute invalid close char('/')")}break;case"":a.error("unexpected end of input");if(g==s){r.setTagName(e.slice(t,m))}return m;case">":switch(g){case s:r.setTagName(e.slice(t,m));case c:case h:case d:break;case l:case o:v=e.slice(t,m);if(v.slice(-1)==="/"){r.closed=true;v=v.slice(0,-1)}case f:if(g===f){v=p}if(g==l){a.warning('attribute "'+v+'" missed quot(")!!');r.add(p,v.replace(/&#?\w+;/g,i),t)}else{if(n[""]!=="http://www.w3.org/1999/xhtml"||!v.match(/^(?:disabled|checked|selected)$/i)){a.warning('attribute "'+v+'" missed value!! "'+v+'" instead!!')}r.add(v,v,t)}break;case u:throw new Error("attribute value missed!!")}return m;case"":w=" ";default:if(w<=" "){switch(g){case s:r.setTagName(e.slice(t,m));g=h;break;case o:p=e.slice(t,m);g=f;break;case l:var v=e.slice(t,m).replace(/&#?\w+;/g,i);a.warning('attribute "'+v+'" missed quot(")!!');r.add(p,v,t);case c:g=h;break}}else{switch(g){case f:var y=r.tagName;if(n[""]!=="http://www.w3.org/1999/xhtml"||!p.match(/^(?:disabled|checked|selected)$/i)){a.warning('attribute "'+p+'" missed value!! "'+p+'" instead2!!')}r.add(p,p,t);t=m;g=o;break;case c:a.warning('attribute space is required"'+p+'"!!');case h:g=o;t=m;break;case u:g=l;t=m;break;case d:throw new Error("elements closed character '/' and '>' must be connected to")}}}m++}}function w(e,t,r){var n=e.tagName;var i=null;var a=e.length;while(a--){var s=e[a];var o=s.qName;var f=s.value;var u=o.indexOf(":");if(u>0){var l=s.prefix=o.slice(0,u);var c=o.slice(u+1);var h=l==="xmlns"&&c}else{c=o;l=null;h=o==="xmlns"&&""}s.localName=c;if(h!==false){if(i==null){i={};b(r,r={})}r[h]=i[h]=f;s.uri="http://www.w3.org/2000/xmlns/";t.startPrefixMapping(h,f)}}var a=e.length;while(a--){s=e[a];var l=s.prefix;if(l){if(l==="xml"){s.uri="http://www.w3.org/XML/1998/namespace"}if(l!=="xmlns"){s.uri=r[l||""]}}}var u=n.indexOf(":");if(u>0){l=e.prefix=n.slice(0,u);c=e.localName=n.slice(u+1)}else{l=null;c=e.localName=n}var d=e.uri=r[l||""];t.startElement(d,c,n,e);if(e.closed){t.endElement(d,c,n);if(i){for(l in i){t.endPrefixMapping(l)}}}else{e.currentNSMap=r;e.localNSMap=i;return true}}function y(e,t,r,n,i){if(/^(?:script|textarea)$/i.test(r)){var a=e.indexOf("</"+r+">",t);var s=e.substring(t+1,a);if(/[&<]/.test(s)){if(/^script$/i.test(r)){i.characters(s,0,s.length);return a}s=s.replace(/&#?\w+;/g,n);i.characters(s,0,s.length);return a}}return t+1}function _(e,t,r,n){var i=n[r];if(i==null){i=e.lastIndexOf("</"+r+">");if(i<t){i=e.lastIndexOf("</"+r)}n[r]=i}return i<t}function b(e,t){for(var r in e){t[r]=e[r]}}function x(e,t,r,n){var i=e.charAt(t+2);switch(i){case"-":if(e.charAt(t+3)==="-"){var a=e.indexOf("--\x3e",t+4);if(a>t){r.comment(e,t+4,a-t-4);return a+3}else{n.error("Unclosed comment");return-1}}else{return-1}default:if(e.substr(t+3,6)=="CDATA["){var a=e.indexOf("]]>",t+9);r.startCDATA();r.characters(e,t+9,a-t-9);r.endCDATA();return a+3}var s=A(e,t);var o=s.length;if(o>1&&/!doctype/i.test(s[0][0])){var f=s[1][0];var u=o>3&&/^public$/i.test(s[2][0])&&s[3][0];var l=o>4&&s[4][0];var c=s[o-1];r.startDTD(f,u&&u.replace(/^(['"])(.*?)\1$/,"$2"),l&&l.replace(/^(['"])(.*?)\1$/,"$2"));r.endDTD();return c.index+c[0].length}}return-1}function E(e,t,r){var n=e.indexOf("?>",t);if(n){var i=e.substring(t,n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(i){var a=i[0].length;r.processingInstruction(i[1],i[2]);return n+2}else{return-1}}return-1}function T(e){}T.prototype={setTagName:function(e){if(!a.test(e)){throw new Error("invalid tagName:"+e)}this.tagName=e},add:function(e,t,r){if(!a.test(e)){throw new Error("invalid attribute:"+e)}this[this.length++]={qName:e,value:t,offset:r}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}};function k(e,t){e.__proto__=t;return e}if(!(k({},k.prototype)instanceof k)){k=function(e,t){function r(){}r.prototype=t;r=new r;for(t in e){r[t]=e[t]}return r}}function A(e,t){var r;var n=[];var i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;i.lastIndex=t;i.exec(e);while(r=i.exec(e)){n.push(r);if(r[1])return n}}r.XMLReader=p},{}]},{},[1]);